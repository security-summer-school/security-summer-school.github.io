#!/usr/bin/env python3

from pwn import *

# Print byte array as hex string "\x..\x..\x.."
def print_byte_array(prefix, array):
    log.info("{}: {}".format(prefix, "".join("\\x{:02x}".format(array[i]) for i in range(0, len(array)))))


# Change to 'debug' for extensive information on classes used.
context.log_level = 'info'

filename = "../src/vuln64"
e = ELF(filename)
context.binary = filename
diablo_address = e.symbols[b"diablo"]
overwatch_address = e.symbols[b"overwatch"]
warcraft_address = e.symbols[b"warcraft"]
starcraft_address = e.symbols[b"starcraft"]

print("diablo: 0x{:016x}".format(diablo_address))
print("warcraft: 0x{:016x}".format(warcraft_address))
print("overwatch: 0x{:016x}".format(overwatch_address))
print("starcraft: 0x{:016x}".format(starcraft_address))

payload = b"TODO"
print_byte_array("payload", payload)

p = process(filename)
p.readline()
p.sendline(payload)
p.interactive()
