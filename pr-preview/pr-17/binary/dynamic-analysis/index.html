<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.101.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Security Summer School</title><meta name=description content="Dynamic Analysis Introduction Objectives &amp;amp; Rationale The first part of this session will give you a walkthrough of the most common GDB principles that we are going to use in exploitation. In the second half, we are going to use these concepts in practice, to evade a basic key evaluation program.
Black Box type analysis works best when standard algorithms are used in the program, such as: MD5, SHA1,RSA . We can change the input to a more suggestive one and use the output to estimate what function was used to convert it."><meta property="og:title" content><meta property="og:description" content="Dynamic Analysis Introduction Objectives & Rationale The first part of this session will give you a walkthrough of the most common GDB principles that we are going to use in exploitation. In the second half, we are going to use these concepts in practice, to evade a basic key evaluation program.
Black Box type analysis works best when standard algorithms are used in the program, such as: MD5, SHA1,RSA . We can change the input to a more suggestive one and use the output to estimate what function was used to convert it."><meta property="og:type" content="article"><meta property="og:url" content="/binary/dynamic-analysis/"><meta property="article:section" content="binary"><meta property="og:site_name" content="Security Summer School"><meta itemprop=name content><meta itemprop=description content="Dynamic Analysis Introduction Objectives & Rationale The first part of this session will give you a walkthrough of the most common GDB principles that we are going to use in exploitation. In the second half, we are going to use these concepts in practice, to evade a basic key evaluation program.
Black Box type analysis works best when standard algorithms are used in the program, such as: MD5, SHA1,RSA . We can change the input to a more suggestive one and use the output to estimate what function was used to convert it."><meta itemprop=wordCount content="5375"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Dynamic Analysis Introduction Objectives & Rationale The first part of this session will give you a walkthrough of the most common GDB principles that we are going to use in exploitation. In the second half, we are going to use these concepts in practice, to evade a basic key evaluation program.
Black Box type analysis works best when standard algorithms are used in the program, such as: MD5, SHA1,RSA . We can change the input to a more suggestive one and use the output to estimate what function was used to convert it."><link rel=preload href=/scss/main.min.5aef8a3f4159801f5dbe642e33f5332212e837eda91d37dcd891fdcd5c32498a.css as=style><link href=/scss/main.min.5aef8a3f4159801f5dbe642e33f5332212e837eda91d37dcd891fdcd5c32498a.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class=font-weight-bold>Security Summer School</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/binary/><span class=active>Binary Exploitation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/essentials/><span>Security Essentials</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/web/><span>Web Security</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-binary-li><a href=/binary/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-binary><span>Binary Exploitation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybuffer-exploitation-li><a href=/binary/buffer-exploitation/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybuffer-exploitation><span>Buffer Exploitation</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarydefense-mechanisms-li><a href=/binary/defense-mechanisms/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarydefense-mechanisms><span>Defense Mechanisms</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-binarydynamic-analysis-li><a href=/binary/dynamic-analysis/ title class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-binarydynamic-analysis><span class=td-sidebar-nav-active-item>Dynamic Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryexecutables-and-processes-li><a href=/binary/executables-and-processes/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryexecutables-and-processes><span>Executables and Processes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryexploration-tools-li><a href=/binary/exploration-tools/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryexploration-tools><span>Exploration Tools</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryinformation-leaks-li><a href=/binary/information-leaks/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryinformation-leaks><span>Information Leaks</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryreturn-oriented-programming-li><a href=/binary/return-oriented-programming/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryreturn-oriented-programming><span>Return Oriented Programming</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryreturn-oriented-programming-advanced-li><a href=/binary/return-oriented-programming-advanced/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryreturn-oriented-programming-advanced><span>Return Oriented Programming Advanced</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryshellcodes-li><a href=/binary/shellcodes/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryshellcodes><span>Shellcodes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryshellcodes-advanced-li><a href=/binary/shellcodes-advanced/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryshellcodes-advanced><span>Shellcodes Advanced</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarystatic-analysis-li><a href=/binary/static-analysis/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarystatic-analysis><span>Static Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybypassing-mitigationsactivities03-tutorial-bypass-dep-no-aslr-libcreadme-li><a href=/binary/bypassing-mitigations/activities/03-tutorial-bypass-dep-no-aslr-libc/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybypassing-mitigationsactivities03-tutorial-bypass-dep-no-aslr-libcreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybypassing-mitigationsactivities08-challenge-bypass-dep-no-aslr-libcreadme-li><a href=/binary/bypassing-mitigations/activities/08-challenge-bypass-dep-no-aslr-libc/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybypassing-mitigationsactivities08-challenge-bypass-dep-no-aslr-libcreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybypassing-mitigationsactivities09-challenge-bypass-dep-aslr-libcreadme-li><a href=/binary/bypassing-mitigations/activities/09-challenge-bypass-dep-aslr-libc/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybypassing-mitigationsactivities09-challenge-bypass-dep-aslr-libcreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryextrapwntools-introreadme-li><a href=/binary/extra/pwntools-intro/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryextrapwntools-introreadme><span></span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/security-summer-school/security-summer-school.github.io/tree/main/content/en/binary/dynamic-analysis/index.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/security-summer-school/security-summer-school.github.io/edit/main/content/en/binary/dynamic-analysis/index.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/security-summer-school/security-summer-school.github.io/new/main/content/en/binary/dynamic-analysis/index.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/security-summer-school/security-summer-school.github.io/issues/new?title=" class=td-page-meta--issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/security-summer-school/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=/binary/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a><ul><li></li><li><a href=#gdb-basic-commands>GDB Basic Commands</a></li><li><a href=#examine-and-print-your-most-powerful-tools>Examine and Print, your most powerful tools</a></li><li><a href=#gdb-command-file>GDB command file</a></li><li><a href=#using-gdb-to-modify-variables>Using GDB to modify variables</a></li><li><a href=#pwndbg>PWNDBG</a></li><li><a href=#enough-with-gdb-for-a-while>Enough with GDB (for a while)</a></li><li><a href=#the-stack>The Stack</a></li><li><a href=#next-lesson-preview-buffer-overflows>Next lesson preview: Buffer Overflows</a></li></ul></li><li><a href=#challenges>Challenges</a><ul><li><a href=#01-challenge---explore-the-simple-password-protected-bash>01. Challenge - Explore The Simple Password Protected Bash</a></li><li><a href=#02-challenge---simple-password-protected-bash-destruction>02. Challenge - Simple Password Protected Bash Destruction</a></li><li><a href=#03-challenge---domino>03. Challenge - Domino</a></li><li><a href=#04-challenge---call-me>04. Challenge - Call me</a></li><li><a href=#05-challenge---snooze-me>05. Challenge - Snooze Me</a></li><li><a href=#06-challenge---phone-home>06. Challenge - Phone Home</a></li><li><a href=#07-challenge---chain-encoder>07. Challenge - Chain encoder</a></li><li><a href=#08-challenge---simple-cdkey>08. Challenge - Simple cdkey</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/binary/>Binary Exploitation</a></li><li class="breadcrumb-item active" aria-current=page><a href=/binary/dynamic-analysis/ aria-disabled=true class="btn-link disabled">Dynamic Analysis</a></li></ol></nav><div class=td-content><h1></h1><header class=article-meta></header><h1 id=dynamic-analysis>Dynamic Analysis</h1><h2 id=introduction>Introduction</h2><h4 id=objectives--rationale>Objectives & Rationale</h4><p>The first part of this session will give you a walkthrough of the most common GDB principles that we are going to use in exploitation. In the second half, we are going to use these concepts in practice, to evade a basic key evaluation program.</p><p>Black Box type analysis works best when standard algorithms are used in the program, such as: MD5, SHA1,RSA . We can change the input to a more suggestive one and use the output to estimate what function was used to convert it.</p><p>Combined with behavioral analysis methods such as using sandboxes or strace/ltrace we can quickly map sections of code to functionalities.</p><p>With dynamic analysis, packed malware can be extracted from memory in unpacked form, enabling us to continue static analysis on the complete binary.</p><h4 id=prerequisites>Prerequisites</h4><p>In the current session we will use GDB extensively. We assume that you are familiar with its basic usage and will move on quickly to some of its more advanced features.</p><p>To brush up on the GDB basics, read this <a href=https://security.cs.pub.ro/summer-school/wiki/session/04-gdb title=session:04-gdb>Refresher</a>.</p><p>The executable used in the demo is called sppb and is the challenge 1 binary.</p><h6 id=before-gdb>Before GDB</h6><h5 id=one-thing-you-should-always-do-before-firing-up-gdb-is-to-try-to-learn-all-the-available-information-on-the-executable-youre-trying-to-debug-through-the-techniques-that-have-been-presented-so-far>One thing you should always do before firing up GDB is to try to learn all the available information on the executable you're trying to debug through the techniques that have been presented so far.</h5><p>For the purposes of this session it is a good idea to always run<code>objdump</code> on all the executable files before attaching GDB to them so that you have a better idea of what goes where.</p><pre tabindex=0><code class=language-{.code data-lang={.code>$ objdump -M intel -d [executable]
</code></pre><h3 id=gdb-basic-commands>GDB Basic Commands</h3><h4 id=getting-help-with-gdb>Getting help with GDB</h4><p>Whenever you want to find out more information about GDB commands feel free to search for it inside <a href=http://www.gnu.org/software/gdb/documentation/ title=http://www.gnu.org/software/gdb/documentation/>the documentation</a> or by using the <code>help</code> command followed by your area of interest. For example searching for help for the <code>disassemble</code> command can be obtained by running the following command in GDB:</p><pre tabindex=0><code class=language-{.code data-lang={.code>#print info about all help areas available
#identify the area of your question
(gdb) help
#print info about available data commands
#identify the command you want to learn more about
(gdb) help data
#print info about a specific command
#find out more about the command you are searching for
(gdb) help disassemble
</code></pre><h4 id=opening-a-program-with-gdb>Opening a program with GDB</h4><p>A program can be opened for debugging in a number of ways. We can run
GDB directly attaching it to a program:</p><pre tabindex=0><code class=language-{.code data-lang={.code>$ gdb [executable-file]
</code></pre><p>Or we can open up GDB and then specify the program we are trying to
attach to using the file or file-exec command:</p><pre tabindex=0><code class=language-{.code data-lang={.code>$ gdb
(gdb) file [executable-file]
</code></pre><p>Furthermore we can attach GDB to a running service if we know its
process id:</p><pre tabindex=0><code class=language-{.code data-lang={.code>$ gdb --pid [pid_number]
</code></pre><h4 id=disassembling>Disassembling</h4><p>GDB allows disassembling of binary code using the <code>disassemble</code> command
(it may be shortened to <code>disas</code>). The command can be issued either on a
memory address or using labels.</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) disassemble *main
Dump of assembler code for function main:
   0x080491c9 &lt;+0&gt;:     push   ebp
   0x080491ca &lt;+1&gt;:     mov    ebp,esp
   0x080491cc &lt;+3&gt;:     push   ebx
   0x080491cd &lt;+4&gt;:     sub    esp,0x4
=&gt; 0x080491d0 &lt;+7&gt;:     mov    eax,ds:0x804c030
....Output ommited.....
(gdb) disassemble 0x080491c9
Dump of assembler code for function main:
   0x080491c9 &lt;+0&gt;:     push   ebp
   0x080491ca &lt;+1&gt;:     mov    ebp,esp
   0x080491cc &lt;+3&gt;:     push   ebx
   0x080491cd &lt;+4&gt;:     sub    esp,0x4
=&gt; 0x080491d0 &lt;+7&gt;:     mov    eax,ds:0x804c030
</code></pre><h4 id=adding-breakpoints>Adding Breakpoints</h4><p>Breakpoints are important to suspend the execution of the program being debugged in a certain place. Adding breakpoints is done with the <code>break</code>
command. A good idea is to place a breakpoint at the main function of the program you are trying to exploit. Given the fact that you have already run <code>objdump</code> and disassembled the program you know the address for the start of the main function. This means that we can set a
breakpoint for the start of our program in two ways:</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) break *main (when the binary is not stripped of symbols)
(gdb) break *0x[main_address_obtained_with_objdump] (when aslr is off)
</code></pre><p>The general format for setting breakpoints in GDB is as follows:</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) break [LOCATION] [thread THREADNUM] [if CONDITION]
</code></pre><p><em>Issuing the <code>break</code> command with no parameters will place a breakpoint</em> <em>at the current address.</em></p><p><em>GDB allows using abbreviated forms for all the commands it supports. Learning these abbreviations comes with time and will greatly improve you work output. Always be on the lookout for using abbreviated commands.</em></p><p>The abbreviated command for setting breakpoints is simply <code>b</code>.</p><h4 id=listing-breakpoints>Listing Breakpoints</h4><p>At any given time all the breakpoints in the program can be displayed using the <code>info breakpoints</code> command:</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) info breakpoints
</code></pre><p><em>You can also issue the abbreviated form of the command</em></p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) i b
</code></pre><h4 id=deleting-breakpoints>Deleting Breakpoints</h4><p>Breakpoints can be removed by issuing the <code>delete breakpoints</code> command followed by the breakpoints number, as it is listed in the output of the
<code>info breakpoints</code> command.</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) delete breakpoints [breakpoint_number]
</code></pre><p><em>You can also delete all active breakpoints by issuing the following the</em> <code>delete breakpoints</code> command with no parameters:*</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) delete breakpoints
</code></pre><p>Once a breakpoint is set you would normally want to launch the program into execution. You can do this by issuing the <code>run</code> command. The program will start executing and stop at the first breakpoint you have
set.</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) run
</code></pre><h4 id=execution-flow>Execution flow</h4><p>Execution flow can be controlled in GDB using the <code>continue</code>, <code>stepi</code>,<code>nexti</code> as follows:</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) help continue
#Continue program being debugged, after signal or breakpoint.
#If proceeding from breakpoint, a number N may be used as an argument,
#which means to set the ignore count of that breakpoint to N - 1 (so that
#the breakpoint won&#39;t break until the Nth time it is reached).
(gdb) help stepi
#Step one instruction exactly.
#Argument N means do this N times (or till program stops for another reason).
(gdb) help nexti
#Step one instruction, but proceed through subroutine calls.
#Argument N means do this N times (or till program stops for another reason).
</code></pre><p><em>You can also use the abbreviated format of the commands: <code>c</code></em>
<em>(<code>continue</code>), <code>si</code> (<code>stepi</code>), <code>ni</code> (<code>nexti</code>).</em></p><p><em>If at any point you want to start the program execution from the</em> <em>beginning you can always reissue the <code>run</code> command.</em></p><p>Another technique that can be used for setting breakpoints is using offsets.</p><p>As you already know, each assembly instruction takes a certain number of bytes inside the executable file. This means that whenever you are setting breakpoints using offsets you must always set them at instruction boundaries.</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) break *main
Breakpoint 1 at 0x80491d0
(gdb) run
Starting program: sppb
 
Breakpoint 1, 0x80491d0 in main ()
(gdb) disassemble main
Dump of assembler code for function main:
   0x080491c9 &lt;+0&gt;:     push   ebp
   0x080491ca &lt;+1&gt;:     mov    ebp,esp
   0x080491cc &lt;+3&gt;:     push   ebx
   0x080491cd &lt;+4&gt;:     sub    esp,0x4
.....Output ommited.....
(gdb) break *main+4
Breakpoint 2 at 0x80491cd
</code></pre><h3 id=examine-and-print-your-most-powerful-tools>Examine and Print, your most powerful tools</h3><p>GDB allows examining of memory locations be them specified as addresses or stored in registers. The <code>x</code> command (for <em>examine</em>) is arguably one
of the most powerful tool in your arsenal and the most common command you are going to run when exploiting.</p><p>The format for the <code>examine</code> command is as follows:</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) x/nfu [address]
        n:  How many units to print
        f:  Format character
              a Pointer
              c Read as integer, print as character
              d Integer, signed decimal
              f Floating point number
              o Integer, print as octal
              s Treat as C string (read all successive memory addresses until null character and print as characters)
              t Integer, print as binary (t=&#34;two&#34;)
              u Integer, unsigned decimal
              x Integer, print as hexadecimal
        u:  Unit
              b: Byte
              h: Half-word (2 bytes)
              w: Word (4 bytes)
              g: Giant word (8 bytes)
              i: Instruction (read n assembly instructions from the specified memory address)
</code></pre><p>In contrast with the examine command, which reads data at a memory location the <code>print</code> command (shorthand <code>p</code>) prints out values stored in
registers and variables.</p><p>The format for the <code>print</code> command is as follows:</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) p/f [what]
        f:  Format character
              a Pointer
              c Read as integer, print as character
              d Integer, signed decimal
              f Floating point number
              o Integer, print as octal
              s Treat as C string (read all successive memory addresses until null character and print as characters)
              t Integer, print as binary (t=&#34;two&#34;)
              u Integer, unsigned decimal
              x Integer, print as hexadecimal
              i Instruction (read n assembly instructions from the specified memory address)
</code></pre><p>For a better explanation please follow through with the following example:</p><pre tabindex=0><code class=language-{.code data-lang={.code>#a breakpoint has been set inside the program and the program has been run with the appropriate commands to reach the breakpoint
#at this point we want to see which are the following 10 instructions
(gdb) x/10i 0x80491cd
   0x80491cd &lt;main+4&gt;:  sub    esp,0x4
   0x80491d0 &lt;main+7&gt;:  mov    eax,ds:0x804c030
   0x80491d5 &lt;main+12&gt;: push   0x0
   0x80491d7 &lt;main+14&gt;: push   0x1
   0x80491d9 &lt;main+16&gt;: push   0x0
   0x80491db &lt;main+18&gt;: push   eax
   0x80491dc &lt;main+19&gt;: call   0x8049080 &lt;setvbuf@plt&gt;
#let&#39;s examine the memory at 0x804a02a because we have a hint that this address holds one of the parameters of the scanf call  as it is afterwards placed on the stack (we&#39;ll explain later how we have reached this conclusion)
#the other parameter will be an address where the input will be stored
(gdb) x/s 0x804a02a
0x804a02a:      &#34;%d&#34;
# we now set a breakpoint for *main+56
(gdb) break *0x08049201
Breakpoint 3 at 0x08049201
(gdb) continue
Continuing.
 
Breakpoint 3, 0x08049201 in main ()
We then record the value of the eax register somewhere and use nexti(ni) and then we input an integer.
#let&#39;s examine the address which we recorded earlier corresponding to the eax register (it should&#39;ve held the address for the integer we input)
#take note that in GDB registers are preceded by the &#34;$&#34; character very much like variables
(gdb) x/d 0xffffcf70 &lt;- (your address)
0xffffcf70:     &lt;your input&gt;
#now let&#39;s print the contents of the eax register as hexadecimal
(gdb) p/x $eax
$1 = &lt;your input&gt;

The diference between p and x can be observed by issuing the following commands:
x/s 0x804a030
0x804a030:      &#34;Your password is: %d. Evaluating it...\n&#34;

p /s 0x804a030

$2 = 1920298841 which is the number in decimal format that &#34;Your&#34; can be translated to by its ascii codes (little endian so written as 0x72756F59).

In order to see the same result we must use the command p /s (char*)0x804a030 and dereference the pointer ourselves 
# as you can see the address holds the memory for the beginning of the string
# this shows you how &#34;x&#34; interprets data from memory while &#34;p&#34; merely prints out the contents in the required format
# you can think of it as &#34;x&#34; dereferencing while &#34;p&#34; not dereferencing
</code></pre><h3 id=gdb-command-file>GDB command file</h3><p>When exploiting, there are a couple of commands that you will issue periodically and doing that by hand will get cumbersome. GDB commands
files will allow you to run a specific set of commands automatically after each command you issue manually. This comes in especially handy
when you're stepping through a program and want to see what happens with the registers and stack after each instruction is ran, which is the
main target when exploiting.</p><p>The examine command only has sense when code is already running on the machine so inside the file we are going to use the display command which
translates to the same output.</p><p>In order to use this option you must first create your commands file. This file can include any GDB commands you like but a good start would
be printing out the content of all the register values, the next ten instructions that are going to be executed, and some portion from the
top of the stack.</p><p>The reason for examining all of the above after each instruction is ran will become more clear once the we go through the second section of the
session.</p><p>Command file template:</p><pre tabindex=0><code class=language-{.code data-lang={.code>display/10i $eip
display/x $eax
display/x $ebx
display/x $ecx
display/x $edx
display/x $edi
display/x $esi
display/x $ebp
display/32xw $esp
</code></pre><p>In order to view all register values you could use the <code>x</code> command.
However the values of all registers can be obtained by running the<code>info all-registers</code> command:</p><pre tabindex=0><code class=language-{.code data-lang={.code>(gdb) info all-registers
eax            0x8048630,134514224
ecx            0xbffff404,-1073744892
edx            0xbffff394,-1073745004
ebx            0xb7fc6ff4,-1208193036
esp            0xbffff330,0xbffff330
ebp            0xbffff368,0xbffff368
esi            0x0,0
edi            0x0,0
eip            0x80484e9,0x80484e9 &lt;main+37&gt;
eflags         0x286,[ PF SF IF ]
cs             0x73,115
ss             0x7b,123
ds             0x7b,123
es             0x7b,123
fs             0x0,0
gs             0x33,51
st0            *value not available*
st1            *value not available*
st2            *value not available*
st3            *value not available*
st4            *value not available*
st5            *value not available*
st6            *value not available*
st7            *value not available*
fctrl          0x37f,895
fstat          0x0,0
ftag           0xffff,65535
fiseg          0x0,0
fioff          0x0,0
foseg          0x0,0
---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---
fooff          0x0,0
fop            0x0,0
mxcsr          0x1f80,[ IM DM ZM OM UM PM ]
ymm0           *value not available*
ymm1           *value not available*
ymm2           *value not available*
ymm3           *value not available*
ymm4           *value not available*
ymm5           *value not available*
ymm6           *value not available*
ymm7           *value not available*
mm0            *value not available*
mm1            *value not available*
mm2            *value not available*
mm3            *value not available*
mm4            *value not available*
mm5            *value not available*
mm6            *value not available*
mm7            *value not available*
</code></pre><p><em>One thing you might notice while using GDB is that addresses seem to be pretty similar between runs. Although with experience you will gain a better feel for where an address points to, one thing to remember at this point would be that stack addresses usually have the <code>0xbffff….</code> format. In order to run GDB with the commands file you have just generated, when launching GDB specify the <code>-x [command_file]</code> parameter.</em></p><h3 id=using-gdb-to-modify-variables>Using GDB to modify variables</h3><p>GDB can be used to modify variables during runtime. In the case of exploitation this comes in handy as the program can be altered at
runtime with the purpose of changing the execution path to desired branches.</p><h3 id=pwndbg>PWNDBG</h3><p>As you can see using GDB can be cumbersome, this is why we recommend using the pwndbg plug-in. The tutorial as well as the repository of the project can be found here <a href=https://github.com/pwndbg/pwndbg title=https://github.com/pwndbg/pwndbg>Pwndbg</a></p><p>Give the fact that pwndbg is just a wrapper, all the functionality of GDB will be available when running gdb with the<code>pwndbg</code> plug-in. Some of the advantages of using pwngdb include:</p><ol><li>Automatic preview of registers, code and stack after each instruction (you no longer need to create your own commands file)</li><li>Automatic dereferencing and following through of memory locations</li><li>Color coding</li></ol><p>An alternative to pwndbg is <a href=https://github.com/hugsy/gef title=https://github.com/hugsy/gef>Gef</a>. However, this tutorial is designed with Pwndbg in mind.</p><h4 id=pwndbg-commands>PWNDBG Commands</h4><p><code>pdis</code> command gives a pretty output that is similar to what the <code>disas</code>
command in GDB prints:</p><pre tabindex=0><code class=language-{.code data-lang={.code>Usage:  pdis 0x80491d0
</code></pre><p>If <code>pdis</code> is used with an address as a parameter, the output will be similar to what <code>x/Ni</code> prints out (where N is the number of instructions you want to disassemble) Usage: -pdis [address] [N] - where N is the number of instructions you want to be printed</p><p>The <code>stepi</code> command has the same effect as in GDB however, if you are running PWNDBG you will notice that after each step PWNDBG will automatically print register values, several lines of code from eip
register and a portion of the stack:</p><pre tabindex=0><code class=language-{.code data-lang={.code>pwndbg&gt; stepi

LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
────────────────────────────────────[ REGISTERS ]────────────────────────────────────
*EAX  0xf7facd20 (_IO_2_1_stdout_) ◂— 0xfbad2084
 EBX  0x0
 ECX  0xa00af61b
 EDX  0xffffcfb4 ◂— 0x0
 EDI  0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c
 ESI  0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c
 EBP  0xffffcf78 ◂— 0x0
 ESP  0xffffcf70 —▸ 0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c
*EIP  0x80491d5 (main+12) ◂— push   0 /* &#39;j&#39; */
─────────────────────────────────────[ DISASM ]──────────────────────────────────────
   0x80491d0 &lt;main+7&gt;     mov    eax, dword ptr [stdout@GLIBC_2.0] &lt;0x804c030&gt;
 ► 0x80491d5 &lt;main+12&gt;    push   0
   0x80491d7 &lt;main+14&gt;    push   1
   0x80491d9 &lt;main+16&gt;    push   0
   0x80491db &lt;main+18&gt;    push   eax
   0x80491dc &lt;main+19&gt;    call   setvbuf@plt &lt;setvbuf@plt&gt;
 
   0x80491e1 &lt;main+24&gt;    add    esp, 0x10
   0x80491e4 &lt;main+27&gt;    mov    dword ptr [ebp - 8], 0
   0x80491eb &lt;main+34&gt;    push   0x804a010
   0x80491f0 &lt;main+39&gt;    call   puts@plt &lt;puts@plt&gt;
 
   0x80491f5 &lt;main+44&gt;    add    esp, 4
──────────────────────────────────[ SOURCE (CODE) ]──────────────────────────────────
In file: /home/kali/Desktop/dokermaker/binary-internal/sessions/05-dynamic-analysis/activities/01-02-challenge-sppb/src/sppb.c
    6   execve(&#34;/bin/sh&#34;, 0, 0);
    7 }
    8 
    9 int main()
   10 {
 ► 11   setvbuf(stdout, NULL, _IOLBF, 0);
   12   int readValue = 0;
   13 
   14   printf(&#34;Please provide password: \n&#34;);
   15   scanf(&#34;%d&#34;, &amp;readValue);
   16 
──────────────────────────────────────[ STACK ]──────────────────────────────────────
00:0000│ esp 0xffffcf70 —▸ 0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c
01:0004│     0xffffcf74 ◂— 0x0
02:0008│ ebp 0xffffcf78 ◂— 0x0
03:000c│     0xffffcf7c —▸ 0xf7de0fd6 (__libc_start_main+262) ◂— add    esp, 0x10
04:0010│     0xffffcf80 ◂— 0x1
05:0014│     0xffffcf84 —▸ 0xffffd024 —▸ 0xffffd1d9 ◂— &#39;/home/kali/Desktop/sppb&#39;
06:0018│     0xffffcf88 —▸ 0xffffd02c —▸ 0xffffd24d ◂— &#39;COLORFGBG=15;0&#39;
07:001c│     0xffffcf8c —▸ 0xffffcfb4 ◂— 0x0
────────────────────────────────────[ BACKTRACE ]────────────────────────────────────
 ► f 0 0x80491d5 main+12
   f 1 0xf7de0fd6 __libc_start_main+262
</code></pre><p>You can always use the following commands to obtain context at any given
moment inside the debug process:</p><ol><li><code>context reg</code></li><li><code>context code</code></li><li><code>context stack</code></li><li><code>context all</code></li></ol><p>One additional PWNDBG command which can be used to show values in registers is the <code>telescope</code> command. The command dereferentiates pointer values until it gets to a value and prints out the entire trace.</p><p>The command can be used with both registers and memory addresses:</p><pre tabindex=0><code class=language-{.code data-lang={.code>pwndbg$ telescope $esp
00:0000│ esp 0xffffcf70 —▸ 0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c
01:0004│     0xffffcf74 ◂— 0x0
02:0008│ ebp 0xffffcf78 ◂— 0x0
03:000c│     0xffffcf7c —▸ 0xf7de0fd6 (__libc_start_main+262) ◂— add    esp, 0x10
04:0010│     0xffffcf80 ◂— 0x1
05:0014│     0xffffcf84 —▸ 0xffffd024 —▸ 0xffffd1d9 ◂— &#39;/home/kali/Desktop/sppb&#39;
06:0018│     0xffffcf88 —▸ 0xffffd02c —▸ 0xffffd24d ◂— &#39;COLORFGBG=15;0&#39;
07:001c│     0xffffcf8c —▸ 0xffffcfb4 ◂— 0x0
pwndbg&gt; telescope 0xffffcf84
00:0000│  0xffffcf84 —▸ 0xffffd024 —▸ 0xffffd1d9 ◂— &#39;/home/kali/Desktop/sppb&#39;
01:0004│  0xffffcf88 —▸ 0xffffd02c —▸ 0xffffd24d ◂— &#39;COLORFGBG=15;0&#39;
02:0008│  0xffffcf8c —▸ 0xffffcfb4 ◂— 0x0
03:000c│  0xffffcf90 —▸ 0xffffcfc4 ◂— 0xe38ae80b
04:0010│  0xffffcf94 —▸ 0xf7ffdb60 —▸ 0xf7ffdb00 —▸ 0xf7fc93e0 —▸ 0xf7ffd9a0 ◂— ...
05:0014│  0xffffcf98 —▸ 0xf7fc9410 —▸ 0x804832d ◂— &#39;GLIBC_2.0&#39;
06:0018│  0xffffcf9c —▸ 0xf7fac000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1e9d6c
07:001c│  0xffffcfa0 ◂— 0x1
</code></pre><p>In the example above, the memory address 0x8048630 was loaded into EAX. That is why examining the register or the memory location gives the same output.</p><p>For more information on various PWNdbg commands you can always visit the PWNdbg help through the <code>pwndbg</code> command It is always a better idea to use PWNdbg commands when available. However you should also know the basics of using GDB as well.</p><h4 id=altering-variables-and-memory-with-pwndbg-and-gdb>Altering variables and memory with PWNdbg and GDB</h4><p>In addition to basic registers, GDB has a two extra variables which map onto some of the existing registers, as follows:</p><ul><li><p><code>$pc – $eip</code></p></li><li><p><code>$sp – $esp</code></p></li><li><p><code>$fp – $ebp</code></p></li></ul><p>In addition to these there are also two registers which can be used to view the processor state <code>$ps – processor status</code></p><p>Values of memory addresses and registers can be altered at execution time. Because altering memory is a lot easier using PWNdbg we are going to
use it throughout today's session.</p><p>The easiest way of altering the execution flow of a program is editing the <code>$eflags</code> register just before jump instructions.</p><p>Using GDB the <code>$eflags</code> register can be easily modified:</p><pre tabindex=0><code class=language-{.code data-lang={.code>pwndbg&gt; reg eflags
EFLAGS 0x282 [ cf pf af zf SF IF df of ]
Set the ZF flag
pwndbg&gt; set $eflags |= (1 &lt;&lt; 6)
Clear the ZF flag
pwndbg&gt; set $eflags &amp;= ~(1 &lt;&lt; 6)
</code></pre><p>Notice that the flags that are set are printed in all-caps when the<code>reg eflags</code> command is issued.</p><p>The <code>set</code> command (GDB native) can be used to modify values that reside inside memory.</p><pre tabindex=0><code class=language-{.code data-lang={.code>pwndbg&gt; telescope 0x804a010
00:0000│  0x804a010 ◂— &#39;Please provide password: &#39;
01:0004│  0x804a014 ◂— &#39;se provide password: &#39;
02:0008│  0x804a018 ◂— &#39;rovide password: &#39;
03:000c│  0x804a01c ◂— &#39;de password: &#39;
04:0010│  0x804a020 ◂— &#39;assword: &#39;
05:0014│  0x804a024 ◂— &#39;ord: &#39;
06:0018│  0x804a028 ◂— 0x64250020 /* &#39; &#39; */
07:001c│  0x804a02c ◂— 0x0

pwndbg&gt; set {char [14]} 0x804a010 = &#34;No pass here&#34;
Written 28 bytes to 0x8048630
pwndbg&gt; telescope 0x8048630
00:0000│  0x804a010 ◂— &#39;No pass here&#39;
01:0004│  0x804a014 ◂— &#39;ass here&#39;
02:0008│  0x804a018 ◂— &#39;here&#39;
03:000c│  0x804a01c ◂— 0x70200000
04:0010│  0x804a020 ◂— &#39;assword: &#39;
05:0014│  0x804a024 ◂— &#39;ord: &#39;
06:0018│  0x804a028 ◂— 0x64250020 /* &#39; &#39; */
07:001c│  0x804a02c ◂— 0x0
</code></pre><p>As you can see the string residing in memory at address <code>0x8048630</code> has been modified using the <code>set</code> command.</p><p>Pwngdb does not offer enhancements in modifying registry values. For modifying registry values you can use the GDB <code>set</code> command.</p><pre tabindex=0><code class=language-{.code} data-lang={.code}>pwngdb&gt; p/x $eax
$10 = 0x1
pwngdb&gt; set $eax=0x80
pwngdb&gt; p/x $eax
$11 = 0x80
</code></pre><h3 id=enough-with-gdb-for-a-while>Enough with GDB (for a while)</h3><p>The following section will describe the process of function calling in detail. Understanding function calling and stack operations during program execution is esential to exploitation.</p><h3 id=the-stack>The Stack</h3><p>The stack is one of the areas of memory which gets the biggest attention in exploitation writing.</p><h4 id=stack-growth>Stack Growth</h4><p>The stack grows from high memory addresses to low memory addresses.</p><pre tabindex=0><code class=language-{.code data-lang={.code>pwndbg&gt;  pdis $eip

   0x80491db &lt;main+18&gt;    push   eax
   0x80491dc &lt;main+19&gt;    call   setvbuf@plt &lt;setvbuf@plt&gt;
 
   0x80491e1 &lt;main+24&gt;    add    esp, 0x10
   0x80491e4 &lt;main+27&gt;    mov    dword ptr [ebp - 8], 0
   0x80491eb &lt;main+34&gt;    push   0x804a010
 ► 0x80491f0 &lt;main+39&gt;    call   puts@plt &lt;puts@plt&gt;

pwndbg&gt; p/x $esp
$1 = 0xffffcf6c
pwndbg&gt; si
0x8049050 in puts@plt ()
pwndbg&gt; p/x $esp
$5 = 0xffffcf68
</code></pre><p>As you can see from the example above the $esp register had an initial value of <code>0xffffcf6c</code>. The next instruction that is about to be executed is a push (it pushes <code>0x0</code> on the stack). We execute the instruction and then reevaluate the value of <code>$esp</code>. As we can see <code>$esp</code> now points to <code>0xffffcf68</code> (<code>0xffffcf6c-0x4</code>).</p><h4 id=frame-pointers-and-local-function-variables>Frame pointers and local function variables</h4><p>Whenever the processor is entering the execution for a function, a special logical container is created on the stack for that function.</p><p>This container is called a function frame. The idea behind it is that the processor must know which area of the stack belongs to which function.</p><p>In order to achieve this logical segmentation a set of 2 instructions are automatically inserted by the compiler at the beginning of each function. Can you tell what they are based on the output below?</p><pre tabindex=0><code class=language-{.code data-lang={.code>pwndbg&gt; break main
Breakpoint 1 at 0x80484c8
pwndbg&gt; run
[----------------------------------registers-----------------------------------]
 EAX  0xf7fa99e8 (environ) —▸ 0xffffd02c —▸ 0xffffd24d ◂— &#39;COLORFGBG=15;0&#39;
 EBX  0x0
 ECX  0xb8a6a751
 EDX  0xffffcfb4 ◂— 0x0
 EDI  0x80490a0 (_start) ◂— xor    ebp, ebp
 ESI  0x1
 EBP  0xffffcf78 ◂— 0x0
 ESP  0xffffcf70 ◂— 0x1
 EIP  0x80491d0 (main+7) ◂— mov    eax, dword ptr [0x804c030]
[-------------------------------------code-------------------------------------]
   0x080491c9 &lt;+0&gt;:     push   ebp
   0x080491ca &lt;+1&gt;:     mov    ebp,esp
   0x080491cc &lt;+3&gt;:     push   ebx
   0x080491cd &lt;+4&gt;:     sub    esp,0x4
=&gt; 0x080491d0 &lt;+7&gt;:     mov    eax,ds:0x804c030
   0x080491d5 &lt;+12&gt;:    push   0x0
   0x080491d7 &lt;+14&gt;:    push   0x1
   0x080491d9 &lt;+16&gt;:    push   0x0
   0x080491db &lt;+18&gt;:    push   eax

[------------------------------------stack-------------------------------------]
00:0000│ esp 0xffffcf70 ◂— 0x1
01:0004│     0xffffcf74 ◂— 0x0
02:0008│ ebp 0xffffcf78 ◂— 0x0
03:000c│     0xffffcf7c —▸ 0xf7dda905 (__libc_start_main+229) ◂— add    esp, 0x10
04:0010│     0xffffcf80 ◂— 0x1
05:0014│     0xffffcf84 —▸ 0xffffd024 —▸ 0xffffd1d9 ◂— &#39;/home/kali/Desktop/sppb&#39;
06:0018│     0xffffcf88 —▸ 0xffffd02c —▸ 0xffffd24d ◂— &#39;COLORFGBG=15;0&#39;
07:001c│     0xffffcf8c —▸ 0xffffcfb4 ◂— 0x0

[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
 
Breakpoint 1, 0x080491d0 in main ()
pwndbg&gt;  disass password_accepted


   0x080491b2 &lt;+0&gt;:     push   ebp                                                   
   0x080491b3 &lt;+1&gt;:     mov    ebp,esp                                               
   0x080491b5 &lt;+3&gt;:     push   0x0
   0x080491b7 &lt;+5&gt;:     push   0x0
   0x080491b9 &lt;+7&gt;:     push   0x804a008
   0x080491be &lt;+12&gt;:    call   0x8049070 &lt;execve@plt&gt;
   0x080491c3 &lt;+17&gt;:    add    esp,0xc
   0x080491c6 &lt;+20&gt;:    nop
   0x080491c7 &lt;+21&gt;:    leave  
   0x080491c8 &lt;+22&gt;:    ret 
</code></pre><p>What we did is we created a breakpoint for the start of the main function and then ran the program. As you can see the first 2 instructions that got executed were <code>push ebp</code> and <code>mov ebp,esp</code>.</p><p>We then set a breakpoint for another function called <code>pass_accepted</code>, continued execution and entered a password that we know is going to pass validation. Once the breakpoint is hit, we can see the same 2 instructions <code>push ebp</code> and <code>mov ebp,esp</code>.</p><p>The two instructions which can be noticed at the beginning of any function are the instructions required for creating the logical container for each function on the stack.</p><p>In essence what they do is save the reference of the old container (<code>push ebp</code>) and record the current address at the top of the stack as the beginning of the new container(<code>mov ebp,esp</code>).</p><p>For a visual explanation please see below:</p><p align=center><img src="https://security.cs.pub.ro/summer-school/wiki/_media/session/s5_frame_pointer_picture.jpg?w=300&tok=e38db5" alt="Sublime's custom image"></p><p>As you can see the EBP register always points to the stack address that corresponds to the beginning of the current function's frame. That is why it is most often referred to as the frame pointer.</p><p>In addition to the two instructions required for creating a new stack frame for a function, there are a couple more instructions that you will usually see at the beginning of a function</p><p>If you analyze the instructions at the beginning of main, you can spot these as being:</p><ol><li><p>An <code>and esp,0xfffffff0</code> instruction.</p></li><li><p>A <code>sub</code> insctruction that subtracts a hex value from ESP.</p></li></ol><p>The first of the two instructions has the purpose of aligning the stack to a specific address boundary. This is done to increase processor efficiency. In our specific case, the top of the stack gets aligned to a 16 byte multiple address.</p><p>One of the purposes of the stack inside functions is that of offering address space in which to place local variables. The second instruction preallocates space for local function variables.</p><p>Let's see how local variables are handled inside assembly code.</p><pre tabindex=0><code class=language-{.code data-lang={.code>#include &lt;stdio.h&gt;
int main()
{
        int a;
        a=1;
        return 0;
}
</code></pre><pre tabindex=0><code class=language-{.code data-lang={.code>kali@kali:~/sss$ gdb test
GNU gdb (Ubuntu/Linaro 7.4-2012.02-0ubuntu2) 7.4-2012.02
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type &#34;show copying&#34;
and &#34;show warranty&#34; for details.
This GDB was configured as &#34;i686-linux-gnu&#34;.
For bug reporting instructions, please see:
&lt;http://bugs.launchpad.net/gdb-linaro/&gt;...
Reading symbols from /home/dgioga/sss/test...(no debugging symbols found)...done.
pwndbg&gt;  break main
Breakpoint 1 at 0x80483ba
pwndbg&gt;  run
[----------------------------------registers-----------------------------------]
EAX: 0x1
EBX: 0xb7fc6ff4 --&gt; 0x1a0d7c
ECX: 0xbffff414 --&gt; 0xbffff576 (&#34;/home/dgioga/sss/test&#34;)
EDX: 0xbffff3a4 --&gt; 0xb7fc6ff4 --&gt; 0x1a0d7c
ESI: 0x0
EDI: 0x0
EBP: 0xbffff378 --&gt; 0x0
ESP: 0xbffff368 --&gt; 0x80483d9 (&lt;__libc_csu_init+9&gt;:,add    ebx,0x1c1b)
EIP: 0x80483ba (&lt;main+6&gt;:,mov    DWORD PTR [ebp-0x4],0x1)
EFLAGS: 0x200282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x80483b4 &lt;main&gt;:,  push   ebp
   0x80483b5 &lt;main+1&gt;:,mov    ebp,esp
   0x80483b7 &lt;main+3&gt;:,sub    esp,0x10
=&gt; 0x80483ba &lt;main+6&gt;:,mov    DWORD PTR [ebp-0x4],0x1
   0x80483c1 &lt;main+13&gt;:,mov    eax,0x0
   0x80483c6 &lt;main+18&gt;:,leave
   0x80483c7 &lt;main+19&gt;:,ret
   0x80483c8:,nop
[------------------------------------stack-------------------------------------]
0000| 0xbffff368 --&gt; 0x80483d9 (&lt;__libc_csu_init+9&gt;:,add    ebx,0x1c1b)
0004| 0xbffff36c --&gt; 0xb7fc6ff4 --&gt; 0x1a0d7c
0008| 0xbffff370 --&gt; 0x80483d0 (&lt;__libc_csu_init&gt;:,push   ebp)
0012| 0xbffff374 --&gt; 0x0
0016| 0xbffff378 --&gt; 0x0
0020| 0xbffff37c --&gt; 0xb7e3f4d3 (&lt;__libc_start_main+243&gt;:,mov    DWORD PTR [esp],eax)
0024| 0xbffff380 --&gt; 0x1
0028| 0xbffff384 --&gt; 0xbffff414 --&gt; 0xbffff576 (&#34;/home/dgioga/sss/test&#34;)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
 
Breakpoint 1, 0x080483ba in main ()
</code></pre><p>As you can see the operations that relate to the stack are:</p><ol><li><p>The old frame pointer is saved.</p></li><li><p>EBP takes the value of ESP (the frame pointer is set to point to the current function's frame).</p></li><li><p><code>0x10</code> is subtracted from ESP (reserve space for local variables).</p></li><li><p>The value <code>0x01</code> is placed at the address of EBP-0x4 (the local
variable <code>a</code> takes the value 1).</p></li></ol><h4 id=function-parameters>Function parameters</h4><p>The stack is also used to pass in parameters to functions.</p><p>In the process of calling a function we can define two entities. The callee (the function that gets called) and the caller (the function that calls).</p><p>When a function is called, the caller pushes the parameters for the callee on the stack. The parameters are pushed in reverse order.</p><p>When the callee wants to get access to the parameters it was called with, all it needs to do is access the area of the stack that is higher up in reference to the start of it's frame.</p><p>At this point it makes sense to remember the following cases:</p><ol><li><p>When EBP+value is referred to it is generally a referral to a parameter passed in to the current function.</p></li><li><p>When EBP-value is referred to it is generally a referral to a local variable.</p></li></ol><p>Lets see how this happens with the following code:</p><pre tabindex=0><code class=language-{.code data-lang={.code>#include &lt;stdio.h&gt;
 
int add(int a, int b)
{
        int c;
        c=a+b;
        return c;
}
 
int main()
{
        add(10,3);
        return 0;
}
</code></pre><pre tabindex=0><code class=language-{.code data-lang={.code>pwndbg&gt; pdis 0x080483ca
Dump of assembler code for function main:
   0x080483ca &lt;+0&gt;:,push   ebp                        #save the old frame pointer
   0x080483cb &lt;+1&gt;:,mov    ebp,esp                    #create the new frame pointer
   0x080483cd &lt;+3&gt;:,sub    esp,0x8                    #create space for local variables
   0x080483d0 &lt;+6&gt;:,mov    DWORD PTR [esp+0x4],0x3    #push the last parameter of the function that is to be called
   0x080483d8 &lt;+14&gt;:,mov    DWORD PTR [esp],0xa      #push the second to last(the first in this case) parameter of the function that is to be called
   0x080483df &lt;+21&gt;:,call   0x80483b4 &lt;add&gt;          #call the function
   0x080483e4 &lt;+26&gt;:,mov    eax,0x0
   0x080483e9 &lt;+31&gt;:,leave
   0x080483ea &lt;+32&gt;:,ret
End of assembler dump.
pwndbg&gt; pdis 0x080483b4
Dump of assembler code for function add:
   0x080483b4 &lt;+0&gt;:,push   ebp                        #save the old frame pointer
   0x080483b5 &lt;+1&gt;:,mov    ebp,esp                    #create a new frame pointer
   0x080483b7 &lt;+3&gt;:,sub    esp,0x10                   #create space for local variables
   0x080483ba &lt;+6&gt;:,mov    eax,DWORD PTR [ebp+0xc]    #move the first parameter into the EAX register (ebp+saved_ebp(4 bytes)+return_addres(4 bytes)+last_parameter(4 bytes))
   0x080483bd &lt;+9&gt;:,mov    edx,DWORD PTR [ebp+0x8]    #move the second parameter into the EDX register (ebp+saved_ebp(4 bytes)+return_addres(4 bytes))
   0x080483c0 &lt;+12&gt;:,add    eax,edx                  #add the registers
   0x080483c2 &lt;+14&gt;:,mov    DWORD PTR [ebp-0x4],eax  #place the result inside the local variable (c)
   0x080483c5 &lt;+17&gt;:,mov    eax,DWORD PTR [ebp-0x4]  #place the result inside the eax register in order to return it
   0x080483c8 &lt;+20&gt;:,leave
   0x080483c9 &lt;+21&gt;:,ret
End of assembler dump.
</code></pre><p>As you can see the parameters were pushed in reverse order, and the rule regarding the reference to EBP holds.</p><p>If you don't understand why the offset for the parameters starts at EBP+0x08 and not EBP follow through with the next section.</p><h4 id=calling-functions-call-and-ret>Calling functions (call and ret)</h4><p>When calling a function the callee places the return address on the stack. This address is nothing more than a bookmark so that execution can resume where it left off once the called function finishes
execution.</p><p>The last instruction in functions is usually a <code>ret</code> instruction that resumes execution to the callee.</p><p>For a better understanding of function calling and returning, from an execution flow point of view, please follow through with the following tip.</p><p><span style=font-size:1rem;background:lightgrey>The call instruction could be translated to the following instructions:</span></p><ol><li><code>push eip</code></li><li><code>mov eip, address_of_called_function</code></li></ol><p>The ret instruction could be translated into:</p><ol><li><code>pop eip</code></li></ol><p>The visual depiction of how the stack looks while a program is executing
can be found in section 2 but will be included here as well:</p><p align=center><img src="https://security.cs.pub.ro/summer-school/wiki/_media/session/stack-convention.png?w=600&tok=d710e1"></p><h3 id=next-lesson-preview-buffer-overflows>Next lesson preview: Buffer Overflows</h3><p>Now that we have a complete overview of the stack we can step forward to stack based buffer overflows.</p><p>A buffer overflow takes place when there is a lack of checking regarding boundaries and usually result in complete control of the program's instruction pointer. This takes place when a buffer overflows its boundaries and overwrites the return address of a function.</p><p>A typical example of buffer overflows can be seen in the following picture:</p><p align=center><img src="https://security.cs.pub.ro/summer-school/wiki/_media/session/s5_buffer_overflow.jpg?w=500&tok=810778"></p><h2 id=challenges>Challenges</h2><p>Use GDB and pwndbg to run the code provided in the Activities section.</p><h3 id=01-challenge---explore-the-simple-password-protected-bash>01. Challenge - Explore The Simple Password Protected Bash</h3><p>The executable gets input from the user and evaluates it against a static condition. If it succeeds it then calls a <code>password_accepted</code> function that prints out a success message and spawns a shell.</p><p>Your task is to use GDB and pwndbg to force the executable to call the <code>password_accepted</code> function.</p><p>Gather as much info about the executable as possible through the techniques you have learned in previous sessions.</p><p>Think of modifying registers for forcing the executable to call thefunction (there is more than one way of doing this).</p><h3 id=02-challenge---simple-password-protected-bash-destruction>02. Challenge - Simple Password Protected Bash Destruction</h3><p>What is the condition against which your input is evaluated in the executable contained in the executable <code>sppb</code>?</p><p><span style=font-size:1rem;background:lightgrey>The ultimate goal is to be able to craft an input for the binary so that
the <code>password_accepted</code> function is called (modifying registers while
running the program in GDB is just for training purposes).</span></p><h3 id=03-challenge---domino>03. Challenge - Domino</h3><p>Analyze the binary, reverse engineer what it does and get a nice message
back.</p><h3 id=04-challenge---call-me>04. Challenge - Call me</h3><p>Investigate the binary in <code>04-challenge-call-me/src/call_me</code> and find
out the flag</p><details><summary>Hint</summary>
There is something hidden you can toy around with.</details>
<details><summary>Hint</summary>
The challenge name is a hint.</details><h3 id=05-challenge---snooze-me>05. Challenge - Snooze Me</h3><p>I wrote a simple binary that computes the answer to life, the universe and everything. It swear it works&mldr; eventually.</p><h3 id=06-challenge---phone-home>06. Challenge - Phone Home</h3><p>To protect their confidential data from those snooping cloud providers, the authors of <code>06-challenge-phone-home/src/phone_home</code> have used some obfuscation techniques.</p><p>Unfortunately, the key feature of the application is now unreachable due to a bug. Can you bypass the impossible condition?</p><h3 id=07-challenge---chain-encoder>07. Challenge - Chain encoder</h3><p>How do you reverse something made to be ireversible, you are welcome to find out in this challenge.</p><h3 id=08-challenge---simple-cdkey>08. Challenge - Simple cdkey</h3><p>I found this software but i don&rsquo;t have the cd key, can you crack it for me?</p><hr><p>Except where otherwise noted, content on this wiki is licensed under the
following license: <a href=https://creativecommons.org/licenses/by-sa/4.0/deed.en>CC Attribution-Share Alike 4.0 International</a></p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/security-summer-school/security-summer-school.github.io/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/security-summer-school/security-summer-school.github.io/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof ga!="function")return;const t={command:"send",hitType:"event",category:"Helpful",action:"click",label:window.location.pathname,value:e};ga(t.command,t.hitType,t.category,t.action,t.label,t.value)};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://bit.ly/DiscordSecuritySummerSchool aria-label=Discord><i class="fab fa-discord"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Facebook aria-label=Facebook><a class=text-white target=_blank rel=noopener href=https://www.facebook.com/SSSUPB/ aria-label=Facebook><i class="fab fa-facebook"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank rel=noopener href=https://bit.ly/YoutubeSecuritySummerSchool aria-label=Youtube><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/security-summer-school aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 Open-Source Contributors. All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.aa9f4c5dae6a98b2c46277f4c56f1673a2b000d1756ce4ffae93784cab25e6d5.js integrity="sha256-qp9MXa5qmLLEYnf0xW8Wc6KwANF1bOT/rpN4TKsl5tU=" crossorigin=anonymous></script></body></html>