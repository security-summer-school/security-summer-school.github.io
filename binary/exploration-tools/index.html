<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.101.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Security Summer School</title><meta name=description content="Exploration Tools Table of contents Tutorials 01. Tutorial - Poor man&amp;rsquo;s technique: strings 02. Tutorial - Execution tracing (ltrace and strace) 03. Tutorial - Symbols: nm 04. Tutorial - Library dependencies 05. Tutorial - Network: netstat and netcat 06. Tutorial - Open files Challenges 07. Challenge - Perfect Answer 08. Challenge - Lots of strings 09. Challenge - Sleepy cats 10. Challenge - Hidden 11. Challenge - Detective Extra Further pwning Further Reading Tutorials When faced with a binary with no source or parts of the source missing you can infer some of its functionalities based upon some basic reconnaissance techniques using various tools."><meta property="og:title" content><meta property="og:description" content="Exploration Tools Table of contents Tutorials 01. Tutorial - Poor man&rsquo;s technique: strings 02. Tutorial - Execution tracing (ltrace and strace) 03. Tutorial - Symbols: nm 04. Tutorial - Library dependencies 05. Tutorial - Network: netstat and netcat 06. Tutorial - Open files Challenges 07. Challenge - Perfect Answer 08. Challenge - Lots of strings 09. Challenge - Sleepy cats 10. Challenge - Hidden 11. Challenge - Detective Extra Further pwning Further Reading Tutorials When faced with a binary with no source or parts of the source missing you can infer some of its functionalities based upon some basic reconnaissance techniques using various tools."><meta property="og:type" content="article"><meta property="og:url" content="/binary/exploration-tools/"><meta property="article:section" content="binary"><meta property="og:site_name" content="Security Summer School"><meta itemprop=name content><meta itemprop=description content="Exploration Tools Table of contents Tutorials 01. Tutorial - Poor man&rsquo;s technique: strings 02. Tutorial - Execution tracing (ltrace and strace) 03. Tutorial - Symbols: nm 04. Tutorial - Library dependencies 05. Tutorial - Network: netstat and netcat 06. Tutorial - Open files Challenges 07. Challenge - Perfect Answer 08. Challenge - Lots of strings 09. Challenge - Sleepy cats 10. Challenge - Hidden 11. Challenge - Detective Extra Further pwning Further Reading Tutorials When faced with a binary with no source or parts of the source missing you can infer some of its functionalities based upon some basic reconnaissance techniques using various tools."><meta itemprop=wordCount content="4313"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Exploration Tools Table of contents Tutorials 01. Tutorial - Poor man&rsquo;s technique: strings 02. Tutorial - Execution tracing (ltrace and strace) 03. Tutorial - Symbols: nm 04. Tutorial - Library dependencies 05. Tutorial - Network: netstat and netcat 06. Tutorial - Open files Challenges 07. Challenge - Perfect Answer 08. Challenge - Lots of strings 09. Challenge - Sleepy cats 10. Challenge - Hidden 11. Challenge - Detective Extra Further pwning Further Reading Tutorials When faced with a binary with no source or parts of the source missing you can infer some of its functionalities based upon some basic reconnaissance techniques using various tools."><link rel=preload href=/scss/main.min.5aef8a3f4159801f5dbe642e33f5332212e837eda91d37dcd891fdcd5c32498a.css as=style><link href=/scss/main.min.5aef8a3f4159801f5dbe642e33f5332212e837eda91d37dcd891fdcd5c32498a.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class=font-weight-bold>Security Summer School</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/binary/><span class=active>Binary Exploitation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/web/><span>Web Security</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-binary-li><a href=/binary/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-binary><span>Binary Exploitation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybuffer-exploitation-li><a href=/binary/buffer-exploitation/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybuffer-exploitation><span>Buffer Exploitation</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarydefense-mechanisms-li><a href=/binary/defense-mechanisms/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarydefense-mechanisms><span>Defense Mechanisms</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarydynamic-analysis-li><a href=/binary/dynamic-analysis/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarydynamic-analysis><span>Dynamic Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryexecutables-and-processes-li><a href=/binary/executables-and-processes/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryexecutables-and-processes><span>Executables and Processes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-binaryexploration-tools-li><a href=/binary/exploration-tools/ title class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-binaryexploration-tools><span class=td-sidebar-nav-active-item>Exploration Tools</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryinformation-leaks-li><a href=/binary/information-leaks/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryinformation-leaks><span>Information Leaks</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryreturn-oriented-programming-li><a href=/binary/return-oriented-programming/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryreturn-oriented-programming><span>Return Oriented Programming</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryreturn-oriented-programming-advanced-li><a href=/binary/return-oriented-programming-advanced/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryreturn-oriented-programming-advanced><span>Return Oriented Programming Advanced</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryshellcodes-li><a href=/binary/shellcodes/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryshellcodes><span>Shellcodes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryshellcodes-advanced-li><a href=/binary/shellcodes-advanced/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryshellcodes-advanced><span>Shellcodes Advanced</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarystatic-analysis-li><a href=/binary/static-analysis/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarystatic-analysis><span>Static Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybypassing-mitigationsactivities03-tutorial-bypass-dep-no-aslr-libcreadme-li><a href=/binary/bypassing-mitigations/activities/03-tutorial-bypass-dep-no-aslr-libc/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybypassing-mitigationsactivities03-tutorial-bypass-dep-no-aslr-libcreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybypassing-mitigationsactivities08-challenge-bypass-dep-no-aslr-libcreadme-li><a href=/binary/bypassing-mitigations/activities/08-challenge-bypass-dep-no-aslr-libc/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybypassing-mitigationsactivities08-challenge-bypass-dep-no-aslr-libcreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybypassing-mitigationsactivities09-challenge-bypass-dep-aslr-libcreadme-li><a href=/binary/bypassing-mitigations/activities/09-challenge-bypass-dep-aslr-libc/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybypassing-mitigationsactivities09-challenge-bypass-dep-aslr-libcreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarycontributing-li><a href=/binary/contributing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarycontributing><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarycopying-li><a href=/binary/copying/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarycopying><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryextrapwntools-introreadme-li><a href=/binary/extra/pwntools-intro/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryextrapwntools-introreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryreviewing-li><a href=/binary/reviewing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryreviewing><span></span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/security-summer-school/security-summer-school.github.io/tree/main/content/en/binary/exploration-tools/index.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/security-summer-school/security-summer-school.github.io/edit/main/content/en/binary/exploration-tools/index.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/security-summer-school/security-summer-school.github.io/new/main/content/en/binary/exploration-tools/index.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/security-summer-school/security-summer-school.github.io/issues/new?title=" class=td-page-meta--issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/security-summer-school/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=/binary/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#tutorials>Tutorials</a><ul><li><a href=#01-tutorial---poor-mans-technique-strings>01. Tutorial - Poor man&rsquo;s technique: strings</a></li><li><a href=#02-tutorial---execution-tracing-ltrace-and-strace>02. Tutorial - Execution tracing (ltrace and strace)</a></li><li><a href=#03-tutorial---symbols-nm>03. Tutorial - Symbols: nm</a></li><li><a href=#04-tutorial---library-dependencies>04. Tutorial - Library dependencies</a></li><li><a href=#05-tutorial---network-netstat-and-netcat>05. Tutorial - Network: netstat and netcat</a></li><li><a href=#06-tutorial---open-files>06. Tutorial - Open files</a></li></ul></li><li><a href=#challenges>Challenges</a><ul><li><a href=#07-challenge---perfect-answer>07. Challenge - Perfect Answer</a></li><li><a href=#08-challenge---lots-of-strings>08. Challenge - Lots of strings</a></li><li><a href=#09-challenge---sleepy-cats>09. Challenge - Sleepy cats</a></li><li><a href=#10-challenge---hidden>10. Challenge - Hidden</a></li><li><a href=#11-challenge---detective>11. Challenge - Detective</a></li><li><a href=#extra>Extra</a></li><li><a href=#further-pwning>Further pwning</a></li></ul></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/binary/>Binary Exploitation</a></li><li class="breadcrumb-item active" aria-current=page><a href=/binary/exploration-tools/ aria-disabled=true class="btn-link disabled">Exploration Tools</a></li></ol></nav><div class=td-content><h1></h1><header class=article-meta></header><h1 id=exploration-tools>Exploration Tools</h1><details open><summary>Table of contents</summary><ul><li><a href=#tutorials>Tutorials</a><ul><li><a href=#01-tutorial---poor-mans-technique-strings>01. Tutorial - Poor man&rsquo;s technique: strings</a></li><li><a href=#02-tutorial---execution-tracing-ltrace-and-strace>02. Tutorial - Execution tracing (ltrace and strace)</a></li><li><a href=#03-tutorial---symbols-nm>03. Tutorial - Symbols: nm</a></li><li><a href=#04-tutorial---library-dependencies>04. Tutorial - Library dependencies</a></li><li><a href=#05-tutorial---network-netstat-and-netcat>05. Tutorial - Network: netstat and netcat</a></li><li><a href=#06-tutorial---open-files>06. Tutorial - Open files</a></li></ul></li><li><a href=#challenges>Challenges</a><ul><li><a href=#07-challenge---perfect-answer>07. Challenge - Perfect Answer</a></li><li><a href=#08-challenge---lots-of-strings>08. Challenge - Lots of strings</a></li><li><a href=#09-challenge---sleepy-cats>09. Challenge - Sleepy cats</a></li><li><a href=#10-challenge---hidden>10. Challenge - Hidden</a></li><li><a href=#11-challenge---detective>11. Challenge - Detective</a></li><li><a href=#extra>Extra</a></li><li><a href=#further-pwning>Further pwning</a></li></ul></li><li><a href=#further-reading>Further Reading</a></li></ul></details><h2 id=tutorials>Tutorials</h2><p>When faced with a binary with no source or parts of the source missing you can infer some of its functionalities based upon some basic reconnaissance techniques using various tools.</p><h3 id=01-tutorial---poor-mans-technique-strings>01. Tutorial - Poor man&rsquo;s technique: strings</h3><p>The simplest recon technique is to dump the ASCII (or Unicode) text from a binary. It doesn&rsquo;t offer any guarantees but sometimes you can get a lot of useful information out of it.</p><blockquote><p>By default, when applied to a binary it only scans the data section. To obtain information such as the compiler version used in producing the binary use:</p></blockquote><pre tabindex=0><code>strings -a crackme1
</code></pre><p>Let&rsquo;s illustrate how strings can be useful in a simple context. Try out the <a href=./activities/01-tutorial-strings/src>crackme1</a> binary:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdlib.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;string.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>my_strcmp</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>s1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>s2</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>size_t</span> <span style=color:#000>i</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>len</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>strlen</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>s1</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>len</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>for</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>len</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>s1</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#000>s2</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>])</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>char</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1000</span><span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Password:</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>fgets</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1000</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>stdin</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87>NULL</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000>exit</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>buf</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>strlen</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;\0&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>my_strcmp</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>???????????????????????</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Correct!</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span>
</span></span><span style=display:flex><span>		<span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Nope!</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>The password has been redacted from the listing but you can retrieve it with <code>strings</code>. Try it out!</p><h3 id=02-tutorial---execution-tracing-ltrace-and-strace>02. Tutorial - Execution tracing (ltrace and strace)</h3><p><a href=https://man7.org/linux/man-pages/man1/ltrace.1.html>ltrace</a> is an utility that can list library function calls or <a href=https://man7.org/linux/man-pages/man2/syscalls.2.html>syscalls</a> made by a program. <a href=https://man7.org/linux/man-pages/man1/strace.1.html>strace</a> is similar, but only lists syscalls. A syscall is a service exposed by the kernel itself.</p><p>The way they work is with the aid of a special syscall, called <a href=https://man7.org/linux/man-pages/man2/ptrace.2.html>ptrace</a>. This single syscall forms the basis for most of the functionality provided by <code>ltrace</code>, <code>strace</code>, <code>gdb</code> and similar tools that debug programs. It can receive up to 4 arguments: the operation, the PID to act on, the address to read/write and the data to write. The functionality exposed by <code>ptrace()</code> is massive, but think of any functionality you&rsquo;ve seen in a debugger:</p><ul><li>attach/detach to/from a process</li><li>set breakpoints</li><li>continue a stopped program</li><li>read/write registers</li><li>act on signals</li><li>register syscalls</li></ul><p><code>strace</code> provides some pretty printing strictly concerning the syscalls of the traced process. However, <code>ltrace</code> provides further functionality and gathers information about all library calls. Here&rsquo;s how <code>ltrace</code> does its magic:</p><ul><li>it reads the tracee memory and parses it in order to find out about loaded symbols</li><li>it makes a copy of the binary code pertaining to a symbol using a <code>PTRACE_PEEKTEXT</code> directive of <code>ptrace()</code></li><li>it injects a breakpoint using a <code>PTRACE_POKETEXT</code> directive of <code>ptrace()</code></li><li>it listens for a <code>SIGTRAP</code> which will be generated when the breakpoint is hit</li><li>when the breakpoint is hit, ltrace can examine the stack of the tracee and print information such as function name, parameters, return codes, etc.</li></ul><p>Let&rsquo;s try the next <code>crackme</code>. If we remove <code>my_strcmp</code> from the previous crackme you can solve it even without <code>strings</code> because <code>strcmp</code> is called from <code>libc.so</code>. You can use <code>ltrace</code> and see what functions are used and check for their given parameters. Try it out on the second <code>crackme</code> where <code>strings</code> does not help (<a href=./activities/02-tutorial-execution-tracing/src>crackme2</a>):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdlib.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;string.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>char</span> <span style=color:#000>correct_pass</span><span style=color:#000;font-weight:700>[]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>?????????????????</span> <span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>deobf</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>s</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>???????????????</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>char</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1000</span><span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Password:</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>fgets</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1000</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>stdin</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87>NULL</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000>exit</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>buf</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>strlen</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;\0&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>strcmp</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>deobf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>correct_pass</span><span style=color:#000;font-weight:700>)))</span>
</span></span><span style=display:flex><span>		<span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Correct!</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>else</span>
</span></span><span style=display:flex><span>		<span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Nope!</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=03-tutorial---symbols-nm>03. Tutorial - Symbols: nm</h3><p>Symbols are basically tags/labels, either for functions or for variables. If you enable debugging symbols you will get information on all the variables defined but normally symbols are only defined for functions and global variables. When stripping binaries even these can be deleted without any effect on the binary behavior. Dynamic symbols, however, have to remain so that the linker knows what functions to import:</p><pre tabindex=0><code>$ file xy
xy: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.16, not stripped
$ nm xy
0804a020 B __bss_start
0804a018 D __data_start
0804a018 W data_start
0804a01c D __dso_handle
08049f0c d _DYNAMIC
0804a020 D _edata
0804a024 B _end
080484e4 T _fini
080484f8 R _fp_hw
0804a000 d _GLOBAL_OFFSET_TABLE_
         w __gmon_start__
080482d4 T _init
08049f04 t __init_array_end
08049f00 t __init_array_start
080484fc R _IO_stdin_used
         w _ITM_deregisterTMCloneTable
         w _ITM_registerTMCloneTable
         w _Jv_RegisterClasses
080484e0 T __libc_csu_fini
08048470 T __libc_csu_init
         U __libc_start_main@@GLIBC_2.0
0804843c T main
         U puts@@GLIBC_2.0
08048340 T _start
0804a020 D __TMC_END__
08048370 T __x86.get_pc_thunk.bx
$ strip xy
$ nm xy
nm: xy: no symbols
$ nm -D xy
         w __gmon_start__
080484fc R _IO_stdin_used
         U __libc_start_main
         U puts
</code></pre><p>Let&rsquo;s take a look at another crackme that combines crackme1 and crackme2. What would you do if you couldn&rsquo;t use neither strings nor ltrace to get anything useful?</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdlib.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;string.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>char</span> <span style=color:#000>correct_pass</span><span style=color:#000;font-weight:700>[]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>????????????????????????</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>my_strcmp</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>s1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>s2</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>size_t</span> <span style=color:#000>i</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>len</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>strlen</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>s1</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>len</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>for</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span> <span style=color:#ce5c00;font-weight:700>&lt;</span> <span style=color:#000>len</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>i</span><span style=color:#ce5c00;font-weight:700>++</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>s1</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#000>s2</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>i</span><span style=color:#000;font-weight:700>])</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>deobf</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>char</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>s</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>???????????????????????????</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>char</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1000</span><span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span>	<span style=color:#000>deobf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>correct_pass</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Password:</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>fgets</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1000</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>stdin</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87>NULL</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000>exit</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>buf</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>strlen</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;\0&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>my_strcmp</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>correct_pass</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Correct!</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span>
</span></span><span style=display:flex><span>		<span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Nope!</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>In <a href=./activities/03-tutorial-symbols/src>crackme3</a>, deobfuscation is done before the password is read. Since the <code>correct_pass</code> has an associated symbol that is stored at a known location you can obtain the address and peer into it at runtime:</p><pre tabindex=0><code>$ nm crackme3 | grep pass
0804a02c D correct_pass
$ gdb -n ./crackme3
Reading symbols from ./crackme3...(no debugging symbols found)...done.
(gdb) run
Password:
^C
Program received signal SIGINT, Interrupt.
0xf7fdb430 in __kernel_vsyscall ()
(gdb) x/s 0x0804a02c
0x804a02c &lt;correct_pass&gt;:    &#34;JWxb7gE2pjiY3gRG8U&#34;
</code></pre><p>The above <code>x/s 0x0804a02c</code> command in GDB is used for printing the string starting from address <code>0x0804a02c</code>. <code>x</code> stands for examine memory and <code>s</code> stands for string format. In short it dumps memory in string format starting from the address passed as argument. You may print multiple strings by prefixing <code>s</code> with a number, for example <code>x/20s 0x0804a02c</code>.</p><p>For other programs (that are not stripped) you can even get a hint as to what they do using solely <code>nm</code>:</p><pre tabindex=0><code>$ nm mystery_binary
.....
0000000000402bef T drop_privs(char const*)
00000000004027db T IndexHandler(std::string const&amp;, HttpRequest const&amp;, HttpResponse*)
0000000000402ad8 T StatusHandler(std::string const&amp;, HttpRequest const&amp;, HttpResponse*)
000000000040237f T NotFoundHandler(std::string const&amp;, HttpRequest const&amp;, HttpResponse*)
00000000004024a1 T BadRequestHandler(std::string const&amp;, HttpRequest const&amp;, HttpResponse*)
00000000004025c3 T MaybeAddCORSHeader(std::string const&amp;, HttpRequest const&amp;, HttpResponse*)
0000000000402f52 t __static_initialization_and_destruction_0(int, int)
0000000000402cf8 T handle(int)
00000000004020fc T recvlen(int, char*, unsigned long)
0000000000402195 T sendlen(int, char const*, unsigned long)
0000000000402224 T sendstr(int, char const*)
0000000000402255 T urldecode(std::string const&amp;)
.....
</code></pre><p><strong>Note:</strong> In this case the signatures are also decoded because the binary was compiled from C++ source code.</p><p>Dealing with stripped binaries (or worse, statically linked binaries that have been stripped) is harder but can still be done. We&rsquo;ll see how in a future lab.</p><h3 id=04-tutorial---library-dependencies>04. Tutorial - Library dependencies</h3><p>Most programs you will see make use of existing functionality. You don&rsquo;t want to always reimplement string functions or file functions. Therefore, most programs use dynamic libraries. These shared objects, as they are called alternatively, allow you to have a smaller program and also allow multiple programs to use a single copy of the code within the library. But how does that actually work?</p><p>What makes all of these programs work is the Linux dynamic linker/loader. This is a statically linked helper program that resolves symbol names from shared objects at runtime. We can use the dynamic linker to gather information about an executable.</p><p>The first and most common thing to do is see what libraries the executable loads, with the <a href=https://man7.org/linux/man-pages/man1/ldd.1.html>ldd</a> utility:</p><pre tabindex=0><code>$ ldd /bin/ls
    linux-vdso.so.1 (0x00007ffff13fe000)
    librt.so.1 =&gt; /lib64/librt.so.1 (0x00007fc9b4893000)
    libacl.so.1 =&gt; /lib64/libacl.so.1 (0x00007fc9b468a000)
    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007fc9b42da000)
    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007fc9b40bd000)
    libattr.so.1 =&gt; /lib64/libattr.so.1 (0x00007fc9b3eb8000)
    /lib64/ld-linux-x86-64.so.2 (0x00007fc9b4a9b000)
</code></pre><p>We see that for each dependency in the executable, <code>ldd</code> lists where it is found on the filesystem and where it is loaded in the process memory space. Alternatively, you can achieve the same result with the <code>LD_TRACE_LOADED_OBJECTS</code> environment variable, or with the dynamic loader itself:</p><pre tabindex=0><code>$ LD_TRACE_LOADED_OBJECTS=whatever /bin/ls
    linux-vdso.so.1 (0x00007fff325fe000)
    librt.so.1 =&gt; /lib64/librt.so.1 (0x00007f1845386000)
    libacl.so.1 =&gt; /lib64/libacl.so.1 (0x00007f184517d000)
    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f1844dcd000)
    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f1844bb0000)
    libattr.so.1 =&gt; /lib64/libattr.so.1 (0x00007f18449ab000)
    /lib64/ld-linux-x86-64.so.2 (0x00007f184558e000)
$ /lib/ld-linux-x86-64.so.2 --list /bin/ls
    linux-vdso.so.1 (0x00007fff1e712000)
    librt.so.1 =&gt; /lib64/librt.so.1 (0x00007f18a07d8000)
    libacl.so.1 =&gt; /lib64/libacl.so.1 (0x00007f18a05cf000)
    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f18a021e000)
    libattr.so.1 =&gt; /lib64/libattr.so.1 (0x00007f189fdfc000)
    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f18a0001000)
    /lib64/ld-linux-x86-64.so.2 =&gt; /lib/ld-linux-x86-64.so.2 (0x00007f18a0c44000)
</code></pre><blockquote><p>When using the loader directly, make sure the loader and the executable are compiled for the same platform (e.g. they are both 64-bit or 32-bit).</p></blockquote><blockquote><p>You may find out more information about dynamic linker/loader variables in its man page. Issue the command</p></blockquote><pre tabindex=0><code>man ld-linux.so
</code></pre><blockquote><p>and search for the LD_ string to find variables information.</p></blockquote><p><code>ldd</code> shows us <strong>which</strong> libraries are loaded, but it&rsquo;s not any clearer how the loader knows <strong>where</strong> to load them from. First of all, the loader checks every dependency for a slash character. If it finds such a dependency it loads the library from that path, whether it is a relative of absolute path. But it is not the case in our example. For dependencies without slashes, the search order is as follows:</p><ul><li><code>DT_RPATH</code> attribute in the <code>.dynamic</code> section of the executable, provided there is no <code>DT_RUNPATH</code>; this is deprecated</li><li><code>LD_LIBRARY_PATH</code> environment variable, which is similar to PATH; does not work with SUID/SGID programs</li><li><code>DT_RUNPATH</code> attribute in the .dynamic section of the executable</li><li><code>/etc/ld.so.cache</code>, generated by <a href=https://man7.org/linux/man-pages/man8/ldconfig.8.html>ldconfig</a></li><li><code>/lib</code> and then <code>/usr/lib</code></li></ul><p>The last two options are skipped if the program was linked with the <code>-z nodeflib</code> option.</p><p>Now let&rsquo;s see exactly where the loader finds the libraries:</p><pre tabindex=0><code>$ LD_DEBUG=libs /bin/ls
     11451:    find library=librt.so.1 [0]; searching
     11451:     search cache=/etc/ld.so.cache
     11451:      trying file=/lib64/librt.so.1
     11451:
     11451:    find library=libacl.so.1 [0]; searching
     11451:     search cache=/etc/ld.so.cache
     11451:      trying file=/lib64/libacl.so.1
     11451:
     11451:    find library=libc.so.6 [0]; searching
     11451:     search cache=/etc/ld.so.cache
     11451:      trying file=/lib64/libc.so.6
     11451:
     11451:    find library=libpthread.so.0 [0]; searching
     11451:     search cache=/etc/ld.so.cache
     11451:      trying file=/lib64/libpthread.so.0
     11451:
     11451:    find library=libattr.so.1 [0]; searching
     11451:     search cache=/etc/ld.so.cache
     11451:      trying file=/lib64/libattr.so.1
</code></pre><p>The <code>LD_DEBUG</code> environment variable makes the dynamic loader be verbose about what it&rsquo;s doing. Try <code>LD_DEBUG=help</code> if you&rsquo;re curious about what else you can find out. We can see in the output listed above that all the libraries are found via the loader cache. The number at the beginning of each line is ls&rsquo;s PID.</p><p>And now we can discuss <strong>how</strong> the loader resolves symbols after it has found the libraries containing them. While variables are resolved when the library is opened, that is not the case for function references. When dealing with functions, the Linux dynamic loader uses something called lazy binding, which means that a function symbol in the library is not resolved until the very first call to it. Think about why this difference exists.</p><p>You can see the way lazy binding behaves:</p><pre tabindex=0><code>$ LD_DEBUG=symbols,bindings ./crackme2
...
     11480:    initialize program: ./crackme2
     11480:
     11480:
     11480:    transferring control: ./crackme2
     11480:
     11480:    symbol=puts;  lookup in file=./crackme2 [0]
     11480:    symbol=puts;  lookup in file=/lib32/libc.so.6 [0]
     11480:    binding file ./crackme2 [0] to /lib32/libc.so.6 [0]: normal symbol &#39;puts&#39; [GLIBC_2.0]
Password:
     11480:    symbol=fgets;  lookup in file=./crackme2 [0]
     11480:    symbol=fgets;  lookup in file=/lib32/libc.so.6 [0]
     11480:    binding file ./crackme2 [0] to /lib32/libc.so.6 [0]: normal symbol &#39;fgets&#39; [GLIBC_2.0]
I_pity_da_fool_who_gets_here_without_solving_crackme2
     11480:    symbol=strlen;  lookup in file=./crackme2 [0]
     11480:    symbol=strlen;  lookup in file=/lib32/libc.so.6 [0]
     11480:    binding file ./crackme2 [0] to /lib32/libc.so.6 [0]: normal symbol &#39;strlen&#39; [GLIBC_2.0]
     11480:    symbol=strcmp;  lookup in file=./crackme2 [0]
     11480:    symbol=strcmp;  lookup in file=/lib32/libc.so.6 [0]
     11480:    binding file ./crackme2 [0] to /lib32/libc.so.6 [0]: normal symbol &#39;strcmp&#39; [GLIBC_2.0]
Nope!
     11480:
     11480:    calling fini: ./crackme2 [0]
     11480:
</code></pre><p>As you can see, functions like <code>puts()</code>, <code>fgets()</code>, <code>strlen()</code> and <code>strcmp()</code> are not actually resolved until the first call to them is made. Make the loader resolve all the symbols at startup. (Hint: <a href=https://man7.org/linux/man-pages/man8/ld-linux.8.html>ld-linux</a>).</p><p><strong>Library Wrapper Task</strong></p><p>You&rsquo;ve previously solved <code>crackme2</code> with the help of the <code>ltrace</code>. Check out the files from <a href=./activities/04-tutorial-library-dependencies/src>04-tutorial-library-dependencies</a>. The folder consists of a <code>Makefile</code> and a C source code file reimplementing the <code>strcmp()</code> function (library wrapper). The <code>strcmp.c</code> implementation uses <code>LD_PRELOAD</code> to wrap the actual <code>strcmp()</code> call to our own.</p><p>In order to see how that works, we need to create a shared library and pass it as an argument to <code>LD_PRELOAD</code>. The <code>Makefile</code> already takes care of this. To build and run the entire thing, simply run:</p><pre tabindex=0><code>make run
</code></pre><p>This will build the shared library file (<code>strcmp.so</code>) and run the <code>crackme2</code> executable under <code>LD_PRELOAD</code>.</p><p>Our goal is to use the <code>strcmp()</code> wrapper to alter the program behavior. We have two ways to make the <code>crackme2</code> program behave our way:</p><ol><li>Leak the password in the <code>strcmp()</code> wrapper.</li><li>Pass the check regardless of what password we provide.</li></ol><p>Modify the <code>strcmp()</code> function in the <code>strcmp.c</code> source code file to alter the the <code>crackme2</code> program behavior in each of the two ways shown above. To test it, use the <code>Makefile</code>:</p><pre tabindex=0><code>make run
</code></pre><h3 id=05-tutorial---network-netstat-and-netcat>05. Tutorial - Network: netstat and netcat</h3><p>Services running on remote machines offer a gateway to those particular machines. Whether it&rsquo;s improper handling of the data received from clients, or a flaw in the protocol used between server and clients, certain privileges can be obtained if care is not taken. We&rsquo;ll explore some tools and approaches to analyzing remote services. To follow along, use the server and client programs from <a href=./activities/05-tutorial-network-netstat-netcat/src>05-tutorial-network-netstat-netcat</a>.</p><p>First of all, start the server:</p><pre tabindex=0><code>$ ./server
Welcome to the awesome server.
Valid commands are:
quit
status
</code></pre><p>Running any of them at this point doesn&rsquo;t offer much help. We&rsquo;ll come back to this later.</p><p>The most straightforward way to see what a server does is the <a href=https://man7.org/linux/man-pages/man8/netstat.8.html>netstat</a> utility.</p><pre tabindex=0><code>$ netstat -tlpn
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:36732           0.0.0.0:*               LISTEN      3062/steam
tcp        0      0 127.0.0.1:57343         0.0.0.0:*               LISTEN      3062/steam
tcp        0      0 127.0.0.1:31337         0.0.0.0:*               LISTEN      15022/./server
tcp        0      0 0.0.0.0:58154           0.0.0.0:*               LISTEN      3062/steam
tcp        0      0 127.0.0.1:60783         0.0.0.0:*               LISTEN      2644/SpiderOak
tcp        0      0 192.168.101.1:53        0.0.0.0:*               LISTEN      -
tcp        0      0 192.168.100.1:53        0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:44790           0.0.0.0:*               LISTEN      2644/SpiderOak
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      -
tcp6       0      0 :::631                  :::*                    LISTEN      -
</code></pre><p>Here we&rsquo;re looking at all the programs that are listening (<code>-l</code>) on a TCP port (<code>-t</code>). We&rsquo;re also telling netcat not to resolve hosts (<code>-n</code>) and to show the process that is listening (<code>-p</code>). We can see that our server is listening on port 31337. Let&rsquo;s keep that in mind and see how the client behaves.</p><pre tabindex=0><code>$ ./client
Usage: ./client &lt;client name&gt; &lt;server IP&gt; &lt;server port&gt;
$ ./client the_laughing_man localhost 31337
Welcome to the awesome server.
Valid commands are:
listclients
infoclient &lt;client name&gt; [ADMIN access required]
    name, IP, port, privileged, connected time
sendmsg &lt;client name&gt; &lt;message&gt;

Enter a command (or &#39;quit&#39; to exit):
listclients
Connected clients are:
the_laughing_man
Enter a command (or &#39;quit&#39; to exit):
sendmsg the_laughing_man test
Enter a command (or &#39;quit&#39; to exit):
Message from the_laughing_man
test

Enter a command (or &#39;quit&#39; to exit):
infoclient the_laughing_man
Not enough minerals!

Enter a command (or &#39;quit&#39; to exit):
</code></pre><p>So we can do anything except the privileged command <code>infoclient</code>. Running <code>status</code> on the server yields no information. What can we do now?</p><p>We can see what the server and client are exchanging at an application level by capturing the traffic with the <a href=https://man7.org/linux/man-pages/man1/tcpdump.1.html>tcpdump</a> utility. Start tcpdump, the server and then the client, and run the commands again. When you&rsquo;re done, stop tcpdump with Ctrl+C.</p><pre tabindex=0><code># tcpdump -i any -w crackme5.pcap &#39;port 31337&#39;
tcpdump: listening on any, link-type LINUX_SLL (Linux cooked), capture size 65535 bytes
^C21 packets captured
42 packets received by filter
0 packets dropped by kernel
</code></pre><p>Here we&rsquo;re telling tcpdump to listen on all available interfaces, write the capture to the <code>crackme5.pcap</code> file and only log packets that have the source or destination port equal to 31337.</p><p>We can then open our capture with <a href=https://www.wireshark.org/>wireshark</a> in order to analyze the packets in a friendlier manner.
You can look at the packets exchanged between server and client.
Notice that there seems to be some sort of protocol where values are delimited by the pipe character.
What is especially interesting is the first data packet sent from the client to the server, which sends <code>the_laughing_man|false</code>.
While we&rsquo;ve specified the client name, there was nothing we could specify via the client command-line in order to control the second value.</p><p>However, since this seems to be a plaintext protocol, there is an alternative course of action available.
The <a href=https://linux.die.net/man/1/nc>netcat</a> utility allows for arbitrary clients and servers.
It just needs a server address and a server port in client mode.
We can use it instead of the &ldquo;official&rdquo; client and see what happens when we craft the first message.
Go ahead!
Start the server again and a normal client.</p><blockquote><p>Connect to the server using <code>netcat</code>. Then send out the required string through the <code>netcat</code> connection with true as the second parameter and see if you can find out anything about the normal client.</p></blockquote><pre tabindex=0><code># netcat localhost 31337
Welcome to the awesome server.
Valid commands are:
listclients
infoclient &lt;client name&gt; [ADMIN access required]
    name, IP, port, privileged, connected time
sendmsg &lt;client name&gt; &lt;message&gt;
</code></pre><p><strong>Doing it in Python</strong></p><p>You can create a sever and a client in Python only. We can use the <code>server.py</code> and <code>client.py</code> scripts. Check them out first.</p><p>Then run the server by using:</p><pre tabindex=0><code>python server.py
</code></pre><p>It now accepts connections on TCP port 9999 as you can see by using <code>netstat</code>:</p><pre tabindex=0><code>$ netstat -tlpn
[...]
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 127.0.0.1:9999          0.0.0.0:*               LISTEN      12541/python
[...]
</code></pre><p>Now you can test it using the Python client:</p><pre tabindex=0><code>$ python client.py
sending &#39;anaaremere&#39;
received &#39;ANAAREMERE&#39;
</code></pre><p>We can do the same using netcat as the client:</p><pre tabindex=0><code>$ nc localhost 9999
anaaremere
ANAAREMERE
</code></pre><p><strong>Doing it Only with netcat</strong></p><p>We can still simulate a network connection using netcat only, both for starting the server and for runing the client.</p><p>Start the server with:</p><pre tabindex=0><code>$ nc -l -p 4444
</code></pre><p>Now run the client and send messages by writing them to standard input:</p><pre tabindex=0><code>$ nc localhost 4444
aaaaa
bbbbb
</code></pre><p>Messages you write to the client and up in the server.</p><p>This goes both ways: if you write messages on the server they end up in the client. Try that.</p><p>If you want to send a large chunk of data you can redirect a file. Start the server again:</p><pre tabindex=0><code>$ nc -l -p 4444
</code></pre><p>and now send the file to it:</p><pre tabindex=0><code>$ cat /etc/services | nc localhost 4444
</code></pre><p>It&rsquo;s now on the server side.</p><p>You can also do it with UDP, instead of TCP by using the <code>-u</code> flag both for the server and the client. Start the server using:</p><pre tabindex=0><code>$ nc -u -l -p 4444
</code></pre><p>And run the client using:</p><pre tabindex=0><code>$ cat /etc/services | nc -u localhost 4444
</code></pre><p>That&rsquo;s how we use netcat (the network swiss army knife).</p><blockquote><p>You can also look into <a href=https://linux.die.net/man/1/socat>socat</a> for a complex tool on dealing with sockets.</p></blockquote><h3 id=06-tutorial---open-files>06. Tutorial - Open files</h3><p>Let&rsquo;s remember how files and programs relate in Linux.</p><p><img src=assets/files.png alt=Files></p><p>Let&rsquo;s also remember that, in Linux, <code>file</code> can mean one of many things:</p><ul><li>regular file</li><li>directory</li><li>block device</li><li>character device</li><li>named pipe</li><li>symbolic or hard link</li><li>socket</li></ul><p>Let&rsquo;s look at the previous server from <code>crackme5</code>. Start it up once again.</p><p>While previously we&rsquo;ve used netstat to gather information about it, that was by no means the only solution. <a href=https://linux.die.net/man/8/lsof>lsof</a> is a tool that can show us what files a process has opened:</p><pre tabindex=0><code>$ lsof -c server
COMMAND  PID   USER   FD   TYPE DEVICE SIZE/OFF    NODE NAME
server  9678 amadan  cwd    DIR    8,6     4096 1482770 /home/amadan/projects/sss/session01/crackmes/crackme5
server  9678 amadan  rtd    DIR    8,6     4096       2 /
server  9678 amadan  txt    REG    8,6    17524 1442625 /home/amadan/projects/sss/session01/crackmes/crackme5/server
server  9678 amadan  mem    REG    8,6  1753240 3039007 /lib64/libc-2.17.so
server  9678 amadan  mem    REG    8,6    88088 3039019 /lib64/libnsl-2.17.so
server  9678 amadan  mem    REG    8,6   144920 3038998 /lib64/ld-2.17.so
server  9678 amadan    0u   CHR  136,2      0t0       5 /dev/pts/2
server  9678 amadan    1u   CHR  136,2      0t0       5 /dev/pts/2
server  9678 amadan    2u   CHR  136,2      0t0       5 /dev/pts/2
server  9678 amadan    3u  IPv4 821076      0t0     TCP *:31337 (LISTEN)
</code></pre><p>We can see the standard file descriptors found in any process, as well as our socket.</p><ul><li><p>The <code>FD</code> column shows the file descriptor entry for a file, or a role in case of special files. We notice the current working directory (<code>cwd</code>), the root directory (<code>rtd</code>), the current executable (<code>txt</code>), some memory mapped files (<code>mem</code>) and the file descriptors (0-3). For normal file descriptors, <code>r</code> means read access, <code>w</code> means write access and <code>u</code> means both.</p></li><li><p>The <code>TYPE</code> column shows whether we&rsquo;re dealing with a directory (<code>DIR</code>), a regular file (<code>REG</code>), a character device (<code>CHR</code>), a socket (<code>IPv4</code>) or other type of file.</p></li><li><p>The <code>NODE</code> column shows the inode of the file, or a class marker as is the case for the socket.</p></li><li><p>The <code>NAME</code> column shows the path to the file, or the bound address and port for a socket.</p></li></ul><p>We&rsquo;ve left out some details since they are not relevant for our purposes. Feel free to read the manual page.</p><p>You could also get some hint that there is an open socket by looking into the <code>/proc</code> virtual filesystem:</p><pre tabindex=0><code>$ ls -l /proc/`pidof server`/fd
total 0
lrwx------ 1 amadan amadan 64 Jun 15 22:04 0 -&gt; /dev/pts/2
lrwx------ 1 amadan amadan 64 Jun 15 22:04 1 -&gt; /dev/pts/2
lrwx------ 1 amadan amadan 64 Jun 15 22:03 2 -&gt; /dev/pts/2
lrwx------ 1 amadan amadan 64 Jun 15 22:04 3 -&gt; socket:[883625]
</code></pre><p>We&rsquo;ll be using <a href=./activities/06-tutorial-open-files/src>crackme6</a> for the next part of this section.
Try the conventional means of <code>strings</code> and <code>ltrace</code> on it. Then run it normally.</p><pre tabindex=0><code>$ ./crackme6
Type &#39;start&#39; to begin authentication test
</code></pre><p>Before complying to what the program tells us, let&rsquo;s use <code>lsof</code> to see what we can find out:</p><pre tabindex=0><code>$ lsof -c crackme6
COMMAND    PID   USER   FD   TYPE DEVICE SIZE/OFF    NODE NAME
crackme6 10466 amadan  cwd    DIR    8,6     4096 1482769 /home/amadan/projects/sss/session01/06-tutorial-open-files
crackme6 10466 amadan  rtd    DIR    8,6     4096       2 /
crackme6 10466 amadan  txt    REG    8,6    12922 5377126 /home/amadan/projects/sss/session01/06-tutorial-open-files/crackme6
crackme6 10466 amadan  mem    REG    8,6  1753240 3039007 /lib64/libc-2.17.so
crackme6 10466 amadan  mem    REG    8,6   100680 3039039 /lib64/libpthread-2.17.so
crackme6 10466 amadan  mem    REG    8,6   144920 3038998 /lib64/ld-2.17.so
crackme6 10466 amadan    0u   CHR  136,2      0t0       5 /dev/pts/2
crackme6 10466 amadan    1u   CHR  136,2      0t0       5 /dev/pts/2
crackme6 10466 amadan    2u   CHR  136,2      0t0       5 /dev/pts/2
crackme6 10466 amadan    3w  FIFO   0,32      0t0  988920 /tmp/crackme6.fifo
crackme6 10466 amadan    4r  FIFO   0,32      0t0  988920 /tmp/crackme6.fifo
</code></pre><p>There seems to be a named pipe used by the executable. Let&rsquo;s look at it:</p><pre tabindex=0><code>$ more /tmp/crackme6.fifo
</code></pre><p>Now go back again at the <code>crackme6</code> console and type <code>start</code>. If you see the message that the authentication test has succeeded, quit and try again. If you do not see the message, kill the <code>crackme6</code> process, look at the more command output and then delete the pipe file. Now try the password.</p><p><strong>Misc</strong></p><p>There are other sources of information available about running processes if you prefer to do things by hand such as:</p><ul><li><code>/proc/&lt;PID>/environ</code>: all environment variables given when the process was started</li><li><code>/proc/&lt;PID>/fd</code>: opened file descriptors.</li><li><code>/proc/&lt;PID>/mem</code>: address space layout</li><li><code>/proc/&lt;PID>/cwd</code>: symlink to working directory</li><li><code>/proc/&lt;PID>/exe</code>: symlink to binary image</li><li><code>/proc/&lt;PID>/cmdline</code>: complete program commandline, with arguments</li></ul><h2 id=challenges>Challenges</h2><p>Challenges can be found in the <code>activities/&lt;CHALLENGE_NUMBER>-challenge-&lt;CHALLENGE_NAME></code> directory.</p><h3 id=07-challenge---perfect-answer>07. Challenge - Perfect Answer</h3><p>For this task use the <a href=./activities/07-challenge-perfect-answer/src>perfect</a> binary.</p><p>Can you find the flag?</p><h3 id=08-challenge---lots-of-strings>08. Challenge - Lots of strings</h3><p>Use the <a href=./activities/08-challenge-lots-of-strings/src>lots_of_strings</a> binary.</p><p>Can you find the <strong>password</strong>?</p><blockquote><p>Hint: use the tools presented in the tutorials.</p></blockquote><h3 id=09-challenge---sleepy-cats>09. Challenge - Sleepy cats</h3><p>For this task use the <a href=./activities/09-challenge-sleepy-cats/src>sleepy</a> binary.</p><p>The <code>sleep()</code> function takes too much. Ain&rsquo;t nobody got time for that. We want the flag NOW!!</p><p>Modify the binary in order to get the flag.</p><blockquote><p>To edit a binary, you can use <a href=https://vim.fandom.com/wiki/Hex_dump#Editing_binary_files>vim + xxd</a> or <code>Bless</code>.
We strongly encourage you to use <code>Bless</code></p></blockquote><h3 id=10-challenge---hidden>10. Challenge - Hidden</h3><p>For this challenge use the <a href=./activities/10-challenge-hidden/src>hidden</a> binary.</p><p>Can you find the hidden flag?</p><blockquote><p>You could use <code>ltrace</code> and <code>strace</code> to find the flag. But try to make it give you the flag by simply altering the environment, do not attach to the executable.</p></blockquote><h3 id=11-challenge---detective>11. Challenge - Detective</h3><p>This challenge runs remotely at <code>141.85.224.104:31337</code>. You can use <code>netcat</code> to connect to it.</p><p>Investigate the <a href=./activities/11-challenge-detective/src>detective</a> binary. See what it does and work to get the flag.</p><p>You can start from the <a href=./activities/11-challenge-detective/sol/exploit_template.py>sol/exploit_template.py</a> solution template script.</p><blockquote><p>There is a bonus to this challenge and you will be able to find another flag. See that below.</p></blockquote><p><strong>Bonus: Get the Second Flag</strong></p><p>You can actually exploit the remote <a href=./activities/11-challenge-detective/src>detective</a> executable and get the second flag. Look thoroughly through the executable and craft your payload to exploit the remote service.</p><blockquote><p>You need to keep the connection going. Use the construction: <code>cat /path/to/file - | nc &lt;host> &lt;port></code></p></blockquote><h3 id=extra>Extra</h3><p>If you want some more, have a go at the <a href=./activities/bonus/src>bonus</a> task. It is a simplified CTF task that you should be able to solve using the information learned in this lab.</p><blockquote><p>Hint: This executable needs elevated permissions (run with <code>sudo</code>).</p></blockquote><h3 id=further-pwning>Further pwning</h3><p><a href=http://pwnable.kr/>pwnable.kr</a> is a wargames site with fun challenges of different difficulty levels. After completing all tutorials and challenges in this session, you should be able to go there and try your hand at the following games from Toddler&rsquo;s bottle: <code>fd</code>, <code>collision</code>, <code>bof</code>, <code>passcode</code>, <code>mistake</code>, <code>cmd1</code>, <code>blukat</code> (of course, you are encouraged to try any other challenges, but they might get frustrating, as they require knowledge of notions we will explore in future sessions).</p><h2 id=further-reading>Further Reading</h2><ul><li><a href=https://man7.org/linux/man-pages/man1/ltrace.1.html>ltrace</a></li><li><a href=https://man7.org/linux/man-pages/man2/syscalls.2.html>syscalls</a></li><li><a href=https://man7.org/linux/man-pages/man2/ptrace.2.html>ptrace</a></li><li><a href=https://man7.org/linux/man-pages/man2/ptrace.2.html>ldconfig</a></li><li><a href=https://linux.die.net/man/1/socat>socat</a></li><li><a href=https://linux.die.net/man/8/lsof>lsof</a></li><li><a href=https://vim.fandom.com/wiki/Hex_dump#Editing_binary_files>vim + xxd</a></li></ul><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/security-summer-school/security-summer-school.github.io/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/security-summer-school/security-summer-school.github.io/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof ga!="function")return;const t={command:"send",hitType:"event",category:"Helpful",action:"click",label:window.location.pathname,value:e};ga(t.command,t.hitType,t.category,t.action,t.label,t.value)};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://bit.ly/DiscordSecuritySummerSchool aria-label=Discord><i class="fab fa-discord"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Facebook aria-label=Facebook><a class=text-white target=_blank rel=noopener href=https://www.facebook.com/SSSUPB/ aria-label=Facebook><i class="fab fa-facebook"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank rel=noopener href=https://bit.ly/YoutubeSecuritySummerSchool aria-label=Youtube><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/security-summer-school aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2024 Open-Source Contributors. All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.aa9f4c5dae6a98b2c46277f4c56f1673a2b000d1756ce4ffae93784cab25e6d5.js integrity="sha256-qp9MXa5qmLLEYnf0xW8Wc6KwANF1bOT/rpN4TKsl5tU=" crossorigin=anonymous></script></body></html>