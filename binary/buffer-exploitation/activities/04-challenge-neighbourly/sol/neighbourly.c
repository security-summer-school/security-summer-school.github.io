#include <stdio.h>
#include <stdlib.h>

void win() {
	system("/bin/sh");
}

struct neighbours {
	char chars[32];
	void (*ptext)();
};

void ptext(struct neighbours* self) {
	printf("%s\n", self->chars);
	fflush(stdout);
}

void neigh(struct neighbours* n) {
	n->ptext = ptext;
	fgets(n->chars, 50, stdin);
	n->ptext(n);
}

int main(int argc, char* argv[])
{
	setvbuf(stdin, NULL, _IONBF, 0);
	setvbuf(stdout, NULL, _IONBF, 0);

	struct neighbours* n = malloc(sizeof(struct neighbours));
	puts("Oh, hi neighbour!");
	fflush(stdout);
	puts("Give me some text and I'll print it for you, yessir.");
	fflush(stdout);
	neigh(n);
	free(n);
	return 0;
}
