<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.101.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Security Summer School</title><meta name=description content="Introduction In the previous 2 sessions you started discovering what binary security looks like. Last session you learnt two very powerful means of investigating and even reverse engineering executables: static and dynamic analysis. In order to leverage them efficiently, you used Ghidra for static analysis. Now we&amp;rsquo;ll introduce GDB for dynamic analysis. You&amp;rsquo;ve most likely noticed that they are able to display the source code of the application. GDB can do so when said app was compiled with debug symbols, while Ghidra does not even need debug symbols."><meta property="og:title" content><meta property="og:description" content="Introduction In the previous 2 sessions you started discovering what binary security looks like. Last session you learnt two very powerful means of investigating and even reverse engineering executables: static and dynamic analysis. In order to leverage them efficiently, you used Ghidra for static analysis. Now we&rsquo;ll introduce GDB for dynamic analysis. You&rsquo;ve most likely noticed that they are able to display the source code of the application. GDB can do so when said app was compiled with debug symbols, while Ghidra does not even need debug symbols."><meta property="og:type" content="article"><meta property="og:url" content="/essentials/assembly-language/"><meta property="article:section" content="essentials"><meta property="og:site_name" content="Security Summer School"><meta itemprop=name content><meta itemprop=description content="Introduction In the previous 2 sessions you started discovering what binary security looks like. Last session you learnt two very powerful means of investigating and even reverse engineering executables: static and dynamic analysis. In order to leverage them efficiently, you used Ghidra for static analysis. Now we&rsquo;ll introduce GDB for dynamic analysis. You&rsquo;ve most likely noticed that they are able to display the source code of the application. GDB can do so when said app was compiled with debug symbols, while Ghidra does not even need debug symbols."><meta itemprop=wordCount content="3909"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="Introduction In the previous 2 sessions you started discovering what binary security looks like. Last session you learnt two very powerful means of investigating and even reverse engineering executables: static and dynamic analysis. In order to leverage them efficiently, you used Ghidra for static analysis. Now we&rsquo;ll introduce GDB for dynamic analysis. You&rsquo;ve most likely noticed that they are able to display the source code of the application. GDB can do so when said app was compiled with debug symbols, while Ghidra does not even need debug symbols."><link rel=preload href=/scss/main.min.5aef8a3f4159801f5dbe642e33f5332212e837eda91d37dcd891fdcd5c32498a.css as=style><link href=/scss/main.min.5aef8a3f4159801f5dbe642e33f5332212e837eda91d37dcd891fdcd5c32498a.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class=font-weight-bold>Security Summer School</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/binary/><span>Binary Exploitation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/essentials/><span class=active>Security Essentials</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/web/><span>Web Security</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/><span>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-essentials-li><a href=/essentials/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-essentials><span>Security Essentials</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialswelcome-to-linux-li><a href=/essentials/welcome-to-linux/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialswelcome-to-linux><span>01. Welcome to Linux</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialssystem-exploration-li><a href=/essentials/system-exploration/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialssystem-exploration><span>02. System Exploration</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialsexplaining-the-internet-li><a href=/essentials/explaining-the-internet/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialsexplaining-the-internet><span>03. Explaining the Internet</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialsrediscovering-the-browser-li><a href=/essentials/rediscovering-the-browser/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialsrediscovering-the-browser><span>04. (Re)Discovering the Browser</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialshacking-the-web-li><a href=/essentials/hacking-the-web/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialshacking-the-web><span>05. Hacking the Web</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialsdata-representation-li><a href=/essentials/data-representation/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialsdata-representation><span>06. Data Representation</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialsdata-security-li><a href=/essentials/data-security/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialsdata-security><span>07. Data Security</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialsapplication-lifetime-li><a href=/essentials/application-lifetime/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialsapplication-lifetime><span>08. Application Lifetime</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialsbinary-analysis-li><a href=/essentials/binary-analysis/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialsbinary-analysis><span>09. Binary Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-essentialsassembly-language-li><a href=/essentials/assembly-language/ title class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-essentialsassembly-language><span class=td-sidebar-nav-active-item>10. Assembly Language</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialstaming-the-stack-li><a href=/essentials/taming-the-stack/ title class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialstaming-the-stack><span>11. Taming the Stack</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialscontributing-li><a href=/essentials/contributing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialscontributing><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialscopying-li><a href=/essentials/copying/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialscopying><span></span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-essentialsreviewing-li><a href=/essentials/reviewing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-essentialsreviewing><span></span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/security-summer-school/security-summer-school.github.io/tree/main/content/en/essentials/assembly-language/index.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/security-summer-school/security-summer-school.github.io/edit/main/content/en/essentials/assembly-language/index.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/security-summer-school/security-summer-school.github.io/new/main/content/en/essentials/assembly-language/index.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/security-summer-school/security-summer-school.github.io/issues/new?title=" class=td-page-meta--issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/security-summer-school/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=/essentials/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#registers-in-an-x64-cpu>Registers in an X64 CPU</a><ul><li><a href=#rip><code>rip</code></a></li><li><a href=#general-purpose-registers>General Purpose Registers</a></li><li><a href=#smaller-registers>Smaller Registers</a></li></ul></li></ul><ul><li><a href=#mov><code>mov</code></a></li><li><a href=#data-manipulation>Data Manipulation</a></li><li><a href=#control-flow>Control Flow</a><ul><li><a href=#jmp><code>jmp</code></a></li><li><a href=#eflags><code>eflags</code></a></li><li><a href=#conditional-jumps>Conditional jumps</a></li><li><a href=#loops>Loops</a></li></ul></li></ul><ul><li><a href=#endianness>Endianness</a></li></ul><ul><li><a href=#objdump><code>objdump</code></a></li><li><a href=#gdb>GDB</a></li></ul><ul><li><a href=#in-plain-assembly>In Plain Assembly</a></li><li><a href=#gotta-link-em-all>Gotta Link Em All</a></li><li><a href=#jump-maze>Jump Maze</a></li><li><a href=#crypto>Crypto</a></li><li><a href=#call-me-little-sunshine>Call Me Little Sunshine</a></li></ul><ul><li><a href=#the-whole-isa>The Whole ISA</a></li><li><a href=#caches>Caches</a></li><li><a href=#assembly-syntaxes>Assembly Syntaxes</a></li><li><a href=#lea><code>lea</code></a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/essentials/>Security Essentials</a></li><li class="breadcrumb-item active" aria-current=page><a href=/essentials/assembly-language/ aria-disabled=true class="btn-link disabled">10. Assembly Language</a></li></ol></nav><div class=td-content><h1></h1><header class=article-meta></header><h1 id=introduction>Introduction</h1><p>In the previous 2 sessions you started discovering what binary security looks like.
<a href=../binary-analysis/>Last session</a> you learnt two very powerful means of investigating and even reverse engineering executables: static and dynamic analysis.
In order to leverage them efficiently, you used Ghidra for static analysis.
Now we&rsquo;ll introduce GDB for dynamic analysis.
You&rsquo;ve most likely noticed that they are able to display the source code of the application.
GDB can do so when said app was compiled with <em>debug symbols</em>, while Ghidra does not even need debug symbols.
It infers the original C code from its compiled representation (learn more about how Ghidra does this by taking part in the <a href=https://security-summer-school.github.io/binary/static-analysis/#ida-and-ghidra>Binary Security track</a> next year).
This representation is called <strong>assembly language</strong>.
Both Ghidra and GDB can display the program&rsquo;s code in assembly language.
Today we will demystify this low-level language and learn to understand it.</p><h1 id=reminders-and-prerequisites>Reminders and Prerequisites</h1><p>For this session, you need:</p><ul><li>a working knowledge of the C programming language and familiarity with pointers</li><li>basic skills with Ghidra and GDB</li><li>understand how an executable file is created, as described in the <a href=../application-lifetime/>Application Lifetime session</a></li><li>knowledge of the following means of representing data: ASCII, binary, hexadecimal.
Check out the session on <a href=../data-representation/>Data Representation</a> for a reminder.</li></ul><h1 id=assembly>Assembly</h1><p>Assembly is a low-level language used as a human-readable representation of instructions executed by the CPU.
There is a one-to-one mapping between the binary code executed by the CPU and Assembly.
Few people write Assembly, but many people are required to read it:</p><ul><li>security engineers</li><li>compiler / interpreter developers</li><li>embedded developers</li><li>operating systems developers</li></ul><p>Simply put, if a field is close to CPU it requires (some knowledge of) Assembly.
So let&rsquo;s learn this language!</p><h1 id=registers>Registers</h1><p>You might have already seen the image below.
It shows the various places where data can be kept.
Note that this data can be both non-persistent and persistent.
Non-persistent data is gone once you shut down the computer.
It&rsquo;s kept in all levels from &ldquo;Main Memory&rdquo; upwards.
The &ldquo;Main Memory&rdquo; is simply referred to as <strong>memory</strong> or RAM.</p><p>Persistent storage refers to data on <strong>disks</strong>: HDD, SSD, CDs, DVDs, magnetic tapes, even in the cloud (where cloud storage providers also use HDDs, SSDs etc.).
If you shut down your laptop or your mobile phone, your pictures or video games remain unchanged.
This is because they are stored <strong>on your device&rsquo;s disk</strong>.
We simply refer to persistent storage as <strong>storage</strong>.
Take note of the difference between <em>storage</em> and <em>memory</em>.</p><p><img src=./assets/memory-hierarchy.png alt="Memory Hierarchy"></p><p>In most programming languages you can freely access data everywhere up to and including the memory.
In assembly however, you also have access to the <strong>registers</strong> and can influence the <em>cache</em>.
We won&rsquo;t be dealing with the cache in this session, but you can read more about them <a href=#caches>at the end of this session</a>
They are the fastest form of memory available and are implemented <em>inside the CPU</em>.
We can access data in registers in less than 1 ns (nanoseconds), as opposed to a few dozen ns when fetching data from the RAM.</p><p>Then why not make more registers and only use them instead of RAM?
Registers are fast because they are few in number.
This allows them to be efficiently wired to the CPU&rsquo;s Arithmetic and Logic Unit (ALU), which is responsible for executing basic operations, sch as addition, subtraction, bitwise and, or, shifts etc.
The more registers, the more complex and the less efficient the logic.</p><h2 id=registers-in-an-x64-cpu>Registers in an X64 CPU</h2><p>Registers are like variables with fixed names embedded in the CPU.
They can be assigned values that can be modified via instructions.
There are several types of registers inside a CPU.
All of them can be assigned data and that data can be modified using the assembly-level operations described <a href=#assembly-instructions>further in this session</a>.</p><p>All registers are <strong>64-bits</strong> wide.
So they each can store up to 8 bytes of data.</p><h3 id=rip><code>rip</code></h3><p>We&rsquo;ll start with a very special and illusive one: the <strong>instruction pointer</strong> - <code>rip</code>.
In <a href=../binary-analysis/>the previous session</a>, you learned that the code of any process is also in its memory.
In order to read and execute it, the CPU must &ldquo;follow&rdquo; it just like children follow text with their fingers.
The CPU does this using <code>rip</code>.
This register stores te <strong>address of the currently executed instruction</strong>.
We will never use this instruction per-se in instructions, but you will see and make use of it in GDB.</p><h3 id=general-purpose-registers>General Purpose Registers</h3><p>Then there are <strong>general purpose registers</strong>.
As their name implies, they are used to store <em>anything</em>: addresses, user input, function parameters, data read from files or from the web etc.
Some of them also have some special functions, especially regarding function calls:</p><ul><li><code>rax</code>: accumulator register</li><li><code>rbx</code>: base register</li><li><code>rcx</code>: counter register; used with the <a href=#loop><code>loop</code></a> instruction</li><li><code>rdx</code>: data register</li><li><code>rdi</code>: destination register</li><li><code>Rsi</code>: source register</li><li><code>r8</code>, <code>r9</code> &mldr; <code>r15</code>: regular registers</li></ul><p>Do not learn them by heart.
And also do not bother with their extra meanings.
We will make use of those only when specified.
Otherwise, treat them as simple variables.</p><h3 id=smaller-registers>Smaller Registers</h3><p>Sometimes you only need to access 32 or 16 or 8 bits out of a 64-bit register.
This is possible by slightly changing the name of the register like so:</p><table><thead><tr><th style=text-align:center>64 bits</th><th style=text-align:center>Lowe 32 bits</th><th style=text-align:center>Lower 16 bits</th><th style=text-align:center>High 8 bits</th><th style=text-align:center>Low 8 bits</th></tr></thead><tbody><tr><td style=text-align:center><code>rax</code></td><td style=text-align:center><code>eax</code></td><td style=text-align:center><code>ax</code></td><td style=text-align:center><code>ah</code></td><td style=text-align:center><code>al</code></td></tr><tr><td style=text-align:center><code>rdi</code></td><td style=text-align:center><code>edi</code></td><td style=text-align:center><code>di</code></td><td style=text-align:center>unaccessible</td><td style=text-align:center><code>dil</code></td></tr><tr><td style=text-align:center><code>r8</code></td><td style=text-align:center><code>r8d</code></td><td style=text-align:center><code>r8w</code></td><td style=text-align:center>unaccessible</td><td style=text-align:center><code>r8l</code></td></tr></tbody></table><p>The bits contained in each of the above subdivisions are shown in the image below.
It is similar for <code>rdi</code> and <code>r8</code>, it&rsquo;s just the names that differ.</p><p><img src=./assets/rax-subdivisions.svg alt="rax Subdivisions"></p><p><code>rbx</code>, <code>rcx</code> and <code>rdx</code> have the same subdivisions as <code>rax</code>.
<code>rsi</code> has the same subdivision as <code>rdi</code>: <code>esi</code>, <code>si</code> and <code>sil</code>.
It doesn&rsquo;t make sense to access 4 bytes of an address.
The lower 2 bytes can be accessed due to historical reasons.
In the 70s, when the first CPU of this family (8086) was launched, it only supported 2-byte addresses.
All registers <code>r9</code> to <code>r15</code> have the same subdivisions as <code>r8</code>.</p><h1 id=assembly-instructions>Assembly Instructions</h1><p>We&rsquo;ve now learned what assembly is theoretically and what registers are, but how do we use them?
Each CPU exposes an <strong>ISA (Instruction Set Architecture)</strong>: a set of instructions with which to modify and interact with its registers and with the RAM.
There are over 1000 instructions in the x64 ISA.
There are even instructions for efficiently encrypting data.
Find out more about them by enrolling in the <a href=https://github.com/security-summer-school/hardware-sec/>Hardware Assisted Security track</a>.</p><p>Before we dive into the instructions themselves, it&rsquo;s useful to first look at their generic syntax:</p><pre tabindex=0><code>instruction_name destination, source
</code></pre><p>Most Assembly instructions have 2 operands: a source and a destination.
For some operations, such as arithmetic, the destination is also an operand.
The result of each instruction always stored in the destination.</p><p>Below we&rsquo;ll list some fundamental instructions.
We will be using the Intel Assembly syntax.</p><h2 id=mov><code>mov</code></h2><p><code>mov</code> is the most basic instruction in Assembly.
It <em>copies</em> (or <em>moves</em>) data from the source to the destination.
Also note that comments in Assembly are preceded by <code>;</code> and that the language is case-insensitive.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#000>mov</span> <span style=color:#000>eax</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span>              <span style=color:#8f5902;font-style:italic>; eax = 3
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#000>mov</span> <span style=color:#000>rbx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#a40000>&#34;</span><span style=color:#000>SSS</span> <span style=color:#000>Rulz</span><span style=color:#a40000>&#34;</span>     <span style=color:#8f5902;font-style:italic>; place the string &#34;SSS Rulz&#34; in `rbx`
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>; This places each byte of the string &#34;SSS Rulz&#34; in rbx.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#000>mov</span> <span style=color:#000>r8b</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>bh</span>              <span style=color:#8f5902;font-style:italic>; r8b = bh
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>; The sizes of the operands must be equal (1 byte each in this case).
</span></span></span></code></pre></div><h2 id=data-manipulation>Data Manipulation</h2><p>Now that we&rsquo;ve learnt how to place data in registers we need to learn how to do math with it.
As you&rsquo;ve seen so far, Assembly instructions are really simple.
Below is a table with the most common and useful arithmetic instructions.
Try to figure out what each example does.
Use the fact that the general anatomy of an instruction is usually <code>instruction destination, source</code>.
The result is always stored in the <code>destination</code></p><table><thead><tr><th style=text-align:center>Instruction</th><th style=text-align:center>Description</th><th style=text-align:center>Examples</th></tr></thead><tbody><tr><td style=text-align:center><code>add &lt;dest>, &lt;src></code></td><td style=text-align:center><code>dest += src</code></td><td style=text-align:center><code>add rbx, 5</code><br><code>add r11, 0x99</code></td></tr><tr><td style=text-align:center><code>sub &lt;dest>, &lt;src></code></td><td style=text-align:center><code>dest -= src</code></td><td style=text-align:center><code>sub ecx, 'a'</code><br><code>sub r9, r8</code></td></tr><tr><td style=text-align:center><code>shl &lt;dest>, &lt;bits></code></td><td style=text-align:center><code>dest &lt;&lt;= bits</code></td><td style=text-align:center><code>shl rax, 3</code><br><code>shl rdi, cl</code></td></tr><tr><td style=text-align:center><code>shr &lt;dest>, &lt;bits></code></td><td style=text-align:center><code>dest >>= bits</code></td><td style=text-align:center><code>shr r15, 5</code><br><code>shr rsi, cl</code></td></tr><tr><td style=text-align:center><code>and &lt;dest> &lt;src></code></td><td style=text-align:center><code>dest &= src</code></td><td style=text-align:center><code>and al, ah</code><br><code>and bx, 13</code></td></tr><tr><td style=text-align:center><code>or &lt;dest> &lt;src></code></td><td style=text-align:center><code>dest |= src</code></td><td style=text-align:center><code>or r10b, cl</code><br><code>or r14, 0x2000</code></td></tr><tr><td style=text-align:center><code>xor &lt;dest> &lt;src></code></td><td style=text-align:center><code>dest ^= src</code></td><td style=text-align:center><code>xor ebx, edx</code><br><code>xor rcx, 1</code></td></tr><tr><td style=text-align:center><code>inc &lt;dest></code></td><td style=text-align:center><code>dest++</code></td><td style=text-align:center><code>inc rsi</code></td></tr><tr><td style=text-align:center><code>dec &lt;dest></code></td><td style=text-align:center><code>dest--</code></td><td style=text-align:center><code>dec r10w</code></td></tr></tbody></table><h2 id=control-flow>Control Flow</h2><p>Now we know how to do maths and move bits around.
This is all good, but we still can&rsquo;t write full programs.
We need a mechanism similar to <code>if</code>s from Python and also loops in order to make the code run based on conditions.</p><h3 id=jmp><code>jmp</code></h3><p>The simplest instruction for control flow is the <code>jmp</code> instruction.
It simply loads an address into the <code>rip</code> register.
But when Assembly code is generated or written either by the compiler or by us, instructions don&rsquo;t have addresses yet.
These addresses are assigned during the <strong>linking</strong> or <strong>loading</strong> phase, as you know from the <a href=../application-lifetime/>Application Lifetime session</a>.</p><p>For this reason, we use <strong>labels</strong> as some sort of anchors.
We <code>jmp</code> to them and then the assembler will replace them with relative addresses which are then replaced with full addresses during linking.
The way in which <code>jmp</code> and labels function is very simple.
Remember that in the absence of <code>jmp</code>s, Assembly code is executed linearly just like a script.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span>    <span style=color:#000>jmp</span> <span style=color:#000>skip_next_section</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>; Whatever code is here is never executed.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#f57900>skip_next_section:</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>; Only the code below this label is executed.
</span></span></span></code></pre></div><blockquote><p><strong>Warning</strong>
Do not confuse labels with functions.
A label does not stop the execution of code when it&rsquo;s reached.
They are simply ignored by anything except for <code>jmp</code>.</p></blockquote><p>For example, kin the the following code, both instructions are executed in the absence of <code>jmp</code>s:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span>    <span style=color:#000>mov</span> <span style=color:#000>rax</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span>
</span></span><span style=display:flex><span><span style=color:#f57900>some_label:</span>
</span></span><span style=display:flex><span>    <span style=color:#000>mov</span> <span style=color:#000>rbx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>; rax = 2; rbx = 3
</span></span></span></code></pre></div><h3 id=eflags><code>eflags</code></h3><p>Each instruction (except for <code>mov</code>) changes the <strong>inner state of the CPU</strong>.
In other words, several aspects regarding the result of the instruction are stored in a special register that we cannot access directly, called <code>eflags</code>.
There are <a href=https://stackoverflow.com/questions/1406783/how-to-read-and-write-x86-flags-registers-directly>instructions</a> that can set or clear some flags in <code>eflags</code>, but we cannot write something like <code>mov eflags, 2</code>.</p><p>As its name implies, each bit in <code>eflags</code> is a flag that is activated (i.e. set to 1) if a certain condition is true about the result of the last executed instruction.
We won&rsquo;t be using these flags per se with one exception: <code>ZF</code> - the <strong>zero flag</strong>.
When active, it means that the result of the last instruction was&mldr; 0, duh!
This is useful for testing if numbers are equal for example.
We&rsquo;ll talk about this in the next section.</p><h3 id=conditional-jumps>Conditional jumps</h3><p>Now we know that there is an internal state of the CPU which is modified by each instruction, except for <code>mov</code>.
We still need a way to leverage this state.
We can do this via <strong>conditional jumps</strong>.</p><p>They are like <code>jmp</code> instructions, but the jump is made only when certain conditions are met.
Otherwise, code execution continues from the next instruction.
The general syntax of a conditional jump is</p><pre tabindex=0><code>j[n]&lt;cond&gt; jabel
</code></pre><p>where the letter <code>n</code> is optional and means the jump will be made if the condition is <strong>not</strong> met.</p><h4 id=cmp-and-test><code>cmp</code> and <code>test</code></h4><p>We can use the regular arithmetic instructions that we&rsquo;ve learned so far to modify <code>eflags</code>.
But this has the drawback of also modifying our data.
It would be great if we had a means to modify <code>eflags</code> without changing the data that we evaluate.
We can do this using <code>cmp</code> and <code>test</code>.</p><p><code>cmp dest, src</code> modifies <code>eflags</code> as if you were <strong>subtracting</strong> <code>src</code> from <code>dst</code>, but without modifying <code>dst</code>.
This is great for testing if 2 things are equal, or for testing which is greater or lower.</p><p><code>test dest, src</code> is similar to <code>cmp</code>, but modifies <code>eflags</code> according to the <code>and</code> instruction.
This comes in handy when we want to check if a register is 0.</p><pre tabindex=0><code>test rax, rax
jz rax_is_zero
</code></pre><p>is equivalent to</p><pre tabindex=0><code>cmp rax, 0
jz rax_is_zero
</code></pre><p>Now let&rsquo;s have a look at some conditional jumps:</p><table><thead><tr><th style=text-align:center>Conditional jump</th><th style=text-align:center>Meaning</th></tr></thead><tbody><tr><td style=text-align:center><code>jz</code> / <code>je</code></td><td style=text-align:center>Jump if the Zero Flag is active</td></tr><tr><td style=text-align:center><code>jnz</code> / <code>jne</code></td><td style=text-align:center>Jump if the Zero Flag is not active</td></tr><tr><td style=text-align:center><code>cmp rax, rbx</code><br><code>j[n]g</code></td><td style=text-align:center>Jump if <code>rax</code> is (not) greater (signed) than <code>rbx</code></td></tr><tr><td style=text-align:center><code>cmp rax, rbx</code><br><code>j[n]a</code></td><td style=text-align:center>Jump if <code>rax</code> is (not) greater (unsigned) than <code>rbx</code></td></tr><tr><td style=text-align:center><code>cmp rax, rbx</code><br><code>j[n]ge</code></td><td style=text-align:center>Jump if <code>rax</code> is (not) greater (signed) or equal than <code>rbx</code></td></tr><tr><td style=text-align:center><code>cmp rax, rbx</code><br><code>j[n]ae</code></td><td style=text-align:center>Jump if <code>rax</code> is (not) greater (unsigned) or equal than <code>rbx</code></td></tr><tr><td style=text-align:center><code>cmp rax, rbx</code><br><code>j[n]l</code></td><td style=text-align:center>Jump if <code>rax</code> is (not) lower (signed) than <code>rbx</code></td></tr><tr><td style=text-align:center><code>cmp rax, rbx</code><br><code>j[n]b</code></td><td style=text-align:center>Jump if <code>rax</code> is (not) lower (unsigned) than <code>rbx</code></td></tr><tr><td style=text-align:center><code>cmp rax, rbx</code><br><code>j[n]le</code></td><td style=text-align:center>Jump if <code>rax</code> is (not) lower (signed) or equal than <code>rbx</code></td></tr><tr><td style=text-align:center><code>cmp rax, rbx</code><br><code>j[n]be</code></td><td style=text-align:center>Jump if <code>rax</code> is (not) lower (unsigned) or equal than <code>rbx</code></td></tr></tbody></table><h3 id=loops>Loops</h3><p>We can create loops simply by combining labels and conditional jumps.
For example, <code>for i in range(0, 10)</code> from Python is equivalent to:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span>    <span style=color:#000>xor</span> <span style=color:#000>rcx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>rcx</span>    <span style=color:#8f5902;font-style:italic>; i = rcx; same as mov rcx, 0
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>for_loop</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>    <span style=color:#000>cmp</span> <span style=color:#000>rcx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>10</span>
</span></span><span style=display:flex><span>    <span style=color:#000>je</span> <span style=color:#000>done_loop</span>    <span style=color:#8f5902;font-style:italic>; verify i &lt; 10
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>; The body of the for loop.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#000>inc</span> <span style=color:#000>rcx</span>         <span style=color:#8f5902;font-style:italic>; rcx++
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>jmp</span> <span style=color:#000>for_loop</span>    <span style=color:#8f5902;font-style:italic>; re-evaluate the condition
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#f57900>done_loop:</span>
</span></span></code></pre></div><p>Or alternatively, we can verify <code>rcx &lt; 10</code> at the end of the loop:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span>    <span style=color:#000>xor</span> <span style=color:#000>rcx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>rcx</span>
</span></span><span style=display:flex><span><span style=color:#f57900>for_loop:</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>; The body of the for loop.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#000>inc</span> <span style=color:#000>rcx</span>         <span style=color:#8f5902;font-style:italic>; rcx++
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>cmp</span> <span style=color:#000>rcx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>10</span>
</span></span><span style=display:flex><span>    <span style=color:#000>jb</span> <span style=color:#000>for_loop</span>    <span style=color:#8f5902;font-style:italic>; verify i &lt; 10
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>; The code here is executed only after the loop ends.
</span></span></span></code></pre></div><h1 id=dereferencing-addresses>Dereferencing Addresses</h1><p>Up to this point we know how to operate with data and can write complex programs using conditional jumps.
But we know that data is stored mostly in the RAM.
How do we fetch it from there to our registers?</p><p>Imagine the RAM is one giant array.
Each byte is a cell in this array.
Therefore, each byte is found at a given <strong>index</strong> in this array.
Indices start at 0, so the first byte is found at index 0, the third 3 at index 2 and so on.
These indices are also called <strong>memory addresses</strong>, or simply <strong>addresses</strong>.</p><p>In order to load data from the RAM into our registers or vice-versa, we need to specify to CPU which RAM address to access.
This is called <strong>dereferencing that address</strong>.
Syntactically, this is very easy and is done by wrapping the address in <code>[]</code>.
The address can be either a raw number, or a register, or an expression:</p><pre tabindex=0><code>mov rax, [0xdeadbeef]   ; load 8 bytes from the address 0xdeadbeef into rax
mov bx, [0xdeadbeef]    ; load 2 bytes from the address 0xdeadbeef into bx
mov [0xdeadbeef], ecx   ; store 4 bytes from ecx at the address 0xdeadbeef
</code></pre><p>Notice that the number of bytes that are transferred between the RAM and registers is given by the size of the register.
But what happens when we don&rsquo;t use a register?
The code below is incorrect because it is impossible to tell how many bytes to use to write 0x69.
We could write it using one byte of course, but what if we wanted to write it on 4 bytes and store <code>[ 0x00 | 0x00 | 0x00 | 0x69 ]</code>?
To eliminate such ambiguities, we must specify the number of bytes that we want to write to the RAM:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#000>mov</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0xdeadbeef</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>byte</span> <span style=color:#0000cf;font-weight:700>0x2</span>      <span style=color:#8f5902;font-style:italic>; writes 1 byte
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>mov</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0xdeadbeef</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>word</span> <span style=color:#0000cf;font-weight:700>0x2</span>      <span style=color:#8f5902;font-style:italic>; writes 2 bytes: 0x00 and 0x02
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>mov</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0xdeadbeef</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>dword</span> <span style=color:#0000cf;font-weight:700>0x2</span>     <span style=color:#8f5902;font-style:italic>; writes 4 bytes
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>mov</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0xdeadbeef</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>qword</span> <span style=color:#0000cf;font-weight:700>0x2</span>     <span style=color:#8f5902;font-style:italic>; writes 8 bytes
</span></span></span></code></pre></div><p>Instead of a hardcoded value, we can express addresses as complex expressions which the CPU computes for us.
In the snippet below, the CPU computes the address given by <code>rdi + rcx * 4</code> and then writes the contents of <code>edx</code> there.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#000>mov</span> <span style=color:#000;font-weight:700>[</span><span style=color:#000>rdi</span> <span style=color:#a40000>+</span> <span style=color:#000>rcx</span> <span style=color:#000;font-weight:700>*</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>edx</span>
</span></span></code></pre></div><p>This is equivalent to <code>v[i] = something</code> where <code>v</code> is an array of 4-byte values (hence <code>rcx * 4</code>):</p><ul><li><code>rdi</code> = starting address of <code>v</code></li><li><code>rcx</code> = <code>i</code></li><li><code>edx</code> = <code>something</code></li></ul><p>Therefore, whenever you see <code>[...]</code> in Assembly, what between the square brackets is being dereferenced <a href=#lea><strong>with one exception</strong></a>.</p><h2 id=endianness>Endianness</h2><p>This is all nice, but how does all this look like in the memory?
The order in which the bytes are stored in the RAM is called <strong>endianness</strong>.
Most CPUs store bytes <strong>in reverse order</strong>, or <strong>little endian</strong> order, because the least significant byte is the first.
When data is fetched back from the ram, the order is reversed:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#000>mov</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0x100</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>dword</span> <span style=color:#0000cf;font-weight:700>0x12345678</span>       <span style=color:#8f5902;font-style:italic>; the RAM at 0x100: [ 0x78 | 0x56 | 0x34 | 0x12 ]
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>mov</span> <span style=color:#000>ax</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0x100</span><span style=color:#000;font-weight:700>]</span>     <span style=color:#8f5902;font-style:italic>; ax = 0x5678
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>mov</span> <span style=color:#000>bx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>101</span><span style=color:#000;font-weight:700>]</span>       <span style=color:#8f5902;font-style:italic>; bx = 0x3456
</span></span></span></code></pre></div><p>However, endianness does not apply to strings.
The code below writes the string <code>SSS Rulz</code> at the address 0x100.
Notice we don&rsquo;t have to write it in reverse order like <code>zluR SSS</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#000>mov</span> <span style=color:#000>rax</span><span style=color:#000;font-weight:700>,</span> <span style=color:#a40000>&#34;</span><span style=color:#000>SSS</span> <span style=color:#000>Rulz</span><span style=color:#a40000>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000>mov</span> <span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0x100</span><span style=color:#000;font-weight:700>],</span> <span style=color:#000>rax</span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>; We need to use a register because mov cannot take both an address and a 64-bit immediate as operands.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>; https://www.felixcloutier.com/x86/mov
</span></span></span></code></pre></div><h1 id=reading-assembly>Reading Assembly</h1><h2 id=objdump><code>objdump</code></h2><p>Starting from an executable file, we can read its Assembly code by <strong>disassembling</strong> it.
The standard tool for doing this is <code>objdump</code>:</p><pre tabindex=0><code>root@kali:~$ objdump -M intel -d &lt;binary&gt; | less
</code></pre><ul><li>Use <code>-M intel</code> for Intel syntax.
The default syntax is AT&T.</li><li><code>-d</code> stands for &ldquo;disassembly&rdquo;.</li><li>pipe the output to <code>less</code> so you can navigate the Assembly code more easily.</li></ul><p>Notice that every line contains an address, an opcode and an instruction.
The opcode is simply the binary representation of that instruction.</p><p>Alternatively, you can use GDB and Ghidra that you learned about <a href=../binary-analysis/>in the previous session</a>.</p><h2 id=gdb>GDB</h2><p>The undisputed king of Assembly is by far the <strong>GNU DeBugger (GDB)</strong>.
It&rsquo;s just what its name says it is, but its beauty is in its versatility.
GDB is a command-line debugger that allows us to print registers, variables, dump memory from any address, step through the code, go back through the call stack and much more.
Today we will only get a glimpse of its power.</p><p>We are using the <code>pwndbg</code> extension for GDB as it allows us to view the assembly code, stack (you&rsquo;ll learn about it in the <a href=../taming-the-stack/>next session</a>) and registers.
Follow the instructions <a href=https://github.com/pwndbg/pwndbg#how>here</a> to install it if you haven&rsquo;t done so already.</p><p>GDB can run Assembly instructions one by one and stops after each instruction.
The current instruction is also clearly displayed.
Below is a reduced list of useful GDB commands to get you going.
Use it as a cheatsheet when you get stuck:</p><ul><li><p><code>start</code> = start running the program from <code>main</code></p></li><li><p><code>list</code> = decompile and display C code
Only works for executables compiled with <code>-g</code></p></li><li><p><code>pdis</code> = disassemble and display instructions with nice syntax highlighting</p></li><li><p><code>next</code> / <code>n</code> = run the current C code
If it is a function call, it is executed without stepping into the function.</p></li><li><p><code>nexti</code> / <code>ni</code> = run the current Assembly instruction</p></li><li><p><code>step</code> / <code>s</code> = if the debugger has reached a function call, step into it.
Otherwise, it behaves like <code>next</code> / <code>n</code></p></li><li><p><code>stepi</code> / <code>si</code> = step into function (used for the <code>call</code> instruction in Assembly)</p></li><li><p><code>break</code> / <code>b &lt;n></code> = place a breakpoint at line <code>n</code></p></li><li><p><code>break</code> / <code>b *&lt;address></code> = place breakpoint at address</p></li><li><p><code>continue</code> / <code>c</code> = run code until next breakpoint</p></li><li><p><code>info registers &lt;name></code> = display the values in all registers.
If a name is specified, only the value in that register is displayed</p></li><li><p><code>p &lt;variable></code> / <code>&lt;name></code> = print the variable / number; similar to <code>printf</code></p></li></ul><pre tabindex=0><code>p/d = printf(&#34;%d&#34;)
p/c = printf(&#34;%c&#34;)
p/x = printf(“%x”)
p/u = printf(“%u”)
</code></pre><ul><li><code>x &lt;address></code> = print data at the address (dereference it).
By default, the output is represented in hex</li><li><code>x/&lt;n>&lt;d>&lt;f> &lt;address></code> -> print <code>n</code> memory areas of size <code>d</code> with format <code>f</code>:</li></ul><pre tabindex=0><code>n = any number; default = 1
d = b (byte - default) / h (half-word = short) / w (word = int) 
f = (like p): x (hex - default)  / c (char) / d (int, decimal) / u (unsigned)  / s (string)
</code></pre><p>Examples:</p><pre tabindex=0><code>x/20wx = 20 hex words (ints)
x/10hd = 10 decimal half-words (shortsuri)
x/10c = 10 ASCII characters
x/10b = 10 hex bytes (because x is the default)
</code></pre><ul><li><code>set $&lt;register> &lt;value></code> = sets the register to that value</li></ul><h1 id=summary>Summary</h1><p>The key takeaways from this session are:</p><ul><li>Assembly is a human-readable representation of instructions executed by the CPU</li><li>It allows us to access CPU registers directly</li><li>It uses a fixed set of instructions called ISA</li><li><strong>Memory</strong> is the RAM, <strong>storage</strong> is the disk</li><li>Data is stored in memory using the little endian representation</li><li>You can disassemble a program with <code>objdump</code> like so: <code>objdump -M intel -d &lt;program> |less</code></li></ul><h1 id=activities>Activities</h1><h2 id=in-plain-assembly>In Plain Assembly</h2><p>The flag is almost right there in your face.</p><h2 id=gotta-link-em-all>Gotta Link Em All</h2><p>I wonder what hides in all those object files&mldr;</p><h2 id=jump-maze>Jump Maze</h2><p>Theseus has nothing on you!
Navigate the maze and get the flag.</p><h2 id=crypto>Crypto</h2><p>Is it really about crypto?</p><h2 id=call-me-little-sunshine>Call Me Little Sunshine</h2><p>Do what the binary asks you to do.
What, it doesn&rsquo;t work?</p><h1 id=further-reading>Further Reading</h1><h2 id=the-whole-isa>The Whole ISA</h2><p>If you want to search for an instruction, use <a href=https://www.felixcloutier.com/x86/>this</a> website.
Each instruction has its own table with all possible operands and what they do.
Note that <code>imm8</code> means &ldquo;8-bit immediate&rdquo;, i.e an 8-byte regular number, <code>imm64</code> means a 64-bit immediate and so on.
Similarly, <code>reg32</code> means a 32-bit register and <code>m16</code> for example means a 16-bit (2-byte) memory area.
You&rsquo;ll see <code>reg</code>, <code>imm</code> and <code>m</code> combined with <code>8</code>, <code>16</code>, <code>32</code> and <code>64</code> depending on what each instruction does.</p><h2 id=caches>Caches</h2><p>Many programs access the same addresses repeatedly over a short period of time.
Take a short 1000-step loop.
It uses the same code 1000 times.
It would be inefficient for the CPU to read the instructions directly from the RAM 1000 times.
For this reason, there is an intermediary level of memory between the RAM and the registers, called <strong>the cache</strong>.</p><p>As their name implies, caches store the contents of some memory addresses that are frequently requested by the CPU.
We say <em>caches</em>, in plural because they are laid out hierarchically, each lower level being faster and smaller than the ones below.
Usually, CPUs have 3 levels of cache memory.
You can query their sizes with the <code>lscpu</code> command:</p><pre tabindex=0><code>root@kali:~$ lscpu
[...]
L1d cache:                       128 KiB
L1i cache:                       128 KiB
L2 cache:                        1 MiB
L3 cache:                        6 MiB
[...]
</code></pre><p>Notice the L1 (level 1) cache is split between a data cache (<code>L1d</code>) and an instruction cache <code>L1i</code>.
The other caches do not store data and instructions separately.</p><h2 id=assembly-syntaxes>Assembly Syntaxes</h2><p>This session we&rsquo;ve used the Intel syntax for writing and displaying Assembly.
We did so because it&rsquo;s more straightforward than its alternative: the AT&T syntax.
You can find the differences on <a href=https://en.wikipedia.org/wiki/X86_assembly_language#Syntax>Wikipedia</a>.</p><h2 id=lea><code>lea</code></h2><p><code>lea</code> stands for &ldquo;Load Effective Address&rdquo;.
It syntax is:</p><pre tabindex=0><code>lea dest, [address]
</code></pre><p>It loads <code>address</code> into the <code>dest</code> register (it can only be a register).
What&rsquo;s interesting about it is that it also uses the <code>[...]</code> syntax, but <strong>does not dereference the address</strong>.
In the snippet below, <code>0xdeadbeef</code> is simply copied to <code>rax</code>.</p><pre tabindex=0><code>lea rax, [0xdeadbeef]
</code></pre><p>Its true power comes from the fact that it can also compute an address.
For example, the code below will first compute the address given by <code>rdi + rcx * 8 + 7</code> and then write this address into <code>rax</code>.</p><pre tabindex=0><code>lea rax, [rdi + rcx * 8 + 7]
</code></pre><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes">Glad to hear it! Please <a href=https://github.com/security-summer-school/security-summer-school.github.io/issues/new>tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no">Sorry to hear that. Please <a href=https://github.com/security-summer-school/security-summer-school.github.io/issues/new>tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector(".feedback--answer-yes"),noButton=document.querySelector(".feedback--answer-no"),yesResponse=document.querySelector(".feedback--response-yes"),noResponse=document.querySelector(".feedback--response-no"),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=e=>{if(typeof ga!="function")return;const t={command:"send",hitType:"event",category:"Helpful",action:"click",label:window.location.pathname,value:e};ga(t.command,t.hitType,t.category,t.action,t.label,t.value)};yesButton.addEventListener("click",()=>{yesResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),noButton.addEventListener("click",()=>{noResponse.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><br></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://bit.ly/DiscordSecuritySummerSchool aria-label=Discord><i class="fab fa-discord"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Facebook aria-label=Facebook><a class=text-white target=_blank rel=noopener href=https://www.facebook.com/SSSUPB/ aria-label=Facebook><i class="fab fa-facebook"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank rel=noopener href=https://bit.ly/YoutubeSecuritySummerSchool aria-label=Youtube><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/security-summer-school aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 Open-Source Contributors. All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.aa9f4c5dae6a98b2c46277f4c56f1673a2b000d1756ce4ffae93784cab25e6d5.js integrity="sha256-qp9MXa5qmLLEYnf0xW8Wc6KwANF1bOT/rpN4TKsl5tU=" crossorigin=anonymous></script></body></html>